<apex:page tabStyle="Opportunity" controller="DealViewControllerExcel" contentType="application/vnd.ms-excel#Deal Products.xls"  standardStylesheets="true">
<!-- <apex:page tabStyle="Opportunity" controller="DealViewControllerExcel" standardStylesheets="true"> -->
        <apex:outputPanel id="tablePanel" rendered="{!IF($CurrentPage.parameters.exportMode == 'dealview', true, false)}">
            <apex:outputPanel >
                <table cellpadding="0" cellspacing="0" border="1" class="dataTable" >
                    <!--  BEGIN PER UNIT TABLE -->
                    <tr>
                        <td class="section-header" colspan="{!1+(4*lineItemCount)+(4*totalItemCount)}" style="font-weight:bold;font-size:1.2em;text-transform:uppercase;border-bottom:1px solid #000;padding-top: 20px;">Per Unit</td>
                    </tr>
                    
                    <tr class="pad-top">
                        <td></td>
                        <td></td>
                        <apex:repeat value="{!lineItemColumns}" var="l">
                            <td class="prod-header" colspan="3">
                                <span> {!l.year}</span><br/>
                                <span> {!l.quarter}</span><br/>
                                <span> {!l.name}</span><br/>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                        <apex:repeat value="{!keySetList}" var="l"> 
                            <td class="prod-header total" colspan="3">
                                <span>{!LEFT(l, 4)}</span><br/>
                                <span>{!cleanMap[l]}</span><br/> 
                                <span>Totals</span><br/>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                    </tr>
                    <tr>
                        <td></td>
                        <td></td>
                        <apex:repeat value="{!lineItemColumns}" var="l">
                            <td class="prod-sub-header showHidePOR" style="font-weight:bold;text-align:center; border-bottom:1px solid #000;">Plan</td>
                            <td class="prod-sub-header showHideCWV" style="font-weight:bold;text-align:center; border-bottom:1px solid #000;" >Proposal</td>
                            <td class="prod-sub-header showHideCWV" style="font-weight:bold;text-align:center; border-bottom:1px solid #000;" >Others</td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                        <apex:repeat value="{!totalColumns}" var="l">
                            <td class="prod-sub-header showHidePOR total" style="font-weight:bold;text-align:center; border-bottom:1px solid #000;">Plan</td>
                            <td class="prod-sub-header showHideCWV total" style="font-weight:bold;text-align:center; border-bottom:1px solid #000;">Proposal</td>
                            <td class="prod-sub-header showHideCWV total" style="font-weight:bold;text-align:center; border-bottom:1px solid #000;">Others</td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                    </tr>
                    
                    <tr class="unitRowOp">
                        <td class="data-row-label">Units</td><td></td>
                        <apex:repeat value="{!lineItemColumns}" var="l">
                            <td class="currency-cell showHidePOR">
                                <apex:outputText value="{0,number,###,##0}">
                                    <apex:param value="{!l.porLineItem.Units__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideCWV" >
                                <apex:outputText value="{0,number,###,##0}">
                                    <apex:param value="{!l.cwvLineItem.Units__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideCWV" >
                                <apex:outputText value="{0,number,###,##0}">
                                    <apex:param value="{!l.othLineItem.Units__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                        <apex:repeat value="{!totalColumns}" var="l">
                            <td class="currency-cell showHidePOR total">
                                <apex:outputText value="{0,number,###,##0}">
                                    <apex:param value="{!l.TotalPorLineItem.units}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideCWV total" >
                                <apex:outputText value="{0,number,###,##0}">
                                    <apex:param value="{!l.TotalCwvLineItem.units}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideOth total" >
                                <apex:outputText value="{0,number,###,##0}">
                                    <apex:param value="{!l.TotalOthLineItem.units}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                    </tr>
                    <tr class="collapsableUOp">
                        <td class="data-row-sub-label"> Minimum Commit </td><td>
                        <apex:outputText value="{!lineItemColumns[0].minimumCommitOpCommentField}" style="width: 45px; height:15px;" />
                        </td>
                        <apex:repeat value="{!lineItemColumns}" var="l">
                            <td class="currency-cell showHidePOR">
                                <apex:outputText value="{0,number,###,##0}">
                                    <apex:param value="{!l.porLineItem.MinimumCommitQuantity__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideCWV" >
                                <apex:outputText value="{0,number,###,##0}">
                                    <apex:param value="{!l.cwvLineItem.MinimumCommitQuantity__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideOth" >
                                <apex:outputText value="{0,number,###,##0}">
                                    <apex:param value="{!l.OthLineItem.MinimumCommitQuantity__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                        <apex:repeat value="{!totalColumns}" var="l">
                            <td class="currency-cell showHidePOR total">
                                <apex:outputText value="{0,number,###,##0}">
                                    <apex:param value="{!l.TotalPorLineItem.minCommit}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideCWV total" >
                                <apex:outputText value="{0,number,###,##0}">
                                    <apex:param value="{!l.TotalCwvLineItem.minCommit}"/>
                                </apex:outputText>
                            </td><td class="currency-cell showHideOth total" >
                                <apex:outputText value="{0,number,###,##0}">
                                    <apex:param value="{!l.TotalOthLineItem.minCommit}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                    </tr>
                    <tr>
                        <td class="data-row-label">Invoice Price (NSBD)
                        </td>
                        <td>
                        <apex:outputText value="{!lineItemColumns[0].invoiceCommentField}" style="width: 45px; height:15px;" />
                        </td>
                        <apex:repeat value="{!lineItemColumns}" var="l">
                             <td>
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.porLineItem.InvoicePrice__c}"/>
                                </apex:outputText>
                            </td>
                             <td class="currency-cell showHideCWV" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.cwvLineItem.InvoicePrice__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideOth" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.OthLineItem.InvoicePrice__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                        <apex:repeat value="{!totalColumns}" var="l">
                            <td class="currency-cell showHidePOR total">  
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.porLineItem.invoice}"/>
                                </apex:outputText>
                            </td>
                             <td class="currency-cell showHideCWV total" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.cwvLineItem.invoice}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideOth total" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.OthLineItem.invoice}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                    </tr>
                
                    <tr class="discountRow">
                        <td class="data-row-label">Discount </td>     
                         <td>
                         <apex:outputText value="{!lineItemColumns[0].discountCommentField}" style="width: 45px; height:15px;" rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}"/>
                         <apex:outputText value="{!lineItemColumns[0].discountCommentField}" style="width: 45px; height:15px;" />
                         </td>
                        <apex:repeat value="{!lineItemColumns}" var="l">
                        <td>
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.porLineItem.Discount_Total__c}"/>
                                </apex:outputText>
                            </td>
                             <td class="currency-cell showHideCWV" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.cwvLineItem.Discount_Total__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideOth" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.OthLineItem.Discount_Total__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                        <apex:repeat value="{!totalColumns}" var="l">
                            <td class="currency-cell showHidePOR total">
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.porLineItem.discount}"/>
                                </apex:outputText>
                            </td>
                             <td class="currency-cell showHideCWV total" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.cwvLineItem.discount}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideOth total" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.OthLineItem.discount}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                    </tr>

                    <tr class='collapsableD'>
                        <td class="data-row-sub-label" >&nbsp;&nbsp;&nbsp; SDF </td>
                        <td>
                        <apex:outputText value="{!lineItemColumns[0].SDFCommentField}" style="width: 45px; height:15px;" />  
                        </td>
                        
                        <apex:repeat value="{!lineItemColumns}" var="l">
                            <td>
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.porLineItem.SDF__c}"/>
                                </apex:outputText>
                            </td>
                             <td class="currency-cell showHideCWV" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.cwvLineItem.SDF__c}"/>
                                </apex:outputText>
                            </td>    
                            <td class="currency-cell showHideOth" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.OthLineItem.SDF__c}"/>
                                </apex:outputText>
                            </td>                         
                            <td class="col-sep"></td>
                        </apex:repeat>
                        <apex:repeat value="{!totalColumns}" var="l">
                            <td class="currency-cell showHidePOR total">
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.porLineItem.sdf}"/>
                                </apex:outputText>
                            </td>
                             <td class="currency-cell showHideCWV total" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.cwvLineItem.sdf}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideOth total" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.OthLineItem.sdf}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                    </tr>
                    
                    <tr class='collapsableD'>
                        <td class="data-row-sub-label" >&nbsp;&nbsp;&nbsp; COOP </td>
                        <td>
                        <apex:outputText value="{!lineItemColumns[0].coopCommentField}" style="width: 45px; height:15px;" rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}"/>
                        <apex:outputText value="{!lineItemColumns[0].coopCommentField}" style="width: 45px; height:15px;" />  
                        </td>
                        
                        <apex:repeat value="{!lineItemColumns}" var="l">
                            <td>
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.porLineItem.COOP__c}"/>
                                </apex:outputText>
                            </td>
                             <td class="currency-cell showHideCWV" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.cwvLineItem.COOP__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideOth" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.OthLineItem.COOP__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                        <apex:repeat value="{!totalColumns}" var="l">
                            <td class="currency-cell showHidePOR total">
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.porLineItem.coop}"/>
                                </apex:outputText>
                            </td>
                             <td class="currency-cell showHideCWV total" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.cwvLineItem.coop}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideOth total" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.OthLineItem.coop}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                    </tr>
                    <tr class='collapsableD'>

                        <td class="data-row-sub-label" >&nbsp;&nbsp;&nbsp; MDF </td>
                        <td>
                        <apex:outputText value="{!lineItemColumns[0].mdfCommentField}" style="width: 45px; height:15px;" rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}"/>
                        <apex:outputText value="{!lineItemColumns[0].mdfCommentField}" style="width: 45px; height:15px;" />
                        </td>
                        
                        <apex:repeat value="{!lineItemColumns}" var="l">
                            <td class="currency-cell showHidePOR">
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.porLineItem.MDF__c}"/>
                                </apex:outputText>
                            </td>
                             <td class="currency-cell showHideCWV" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.cwvLineItem.MDF__c}"/>
                                </apex:outputText>
                            </td>

                            <td class="currency-cell showHideOth" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.OthLineItem.MDF__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                        <apex:repeat value="{!totalColumns}" var="l">
                            <td class="currency-cell showHidePOR total">
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.porLineItem.mdf}"/>
                                </apex:outputText>
                            </td>
                             <td class="currency-cell showHideCWV total" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.cwvLineItem.mdf}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideOth total" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.OthLineItem.mdf}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                    </tr>
                    <tr class='collapsableD'>
                        <td class="data-row-sub-label" >&nbsp;&nbsp;&nbsp; iMDF </td>
                        <td>
                        <apex:outputText value="{!lineItemColumns[0].imdfCommentField}" style="width: 45px; height:15px;" rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}"/>
                        <apex:outputText value="{!lineItemColumns[0].imdfCommentField}" style="width: 45px; height:15px;" />
                        </td>
                        
                        <apex:repeat value="{!lineItemColumns}" var="l">
                            <td class="currency-cell showHidePOR">
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.porLineItem.iMDF__c}"/>
                                </apex:outputText>
                            </td>
                             <td class="currency-cell showHideCWV" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.cwvLineItem.iMDF__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideOth" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.OthLineItem.iMDF__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                        <apex:repeat value="{!totalColumns}" var="l">
                            <td class="currency-cell showHidePOR total">
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.porLineItem.imdf}"/>
                                </apex:outputText>
                            </td>
                             <td class="currency-cell showHideCWV total" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.cwvLineItem.imdf}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideOth total" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.OthLineItem.imdf}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                    </tr>
                    <tr class='collapsableD'>
                        <td class="data-row-sub-label" >&nbsp;&nbsp;&nbsp; SVM </td>
                        <td>
                        <apex:outputText value="{!lineItemColumns[0].svmCommentField}" style="width: 45px; height:15px;" rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}"/>
                        <apex:outputText value="{!lineItemColumns[0].svmCommentField}" style="width: 45px; height:15px;" />
                        </td>
                        
                        <apex:repeat value="{!lineItemColumns}" var="l">
                            <td class="currency-cell showHidePOR">
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.porLineItem.SVM__c}"/>
                                </apex:outputText>
                            </td>
                             <td class="currency-cell showHideCWV" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.cwvLineItem.SVM__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideOth" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.OthLineItem.SVM__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                        <apex:repeat value="{!totalColumns}" var="l">
                            <td class="currency-cell showHidePOR total">
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.porLineItem.svm}"/>
                                </apex:outputText>
                            </td>
                             <td class="currency-cell showHideCWV total" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.cwvLineItem.svm}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideOth total" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.OthLineItem.svm}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                    </tr>
                    <tr class='collapsableD'>
                          <td class="data-row-sub-label" >&nbsp;&nbsp;&nbsp; IPP </td>
                          <td>
                        <apex:outputText value="{!lineItemColumns[0].ippCommentField}" style="width: 45px; height:15px;" rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}"/>
                        <apex:outputText value="{!lineItemColumns[0].ippCommentField}" style="width: 45px; height:15px;" />
                        </td>
                        
                        <apex:repeat value="{!lineItemColumns}" var="l">
                            <td>
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.porLineItem.IPP__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideCWV" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.cwvLineItem.IPP__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideOth" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.OthLineItem.IPP__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                        <apex:repeat value="{!totalColumns}" var="l">
                            <td class="currency-cell showHidePOR total">
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.porLineItem.ipp}"/>
                                </apex:outputText>
                            </td>
                             <td class="currency-cell showHideCWV total" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.cwvLineItem.ipp}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideOth total" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.OthLineItem.ipp}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                    </tr>
                    <tr class='collapsableD'>
                            <td class="data-row-sub-label" >&nbsp;&nbsp;&nbsp; National Retail </td>
                          <td>
                        <apex:outputText value="{!lineItemColumns[0].nationalRetailCommentField}" style="width: 45px; height:15px;" rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}"/>
                        <apex:outputText value="{!lineItemColumns[0].nationalRetailCommentField}" style="width: 45px; height:15px;" />
                        </td>
                        
                        <apex:repeat value="{!lineItemColumns}" var="l">
                            <td class="currency-cell showHidePOR">
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.porLineItem.National_Retail__c}"/>
                                </apex:outputText>
                            </td>
                             <td class="currency-cell showHideCWV" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.cwvLineItem.National_Retail__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideOth" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.OthLineItem.National_Retail__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                        <apex:repeat value="{!totalColumns}" var="l">
                            <td class="currency-cell showHidePOR total">
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.porLineItem.nationalRetail}"/>
                                </apex:outputText>
                            </td>
                             <td class="currency-cell showHideCWV total" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.cwvLineItem.nationalRetail}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideOth total" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.OthLineItem.nationalRetail}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                    </tr>
                    <tr class='collapsableD'>
                        <td class="data-row-sub-label" >&nbsp;&nbsp;&nbsp; CSAT </td>
                          <td>    
                        <apex:outputText value="{!lineItemColumns[0].csatCommentField}" style="width: 45px; height:15px;" rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}"/>
                        <apex:outputText value="{!lineItemColumns[0].csatCommentField}" style="width: 45px; height:15px;" />
                        </td>
                        
                        <apex:repeat value="{!lineItemColumns}" var="l">
                            <td class="currency-cell showHidePOR">
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.porLineItem.CSAT__c}"/>
                                </apex:outputText>
                            </td>
                             <td class="currency-cell showHideCWV" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.cwvLineItem.CSAT__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideOth" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.OthLineItem.CSAT__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                        <apex:repeat value="{!totalColumns}" var="l">
                            <td class="currency-cell showHidePOR total">
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.porLineItem.csat}"/>
                                </apex:outputText>
                            </td>
                             <td class="currency-cell showHideCWV total" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.cwvLineItem.csat}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideOth total" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.OthLineItem.csat}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                    </tr>
                    <tr class='collapsableD'>
                        <td class="data-row-sub-label" >&nbsp;&nbsp;&nbsp; QP </td>
                          <td>
                        <apex:outputText value="{!lineItemColumns[0].qpCommentField}" style="width: 45px; height:15px;" rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}"/>
                        <apex:outputText value="{!lineItemColumns[0].qpCommentField}" style="width: 45px; height:15px;" />
                        </td>
                        
                        <apex:repeat value="{!lineItemColumns}" var="l">
                            <td class="currency-cell showHidePOR">
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.porLineItem.QP__c}"/>
                                </apex:outputText>
                            </td>
                             <td class="currency-cell showHideCWV" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.cwvLineItem.QP__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideOth" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.OthLineItem.QP__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                        <apex:repeat value="{!totalColumns}" var="l">
                            <td class="currency-cell showHidePOR total">
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.porLineItem.qp}"/>
                                </apex:outputText>
                            </td>
                             <td class="currency-cell showHideCWV total" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.cwvLineItem.qp}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideOth total" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.OthLineItem.qp}"/>
                                </apex:outputText>
                            </td>

                            <td class="col-sep"></td>
                        </apex:repeat>
                    </tr>
                    <tr class='collapsableD'>
                          <td class="data-row-sub-label" >&nbsp;&nbsp;&nbsp; TC </td>
                          <td>
                        <apex:outputText value="{!lineItemColumns[0].tcCommentField}" style="width: 45px; height:15px;" rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}"/>
                        <apex:outputText value="{!lineItemColumns[0].tcCommentField}" style="width: 45px; height:15px;" />
                        </td>
                       
                        <apex:repeat value="{!lineItemColumns}" var="l">
                            <td class="currency-cell showHidePOR">
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.porLineItem.TC__c}"/>
                                </apex:outputText>
                            </td>
                             <td class="currency-cell showHideCWV" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.cwvLineItem.TC__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideOth" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.OthLineItem.TC__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                        <apex:repeat value="{!totalColumns}" var="l">
                            <td class="currency-cell showHidePOR total">
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.porLineItem.tc}"/>
                                </apex:outputText>
                            </td>
                             <td class="currency-cell showHideCWV total" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.cwvLineItem.tc}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideOth total" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.OthLineItem.tc}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                    </tr>
                    <tr class='collapsableD'>
                          <td class="data-row-sub-label" >&nbsp;&nbsp;&nbsp; ILW </td>
                          <td>
                        <apex:outputText value="{!lineItemColumns[0].ilwCommentField}" style="width: 45px; height:15px;" rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}"/>
                        <apex:outputText value="{!lineItemColumns[0].ilwCommentField}" style="width: 45px; height:15px;" />
                        </td>
                        
                        <apex:repeat value="{!lineItemColumns}" var="l">
                            <td class="currency-cell showHidePOR">
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.porLineItem.ILW__c}"/>
                                </apex:outputText>
                            </td>
                             <td class="currency-cell showHideCWV" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.cwvLineItem.ILW__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideOth" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.OthLineItem.ILW__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                        <apex:repeat value="{!totalColumns}" var="l">
                            <td class="currency-cell showHidePOR total">
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.porLineItem.ilw}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideCWV total" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.cwvLineItem.ilw}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideOth total" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.OthLineItem.ilw}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                    </tr>
                    <tr class='collapsableD'>
                          <td class="data-row-sub-label" >&nbsp;&nbsp;&nbsp; TDF </td>
                          <td>
                        <apex:outputText value="{!lineItemColumns[0].tdfCommentField}" style="width: 45px; height:15px;" rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}"/>
                        <apex:outputText value="{!lineItemColumns[0].tdfCommentField}" style="width: 45px; height:15px;" />
                        </td>
                        
                        <apex:repeat value="{!lineItemColumns}" var="l">
                            <td class="currency-cell showHidePOR">
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.porLineItem.TDF__c}"/>
                                </apex:outputText>
                            </td>
                             <td class="currency-cell showHideCWV" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.cwvLineItem.TDF__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideOth">
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.OthLineItem.TDF__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                        <apex:repeat value="{!totalColumns}" var="l">
                            <td class="currency-cell showHidePOR total">
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.porLineItem.tdf}"/>
                                </apex:outputText>
                            </td>
                             <td class="currency-cell showHideCWV total" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.cwvLineItem.tdf}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideOth total" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.OthLineItem.tdf}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                    </tr>
                    <tr class='collapsableD'>
                          <td class="data-row-sub-label" >&nbsp;&nbsp;&nbsp; Fees </td>
                          <td>
                        <apex:outputText value="{!lineItemColumns[0].feesCommentField}" style="width: 45px; height:15px;" rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}"/>
                        <apex:outputText value="{!lineItemColumns[0].feesCommentField}" style="width: 45px; height:15px;" />
                        </td>

                        
                        <apex:repeat value="{!lineItemColumns}" var="l">
                            <td class="currency-cell showHidePOR">
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.porLineItem.Fees__c}"/>
                                </apex:outputText>
                            </td>
                             <td class="currency-cell showHideCWV" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.cwvLineItem.Fees__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideOth" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.OthLineItem.Fees__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                        <apex:repeat value="{!totalColumns}" var="l">
                            <td class="currency-cell showHidePOR total">
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.porLineItem.fees}"/>
                                </apex:outputText>
                            </td>
                             <td class="currency-cell showHideCWV total" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.cwvLineItem.fees}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideOth total" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.OthLineItem.fees}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                    </tr>
                    <tr class='collapsableD'>
                          <td class="data-row-sub-label" >&nbsp;&nbsp;&nbsp; Negotiation Buffer </td>
                          <td>
                        <apex:outputText value="{!lineItemColumns[0].negotiationBufferCommentField}" style="width: 45px; height:15px;" rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}"/>
                        <apex:outputText value="{!lineItemColumns[0].negotiationBufferCommentField}" style="width: 45px; height:15px;" />
                        </td>
                        
                        <apex:repeat value="{!lineItemColumns}" var="l">
                            <td class="currency-cell showHidePOR">
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.porLineItem.Negotiation_Buffer__c}"/>
                                </apex:outputText>
                            </td>
                             <td class="currency-cell showHideCWV" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.cwvLineItem.Negotiation_Buffer__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideOth" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.OthLineItem.Negotiation_Buffer__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                        <apex:repeat value="{!totalColumns}" var="l">
                            <td class="currency-cell showHidePOR total">
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.porLineItem.negotiationBuffer}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideCWV total" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.cwvLineItem.negotiationBuffer}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideOth total" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.OthLineItem.negotiationBuffer}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                    </tr>
                    <tr style="display:none;">
                        <td class="data-row-label">NSAD
                        </td><td>
                        <apex:outputText value="{!lineItemColumns[0].nsadCommentField}" style="width: 45px; height:15px;" rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}"/>
                        <apex:outputText value="{!lineItemColumns[0].nsadCommentField}" style="width: 45px; height:15px;" />
                        </td>
                        
                        <apex:repeat value="{!lineItemColumns}" var="l">
                            <td class="currency-cell showHidePOR">
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.porLineItem.NSAD__c}"/>
                                </apex:outputText>
                            </td>
                             <td class="currency-cell showHideCWV" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.cwvLineItem.NSAD__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideOth" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.OthLineItem.NSAD__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                        <apex:repeat value="{!totalColumns}" var="l">
                            <td class="currency-cell showHidePOR total">
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.porLineItem.nsad}"/>
                                </apex:outputText>
                            </td>
                             <td class="currency-cell showHideCWV total" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.cwvLineItem.nsad}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideOth total" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.OthLineItem.nsad}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                    </tr>
                     <tr>
                        <td class="data-row-label">ASP (NSAD)
                        </td><td>
                        <apex:outputText value="{!lineItemColumns[0].nsadCommentField}" style="width: 45px; height:15px;" rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}"/>
                        <apex:outputText value="{!lineItemColumns[0].nsadCommentField}" style="width: 45px; height:15px;" />
                        </td>
                        
                        <apex:repeat value="{!lineItemColumns}" var="l">
                            <td class="currency-cell showHidePOR">
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.porLineItem.NSAD__c}"/>
                                </apex:outputText>
                            </td>
                             <td class="currency-cell showHideCWV" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.cwvLineItem.NSAD__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideOth" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.OthLineItem.NSAD__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                        <apex:repeat value="{!totalColumns}" var="l">
                            <td class="currency-cell showHidePOR total">
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.porLineItem.aspnsad}"/>
                                </apex:outputText>
                            </td>
                             <td class="currency-cell showHideCWV total" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.cwvLineItem.aspnsad}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideOth total" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.OthLineItem.aspnsad}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                    </tr>
                    <tr class="single-underscore" style="border-bottom:1px solid #000;">
                        <td class="data-row-label">MCPU 
                        </td><td>
                        <apex:outputText value="{!lineItemColumns[0].mcpuCommentField}" style="width: 45px; height:15px;" rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}"/>
                        <apex:outputText value="{!lineItemColumns[0].mcpuCommentField}" style="width: 45px; height:15px;" />
                        </td>
                        
                        <apex:repeat value="{!lineItemColumns}" var="l">
                            <td class="currency-cell showHidePOR">
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.porLineItem.MCPU__c}"/>
                                </apex:outputText>
                            </td>
                             <td class="currency-cell showHideCWV" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.cwvLineItem.MCPU__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideOth" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.OthLineItem.MCPU__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                        <apex:repeat value="{!totalColumns}" var="l">
                            <td class="currency-cell showHidePOR total">
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.porLineItem.mcpu}"/>
                                </apex:outputText>
                            </td>
                             <td class="currency-cell showHideCWV total" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.cwvLineItem.mcpu}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideOth total" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.OthLineItem.mcpu}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                    </tr>
                    <tr class="double-underscore" style="border-bottom:3px double #000;">
                        <td class="data-row-label">Gross Margin</td><td></td>
                        <apex:repeat value="{!lineItemColumns}" var="l">
                            <td class="currency-cell showHidePOR">
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.porLineItem.Gross_Margin__c}"/>
                                </apex:outputText>
                            </td>
                             <td class="currency-cell showHideCWV" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.cwvLineItem.Gross_Margin__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideOth" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.OthLineItem.Gross_Margin__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                        <apex:repeat value="{!totalColumns}" var="l">
                            <td class="currency-cell showHidePOR total">
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.porLineItem.grossMargin}"/>
                                </apex:outputText>
                            </td>
                             <td class="currency-cell showHideCWV total" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.cwvLineItem.grossMargin}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideOth total" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.OthLineItem.grossMargin}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                    </tr>
                    <tr>
                        <td class="data-row-label">GM% </td><td></td>
                        <apex:repeat value="{!lineItemColumns}" var="l">
                            <td class="currency-cell showHidePOR">
                               <apex:outputText value="{0,number,###,##0.00%}">
                                    <apex:param value="{!l.porLineItem.GM__c/100}"/>
                                </apex:outputText>
                            </td>
                             <td class="currency-cell showHideCWV" >
                                 <apex:outputText value="{0,number,###,##0.00%}">
                                    <apex:param value="{!l.cwvLineItem.GM__c/100}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideOth" >
                                 <apex:outputText value="{0,number,###,##0.00%}">
                                    <apex:param value="{!l.OthLineItem.GM__c/100}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                        <apex:repeat value="{!totalColumns}" var="l">
                            <td class="currency-cell showHidePOR total">
                                <apex:outputText value="{0,number,###,##0.00%}">
                                    <apex:param value="{!l.porLineItem.gm}"/>
                                </apex:outputText>
                            </td>
                             <td class="currency-cell showHideCWV total" >
                                <apex:outputText value="{0,number,###,##0.00%}">
                                    <apex:param value="{!l.cwvLineItem.gm}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideOth total" >
                                <apex:outputText value="{0,number,###,##0.00%}">
                                    <apex:param value="{!l.OthLineItem.gm}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                    </tr>
                    <tr class="single-underscore" style="border-bottom:1px solid #000;">
                        <td class="data-row-label">A&amp;P</td><td></td>
                        <apex:repeat value="{!lineItemColumns}" var="l">
                            <td class="currency-cell showHidePOR">
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.porLineItem.AP__c}"/>
                                </apex:outputText>
                            </td>
                             <td class="currency-cell showHideCWV" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.cwvLineItem.AP__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideOth" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.OthLineItem.AP__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                        <apex:repeat value="{!totalColumns}" var="l">
                            <td class="currency-cell showHidePOR total">
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.porLineItem.aAndP}"/>
                                </apex:outputText>
                            </td>
                             <td class="currency-cell showHideCWV total" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.cwvLineItem.aAndP}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideOth total" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.OthLineItem.aAndP}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                    </tr>
                    <tr class="single-underscore" style="border-bottom:1px solid #000;">
                        <td class="data-row-label">Motoagents</td><td></td>
                        <apex:repeat value="{!lineItemColumns}" var="l">
                            <td class="currency-cell showHidePOR">
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.porLineItem.Motoagents__c}"/>
                                </apex:outputText>
                            </td>
                             <td class="currency-cell showHideCWV" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.cwvLineItem.Motoagents__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideOth" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.OthLineItem.Motoagents__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                        <apex:repeat value="{!totalColumns}" var="l">
                            <td class="currency-cell showHidePOR total">
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.porLineItem.motoagents}"/>
                                </apex:outputText>
                            </td>
                             <td class="currency-cell showHideCWV total" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.cwvLineItem.motoagents}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideOth total" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.OthLineItem.motoagents}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                    </tr>
                    <tr class="double-underscore" style="border-bottom:3px double #000;">
                        <td class="data-row-label">Contribution Margin</td><td></td>
                        <apex:repeat value="{!lineItemColumns}" var="l">
                            <td class="currency-cell showHidePOR">
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.porLineItem.Contribution_Margin__c}"/>
                                </apex:outputText>
                            </td>
                             <td class="currency-cell showHideCWV" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.cwvLineItem.Contribution_Margin__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideOth" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.OthLineItem.Contribution_Margin__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                        <apex:repeat value="{!totalColumns}" var="l">
                            <td class="currency-cell showHidePOR total">
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.porLineItem.contributionMargin}"/>
                                </apex:outputText>
                            </td>
                             <td class="currency-cell showHideCWV total" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.cwvLineItem.contributionMargin}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideOth total" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.OthLineItem.contributionMargin}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                    </tr>
                    <tr>
                        <td class="data-row-label">CM%</td><td></td>
                        <apex:repeat value="{!lineItemColumns}" var="l">
                            <td class="currency-cell showHidePOR">
                                <apex:outputText value="{0,number,###,##0.00%}">
                                    <apex:param value="{!l.porLineItem.CM__c/100}"/>
                                </apex:outputText>
                            </td>
                             <td class="currency-cell showHideCWV" >
                                 <apex:outputText value="{0,number,###,##0.00%}">
                                    <apex:param value="{!l.cwvLineItem.CM__c/100}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideOth" >
                                 <apex:outputText value="{0,number,###,##0.00%}">
                                    <apex:param value="{!l.OthLineItem.CM__c/100}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                        <apex:repeat value="{!totalColumns}" var="l">
                            <td class="currency-cell showHidePOR total">
                                <apex:outputText value="{0,number,###,##0.00%}">
                                    <apex:param value="{!l.porLineItem.cm}"/>
                                </apex:outputText>
                            </td>
                             <td class="currency-cell showHideCWV total" >
                                <apex:outputText value="{0,number,###,##0.00%}">
                                    <apex:param value="{!l.cwvLineItem.cm}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideOth total" >
                                <apex:outputText value="{0,number,###,##0.00%}">
                                    <apex:param value="{!l.OthLineItem.cm}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                    </tr>
                    
                    <!--  END PER UNIT -->
                    
                    <!--  BEGIN TOTAL TABLE -->
                    
                    <!--start of lower table-->
                    <tr>
                        <td class="section-header operator" colspan="{!1+(4*lineItemCount)+(4*totalItemCount)}" style="font-weight:bold;font-size:1.2em;text-transform:uppercase;border-bottom:1px solid #000;padding-top: 20px;">TOTAL</td>
                        <td></td>
                    </tr>             
                
                    <tr class="NSRow">
                        <td class="data-row-label">NSBD</td><td></td>
                        <apex:repeat value="{!lineItemColumns}" var="l">
                            <td class="currency-cell showHidePOR" >
                                <apex:outputText rendered="{!NOT(isExcelRender)}" value="{!IF(ABS(l.porLineItem.Total_NSBD__c ) >= 1000000000 , '$ ' + TEXT(l.porLineItem.Total_NSBD__c/1000000000) + 'G', IF(ABS(l.porLineItem.Total_NSBD__c ) >= 1000000, '$ ' + TEXT(l.porLineItem.Total_NSBD__c/1000000) + 'M', IF(ABS(l.porLineItem.Total_NSBD__c ) >= 1000, '$ ' + TEXT(l.porLineItem.Total_NSBD__c/1000) + 'K', '$ ' + TEXT( l.porLineItem.Total_NSBD__c))))}">
                                    <apex:param value="{!l.porLineItem.Total_NSBD__c}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!isExcelRender}" value="{!IF(ABS(l.porLineItem.Total_NSBD__c ) >= 1000000000, '$ ' + TEXT(l.porLineItem.Total_NSBD__c/1000000000) + 'G', IF(ABS(l.porLineItem.Total_NSBD__c ) >= 1000000, '$ ' + TEXT(l.porLineItem.Total_NSBD__c/1000000) + 'M', IF(ABS(l.porLineItem.Total_NSBD__c ) >= 1000, '$ ' + TEXT(l.porLineItem.Total_NSBD__c/1000) + 'K', '$ ' + TEXT( l.porLineItem.Total_NSBD__c))))}">
                                    <apex:param value="{!l.porLineItem.Total_NSBD__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideCWV">
                                <apex:outputText rendered="{!NOT(isExcelRender)}" value="{!IF(ABS(l.cwvLineItem.Total_NSBD__c)  >= 1000000000, '$ ' + TEXT(l.cwvLineItem.Total_NSBD__c/1000000000) + 'G', IF(ABS(l.cwvLineItem.Total_NSBD__c ) >= 1000000, '$ ' + TEXT(l.cwvLineItem.Total_NSBD__c/1000000) + 'M', IF(ABS(l.cwvLineItem.Total_NSBD__c ) >= 1000, '$ ' + TEXT(l.cwvLineItem.Total_NSBD__c/1000) + 'K', '$ ' + TEXT( l.cwvLineItem.Total_NSBD__c))))}">
                                    <apex:param value="{!l.cwvLineItem.Total_NSBD__c}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!isExcelRender}" value="{!IF(ABS(l.cwvLineItem.Total_NSBD__c ) >= 1000000000, '$ ' + TEXT(l.cwvLineItem.Total_NSBD__c/1000000000) + 'G', IF(ABS(l.cwvLineItem.Total_NSBD__c ) >= 1000000, '$ ' + TEXT(l.cwvLineItem.Total_NSBD__c/1000000) + 'M', IF(ABS(l.cwvLineItem.Total_NSBD__c ) >= 1000, '$ ' + TEXT(l.cwvLineItem.Total_NSBD__c/1000) + 'K', '$ ' + TEXT( l.cwvLineItem.Total_NSBD__c))))}">> 
                                    <apex:param value="{!l.cwvLineItem.Total_NSBD__c}"/> 
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideOth">
                                <apex:outputText rendered="{!NOT(isExcelRender)}" value="{!IF(ABS(l.OthLineItem.Total_NSBD__c)  >= 1000000000, '$ ' + TEXT(l.OthLineItem.Total_NSBD__c/1000000000) + 'G', IF(ABS(l.OthLineItem.Total_NSBD__c ) >= 1000000, '$ ' + TEXT(l.OthLineItem.Total_NSBD__c/1000000) + 'M', IF(ABS(l.OthLineItem.Total_NSBD__c ) >= 1000, '$ ' + TEXT(l.OthLineItem.Total_NSBD__c/1000) + 'K', '$ ' + TEXT( l.OthLineItem.Total_NSBD__c))))}">
                                    <apex:param value="{!l.OthLineItem.Total_NSBD__c}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!isExcelRender}" value="{!IF(ABS(l.OthLineItem.Total_NSBD__c ) >= 1000000000, '$ ' + TEXT(l.OthLineItem.Total_NSBD__c/1000000000) + 'G', IF(ABS(l.OthLineItem.Total_NSBD__c ) >= 1000000, '$ ' + TEXT(l.OthLineItem.Total_NSBD__c/1000000) + 'M', IF(ABS(l.OthLineItem.Total_NSBD__c ) >= 1000, '$ ' + TEXT(l.OthLineItem.Total_NSBD__c/1000) + 'K', '$ ' + TEXT( l.OthLineItem.Total_NSBD__c))))}">> 
                                    <apex:param value="{!l.OthLineItem.Total_NSBD__c}"/> 
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                        <apex:repeat value="{!totalColumns}" var="l">
                             <td class="currency-cell showHidePOR total" >
                                <apex:outputText value="{!IF(ABS(l.TotalporLineItem.NSBD ) >= 1000000000, '$ ' + TEXT(l.TotalporLineItem.NSBD/1000000000) + 'G', IF(ABS(l.TotalporLineItem.NSBD ) >= 1000000, '$ ' + TEXT(l.TotalporLineItem.NSBD/1000000) + 'M', IF(ABS(l.TotalporLineItem.NSBD ) >= 1000, '$ ' + TEXT(l.TotalporLineItem.NSBD/1000) + 'K', '$ ' + TEXT( l.TotalporLineItem.NSBD))))}">
                                    <apex:param value="{!l.TotalporLineItem.NSBD}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideCWV total">
                                <apex:outputText value="{!IF(ABS(l.TotalCwvLineItem.NSBD ) >= 1000000000, '$ ' + TEXT(l.TotalCwvLineItem.NSBD/1000000000) + 'G', IF(ABS(l.TotalCwvLineItem.NSBD ) >= 1000000, '$ ' + TEXT(l.TotalCwvLineItem.NSBD/1000000) + 'M', IF(ABS(l.TotalCwvLineItem.NSBD ) >= 1000, '$ ' + TEXT(l.TotalCwvLineItem.NSBD/1000) + 'K', '$ ' + TEXT( l.TotalCwvLineItem.NSBD))))}">
                                    <apex:param value="{!l.TotalCwvLineItem.NSBD}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideOth total">
                                <apex:outputText value="{!IF(ABS(l.TotalOthLineItem.NSBD ) >= 1000000000, '$ ' + TEXT(l.TotalOthLineItem.NSBD/1000000000) + 'G', IF(ABS(l.TotalOthLineItem.NSBD ) >= 1000000, '$ ' + TEXT(l.TotalOthLineItem.NSBD/1000000) + 'M', IF(ABS(l.TotalOthLineItem.NSBD ) >= 1000, '$ ' + TEXT(l.TotalOthLineItem.NSBD/1000) + 'K', '$ ' + TEXT( l.TotalOthLineItem.NSBD))))}">
                                    <apex:param value="{!l.TotalOthLineItem.NSBD}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                    </tr>
                    <tr class="collapsableNS">
                        <td class="data-row-sub-label" >&nbsp;&nbsp;&nbsp; SDF </td>
                        <td>
                        <apex:outputText value="{!lineItemColumns[0].sdfOpCommentField}" style="width: 45px; height:15px;" />
                        </td>
                        <apex:repeat value="{!lineItemColumns}" var="l">
                             <td class="currency-cell showHidePOR" >
                                <apex:outputText rendered="{!NOT(isExcelRender)}" value="{!IF(ABS(l.porLineItem.Total_SDF__c ) >= 1000000000, '$ ' + TEXT(l.porLineItem.Total_SDF__c/1000000000) + 'G', IF(ABS(l.porLineItem.Total_SDF__c ) >= 1000000, '$ ' + TEXT(l.porLineItem.Total_SDF__c/1000000) + 'M', IF(ABS(l.porLineItem.Total_SDF__c ) >= 1000, '$ ' + TEXT(l.porLineItem.Total_SDF__c/1000) + 'K', '$ ' + TEXT( l.porLineItem.Total_SDF__c))))}">
                                    <apex:param value="{!l.porLineItem.Total_SDF__c}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!isExcelRender}" value="{!IF(ABS(l.porLineItem.Total_SDF__c ) >= 1000000000, '$ ' + TEXT(l.porLineItem.Total_SDF__c/1000000000) + 'G', IF(ABS(l.porLineItem.Total_SDF__c ) >= 1000000, '$ ' + TEXT(l.porLineItem.Total_SDF__c/1000000) + 'M', IF(ABS(l.porLineItem.Total_SDF__c ) >= 1000, '$ ' + TEXT(l.porLineItem.Total_SDF__c/1000) + 'K', '$ ' + TEXT( l.porLineItem.Total_SDF__c))))}">
                                    <apex:param value="{!l.porLineItem.Total_SDF__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideCWV">
                                <apex:outputText rendered="{!NOT(isExcelRender)}" value="{!IF(ABS(l.cwvLineItem.Total_SDF__c ) >= 1000000000, '$ ' + TEXT(l.cwvLineItem.Total_SDF__c/1000000000) + 'G', IF(ABS(l.cwvLineItem.Total_SDF__c ) >= 1000000, '$ ' + TEXT(l.cwvLineItem.Total_SDF__c/1000000) + 'M', IF(ABS(l.cwvLineItem.Total_SDF__c ) >= 1000, '$ ' + TEXT(l.cwvLineItem.Total_SDF__c/1000) + 'K', '$ ' + TEXT( l.cwvLineItem.Total_SDF__c))))}">
                                    <apex:param value="{!l.cwvLineItem.Total_SDF__c}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!isExcelRender}" value="{!IF(ABS(l.cwvLineItem.Total_SDF__c ) >= 1000000000, '$ ' + TEXT(l.cwvLineItem.Total_SDF__c/1000000000) + 'G', IF(ABS(l.cwvLineItem.Total_SDF__c ) >= 1000000, '$ ' + TEXT(l.cwvLineItem.Total_SDF__c/1000000) + 'M', IF(ABS(l.cwvLineItem.Total_SDF__c ) >= 1000, '$ ' + TEXT(l.cwvLineItem.Total_SDF__c/1000) + 'K', '$ ' + TEXT( l.cwvLineItem.Total_SDF__c))))}">
                                    <apex:param value="{!l.cwvLineItem.Total_SDF__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideOth">
                                <apex:outputText rendered="{!NOT(isExcelRender)}" value="{!IF(ABS(l.OthLineItem.Total_SDF__c ) >= 1000000000, '$ ' + TEXT(l.OthLineItem.Total_SDF__c/1000000000) + 'G', IF(ABS(l.OthLineItem.Total_SDF__c ) >= 1000000, '$ ' + TEXT(l.OthLineItem.Total_SDF__c/1000000) + 'M', IF(ABS(l.OthLineItem.Total_SDF__c ) >= 1000, '$ ' + TEXT(l.OthLineItem.Total_SDF__c/1000) + 'K', '$ ' + TEXT( l.OthLineItem.Total_SDF__c))))}">
                                    <apex:param value="{!l.OthLineItem.Total_SDF__c}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!isExcelRender}" value="{!IF(ABS(l.OthLineItem.Total_SDF__c ) >= 1000000000, '$ ' + TEXT(l.OthLineItem.Total_SDF__c/1000000000) + 'G', IF(ABS(l.OthLineItem.Total_SDF__c ) >= 1000000, '$ ' + TEXT(l.OthLineItem.Total_SDF__c/1000000) + 'M', IF(ABS(l.OthLineItem.Total_SDF__c ) >= 1000, '$ ' + TEXT(l.OthLineItem.Total_SDF__c/1000) + 'K', '$ ' + TEXT( l.OthLineItem.Total_SDF__c))))}">
                                    <apex:param value="{!l.OthLineItem.Total_SDF__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                        <apex:repeat value="{!totalColumns}" var="l">
                             <td class="currency-cell showHidePOR total" >
                                <apex:outputText value="{!IF(ABS(l.TotalporLineItem.sdf ) >= 1000000000, '$ ' + TEXT(l.TotalporLineItem.sdf/1000000000) + 'G', IF(ABS(l.TotalporLineItem.sdf ) >= 1000000, '$ ' + TEXT(l.TotalporLineItem.sdf/1000000) + 'M', IF(ABS(l.TotalporLineItem.sdf ) >= 1000, '$ ' + TEXT(l.TotalporLineItem.sdf/1000) + 'K', '$ ' + TEXT( l.TotalporLineItem.sdf))))}">
                                    <apex:param value="{!l.TotalporLineItem.sdf}"/>
                                </apex:outputText>
                            </td>
                             <td class="currency-cell showHideCWV total" >
                                <apex:outputText value="{!IF(ABS(l.TotalCwvLineItem.sdf ) >= 1000000000, '$ ' + TEXT(l.TotalCwvLineItem.sdf/1000000000) + 'G', IF(ABS(l.TotalCwvLineItem.sdf ) >= 1000000, '$ ' + TEXT(l.TotalCwvLineItem.sdf/1000000) + 'M', IF(ABS(l.TotalCwvLineItem.sdf ) >= 1000, '$ ' + TEXT(l.TotalCwvLineItem.sdf/1000) + 'K', '$ ' + TEXT( l.TotalCwvLineItem.sdf))))}">
                                    <apex:param value="{!l.TotalCwvLineItem.sdf}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideOth total" >
                                <apex:outputText value="{!IF(ABS(l.TotalOthLineItem.sdf ) >= 1000000000, '$ ' + TEXT(l.TotalOthLineItem.sdf/1000000000) + 'G', IF(ABS(l.TotalOthLineItem.sdf ) >= 1000000, '$ ' + TEXT(l.TotalOthLineItem.sdf/1000000) + 'M', IF(ABS(l.TotalOthLineItem.sdf ) >= 1000, '$ ' + TEXT(l.TotalOthLineItem.sdf/1000) + 'K', '$ ' + TEXT( l.TotalOthLineItem.sdf))))}">
                                    <apex:param value="{!l.TotalOthLineItem.sdf}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                    </tr>
                    <tr class="collapsableNS">
                        <td class="data-row-sub-label" >&nbsp;&nbsp;&nbsp; COOP </td><td>
                        <apex:outputText value="{!lineItemColumns[0].coopOpCommentField}" style="width: 45px; height:15px;" rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}"/>
                        <apex:outputText value="{!lineItemColumns[0].coopOpCommentField}" style="width: 45px; height:15px;" />
                        </td>
                        <apex:repeat value="{!lineItemColumns}" var="l">
                            <td class="currency-cell showHidePOR" >
                                <apex:outputText rendered="{!NOT(isExcelRender)}" value="{!IF(ABS(l.porLineItem.Total_COOP__c ) >= 1000000000, '$ ' + TEXT(l.porLineItem.Total_COOP__c/1000000000) + 'G', IF(ABS(l.porLineItem.Total_COOP__c ) >= 1000000, '$ ' + TEXT(l.porLineItem.Total_COOP__c/1000000) + 'M', IF(ABS(l.porLineItem.Total_COOP__c ) >= 1000, '$ ' + TEXT(l.porLineItem.Total_COOP__c/1000) + 'K', '$ ' + TEXT( l.porLineItem.Total_COOP__c))))}">
                                    <apex:param value="{!l.porLineItem.Total_COOP__c}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!isExcelRender}" value="{!IF(ABS(l.porLineItem.Total_COOP__c ) >= 1000000000, '$ ' + TEXT(l.porLineItem.Total_COOP__c/1000000000) + 'G', IF(ABS(l.porLineItem.Total_COOP__c ) >= 1000000, '$ ' + TEXT(l.porLineItem.Total_COOP__c/1000000) + 'M', IF(ABS(l.porLineItem.Total_COOP__c ) >= 1000, '$ ' + TEXT(l.porLineItem.Total_COOP__c/1000) + 'K', '$ ' + TEXT( l.porLineItem.Total_COOP__c))))}">
                                    <apex:param value="{!l.porLineItem.Total_COOP__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideCWV">
                                <apex:outputText rendered="{!NOT(isExcelRender)}" value="{!IF(ABS(l.cwvLineItem.Total_COOP__c ) >= 1000000000, '$ ' + TEXT(l.cwvLineItem.Total_COOP__c/1000000000) + 'G', IF(ABS(l.cwvLineItem.Total_COOP__c ) >= 1000000, '$ ' + TEXT(l.cwvLineItem.Total_COOP__c/1000000) + 'M', IF(ABS(l.cwvLineItem.Total_COOP__c ) >= 1000, '$ ' + TEXT(l.cwvLineItem.Total_COOP__c/1000) + 'K', '$ ' + TEXT( l.cwvLineItem.Total_COOP__c))))}">
                                    <apex:param value="{!l.cwvLineItem.Total_COOP__c}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!isExcelRender}" value="{!IF(ABS(l.cwvLineItem.Total_COOP__c ) >= 1000000000, '$ ' + TEXT(l.cwvLineItem.Total_COOP__c/1000000000) + 'G', IF(ABS(l.cwvLineItem.Total_COOP__c ) >= 1000000, '$ ' + TEXT(l.cwvLineItem.Total_COOP__c/1000000) + 'M', IF(ABS(l.cwvLineItem.Total_COOP__c ) >= 1000, '$ ' + TEXT(l.cwvLineItem.Total_COOP__c/1000) + 'K', '$ ' + TEXT( l.cwvLineItem.Total_COOP__c))))}">
                                    <apex:param value="{!l.cwvLineItem.Total_COOP__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideOth">
                                <apex:outputText rendered="{!NOT(isExcelRender)}" value="{!IF(ABS(l.OthLineItem.Total_COOP__c ) >= 1000000000, '$ ' + TEXT(l.OthLineItem.Total_COOP__c/1000000000) + 'G', IF(ABS(l.OthLineItem.Total_COOP__c ) >= 1000000, '$ ' + TEXT(l.OthLineItem.Total_COOP__c/1000000) + 'M', IF(ABS(l.OthLineItem.Total_COOP__c ) >= 1000, '$ ' + TEXT(l.OthLineItem.Total_COOP__c/1000) + 'K', '$ ' + TEXT( l.OthLineItem.Total_COOP__c))))}">
                                    <apex:param value="{!l.OthLineItem.Total_COOP__c}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!isExcelRender}" value="{!IF(ABS(l.OthLineItem.Total_COOP__c ) >= 1000000000, '$ ' + TEXT(l.OthLineItem.Total_COOP__c/1000000000) + 'G', IF(ABS(l.OthLineItem.Total_COOP__c ) >= 1000000, '$ ' + TEXT(l.OthLineItem.Total_COOP__c/1000000) + 'M', IF(ABS(l.OthLineItem.Total_COOP__c ) >= 1000, '$ ' + TEXT(l.OthLineItem.Total_COOP__c/1000) + 'K', '$ ' + TEXT( l.OthLineItem.Total_COOP__c))))}">
                                    <apex:param value="{!l.OthLineItem.Total_COOP__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                        <apex:repeat value="{!totalColumns}" var="l">
                             <td class="currency-cell showHidePOR total" >
                                <apex:outputText value="{!IF(ABS(l.TotalPorLineItem.coop ) >= 1000000000, '$ ' + TEXT(l.TotalPorLineItem.coop/1000000000) + 'G', IF(ABS(l.TotalPorLineItem.coop ) >= 1000000, '$ ' + TEXT(l.TotalPorLineItem.coop/1000000) + 'M', IF(ABS(l.TotalPorLineItem.coop ) >= 1000, '$ ' + TEXT(l.TotalPorLineItem.coop/1000) + 'K', '$ ' + TEXT( l.TotalPorLineItem.coop))))}">
                                    <apex:param value="{!l.TotalPorLineItem.coop}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideCWV total">
                                <apex:outputText value="{!IF(ABS(l.TotalCwvLineItem.coop ) >= 1000000000, '$ ' + TEXT(l.TotalCwvLineItem.coop/1000000000) + 'G', IF(ABS(l.TotalCwvLineItem.coop ) >= 1000000, '$ ' + TEXT(l.TotalCwvLineItem.coop/1000000) + 'M', IF(ABS(l.TotalCwvLineItem.coop ) >= 1000, '$ ' + TEXT(l.TotalCwvLineItem.coop/1000) + 'K', '$ ' + TEXT( l.TotalCwvLineItem.coop))))}">
                                    <apex:param value="{!l.TotalCwvLineItem.coop}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideOth total">
                                <apex:outputText value="{!IF(ABS(l.TotalOthLineItem.coop ) >= 1000000000, '$ ' + TEXT(l.TotalOthLineItem.coop/1000000000) + 'G', IF(ABS(l.TotalOthLineItem.coop ) >= 1000000, '$ ' + TEXT(l.TotalOthLineItem.coop/1000000) + 'M', IF(ABS(l.TotalOthLineItem.coop ) >= 1000, '$ ' + TEXT(l.TotalOthLineItem.coop/1000) + 'K', '$ ' + TEXT( l.TotalOthLineItem.coop))))}">
                                    <apex:param value="{!l.TotalOthLineItem.coop}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                    </tr>
                    <tr class="collapsableNS">
                        <td class="data-row-sub-label" >&nbsp;&nbsp;&nbsp; MDF </td><td>
                        <apex:outputText value="{!lineItemColumns[0].mdfOpCommentField}" style="width: 45px; height:15px;" rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}"/>
                        <apex:outputText value="{!lineItemColumns[0].mdfOpCommentField}" style="width: 45px; height:15px;" />
                        </td>
                        <apex:repeat value="{!lineItemColumns}" var="l">
                             <td class="currency-cell showHidePOR" >
                                <apex:outputText rendered="{!NOT(isExcelRender)}" value="{!IF(ABS(l.porLineItem.Total_MDF__c ) >= 1000000000, '$ ' + TEXT(l.porLineItem.Total_MDF__c/1000000000) + 'G', IF(ABS(l.porLineItem.Total_MDF__c ) >= 1000000, '$ ' + TEXT(l.porLineItem.Total_MDF__c/1000000) + 'M', IF(ABS(l.porLineItem.Total_MDF__c ) >= 1000, '$ ' + TEXT(l.porLineItem.Total_MDF__c/1000) + 'K', '$ ' + TEXT( l.porLineItem.Total_MDF__c))))}">
                                    <apex:param value="{!l.porLineItem.Total_MDF__c}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!isExcelRender}" value="{!IF(ABS(l.porLineItem.Total_MDF__c ) >= 1000000000, '$ ' + TEXT(l.porLineItem.Total_MDF__c/1000000000) + 'G', IF(ABS(l.porLineItem.Total_MDF__c ) >= 1000000, '$ ' + TEXT(l.porLineItem.Total_MDF__c/1000000) + 'M', IF(ABS(l.porLineItem.Total_MDF__c ) >= 1000, '$ ' + TEXT(l.porLineItem.Total_MDF__c/1000) + 'K', '$ ' + TEXT( l.porLineItem.Total_MDF__c))))}">
                                    <apex:param value="{!l.porLineItem.Total_MDF__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideCWV">
                                <apex:outputText rendered="{!NOT(isExcelRender)}" value="{!IF(ABS(l.cwvLineItem.Total_MDF__c ) >= 1000000000, '$ ' + TEXT(l.cwvLineItem.Total_MDF__c/1000000000) + 'G', IF(ABS(l.cwvLineItem.Total_MDF__c ) >= 1000000, '$ ' + TEXT(l.cwvLineItem.Total_MDF__c/1000000) + 'M', IF(ABS(l.cwvLineItem.Total_MDF__c ) >= 1000, '$ ' + TEXT(l.cwvLineItem.Total_MDF__c/1000) + 'K', '$ ' + TEXT( l.cwvLineItem.Total_MDF__c))))}">
                                    <apex:param value="{!l.cwvLineItem.Total_MDF__c}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!isExcelRender}" value="{!IF(ABS(l.cwvLineItem.Total_MDF__c ) >= 1000000000, '$ ' + TEXT(l.cwvLineItem.Total_MDF__c/1000000000) + 'G', IF(ABS(l.cwvLineItem.Total_MDF__c ) >= 1000000, '$ ' + TEXT(l.cwvLineItem.Total_MDF__c/1000000) + 'M', IF(ABS(l.cwvLineItem.Total_MDF__c ) >= 1000, '$ ' + TEXT(l.cwvLineItem.Total_MDF__c/1000) + 'K', '$ ' + TEXT( l.cwvLineItem.Total_MDF__c))))}">
                                    <apex:param value="{!l.cwvLineItem.Total_MDF__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideOth">
                                <apex:outputText rendered="{!NOT(isExcelRender)}" value="{!IF(ABS(l.OthLineItem.Total_MDF__c ) >= 1000000000, '$ ' + TEXT(l.OthLineItem.Total_MDF__c/1000000000) + 'G', IF(ABS(l.OthLineItem.Total_MDF__c ) >= 1000000, '$ ' + TEXT(l.OthLineItem.Total_MDF__c/1000000) + 'M', IF(ABS(l.OthLineItem.Total_MDF__c ) >= 1000, '$ ' + TEXT(l.OthLineItem.Total_MDF__c/1000) + 'K', '$ ' + TEXT( l.OthLineItem.Total_MDF__c))))}">
                                    <apex:param value="{!l.OthLineItem.Total_MDF__c}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!isExcelRender}" value="{!IF(ABS(l.OthLineItem.Total_MDF__c ) >= 1000000000, '$ ' + TEXT(l.OthLineItem.Total_MDF__c/1000000000) + 'G', IF(ABS(l.OthLineItem.Total_MDF__c ) >= 1000000, '$ ' + TEXT(l.OthLineItem.Total_MDF__c/1000000) + 'M', IF(ABS(l.OthLineItem.Total_MDF__c ) >= 1000, '$ ' + TEXT(l.OthLineItem.Total_MDF__c/1000) + 'K', '$ ' + TEXT( l.OthLineItem.Total_MDF__c))))}">
                                    <apex:param value="{!l.OthLineItem.Total_MDF__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                        <apex:repeat value="{!totalColumns}" var="l">
                             <td class="currency-cell showHidePOR total" >
                                <apex:outputText value="{!IF(ABS(l.TotalPorLineItem.mdf ) >= 1000000000, '$ ' + TEXT(l.TotalPorLineItem.mdf/1000000000) + 'G', IF(ABS(l.TotalPorLineItem.mdf ) >= 1000000, '$ ' + TEXT(l.TotalPorLineItem.mdf/1000000) + 'M', IF(ABS(l.TotalPorLineItem.mdf ) >= 1000, '$ ' + TEXT(l.TotalPorLineItem.mdf/1000) + 'K', '$ ' + TEXT( l.TotalPorLineItem.mdf))))}">
                                    <apex:param value="{!l.TotalPorLineItem.mdf}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideCWV total">
                                <apex:outputText value="{!IF(ABS(l.TotalCwvLineItem.mdf ) >= 1000000000, '$ ' + TEXT(l.TotalCwvLineItem.mdf/1000000000) + 'G', IF(ABS(l.TotalCwvLineItem.mdf ) >= 1000000, '$ ' + TEXT(l.TotalCwvLineItem.mdf/1000000) + 'M', IF(ABS(l.TotalCwvLineItem.mdf ) >= 1000, '$ ' + TEXT(l.TotalCwvLineItem.mdf/1000) + 'K', '$ ' + TEXT( l.TotalCwvLineItem.mdf))))}">
                                    <apex:param value="{!l.TotalCwvLineItem.mdf}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideOth total">
                                <apex:outputText value="{!IF(ABS(l.TotalOthLineItem.mdf ) >= 1000000000, '$ ' + TEXT(l.TotalOthLineItem.mdf/1000000000) + 'G', IF(ABS(l.TotalOthLineItem.mdf ) >= 1000000, '$ ' + TEXT(l.TotalOthLineItem.mdf/1000000) + 'M', IF(ABS(l.TotalOthLineItem.mdf ) >= 1000, '$ ' + TEXT(l.TotalOthLineItem.mdf/1000) + 'K', '$ ' + TEXT( l.TotalOthLineItem.mdf))))}">
                                    <apex:param value="{!l.TotalOthLineItem.mdf}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                    </tr>
                    <tr class="collapsableNS">
                        <td class="data-row-sub-label" >&nbsp;&nbsp;&nbsp; iMDF </td><td>
                        <apex:outputText value="{!lineItemColumns[0].imdfOpCommentField}" style="width: 45px; height:15px;" rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}"/>
                        <apex:outputText value="{!lineItemColumns[0].imdfOpCommentField}" style="width: 45px; height:15px;" />
                        </td>
                        <apex:repeat value="{!lineItemColumns}" var="l">
                            <td class="currency-cell showHidePOR" >
                                <apex:outputText rendered="{!NOT(isExcelRender)}" value="{!IF(ABS(l.porLineItem.Total_iMDF__c ) >= 1000000000, '$ ' + TEXT(l.porLineItem.Total_iMDF__c/1000000000) + 'G', IF(ABS(l.porLineItem.Total_iMDF__c ) >= 1000000, '$ ' + TEXT(l.porLineItem.Total_iMDF__c/1000000) + 'M', IF(ABS(l.porLineItem.Total_iMDF__c ) >= 1000, '$ ' + TEXT(l.porLineItem.Total_iMDF__c/1000) + 'K', '$ ' + TEXT( l.porLineItem.Total_iMDF__c))))}">
                                    <apex:param value="{!l.porLineItem.Total_iMDF__c}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!isExcelRender}" value="{!IF(ABS(l.porLineItem.Total_iMDF__c ) >= 1000000000, '$ ' + TEXT(l.porLineItem.Total_iMDF__c/1000000000) + 'G', IF(ABS(l.porLineItem.Total_iMDF__c ) >= 1000000, '$ ' + TEXT(l.porLineItem.Total_iMDF__c/1000000) + 'M', IF(ABS(l.porLineItem.Total_iMDF__c ) >= 1000, '$ ' + TEXT(l.porLineItem.Total_iMDF__c/1000) + 'K', '$ ' + TEXT( l.porLineItem.Total_iMDF__c))))}">
                                    <apex:param value="{!l.porLineItem.Total_iMDF__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideCWV">
                                <apex:outputText rendered="{!NOT(isExcelRender)}" value="{!IF(ABS(l.cwvLineItem.Total_iMDF__c ) >= 1000000000, '$ ' + TEXT(l.cwvLineItem.Total_iMDF__c/1000000000) + 'G', IF(ABS(l.cwvLineItem.Total_iMDF__c ) >= 1000000, '$ ' + TEXT(l.cwvLineItem.Total_iMDF__c/1000000) + 'M', IF(ABS(l.cwvLineItem.Total_iMDF__c ) >= 1000, '$ ' + TEXT(l.cwvLineItem.Total_iMDF__c/1000) + 'K', '$ ' + TEXT( l.cwvLineItem.Total_iMDF__c))))}">
                                    <apex:param value="{!l.cwvLineItem.Total_iMDF__c}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!isExcelRender}" value="{!IF(ABS(l.cwvLineItem.Total_iMDF__c ) >= 1000000000, '$ ' + TEXT(l.cwvLineItem.Total_iMDF__c/1000000000) + 'G', IF(ABS(l.cwvLineItem.Total_iMDF__c ) >= 1000000, '$ ' + TEXT(l.cwvLineItem.Total_iMDF__c/1000000) + 'M', IF(ABS(l.cwvLineItem.Total_iMDF__c ) >= 1000, '$ ' + TEXT(l.cwvLineItem.Total_iMDF__c/1000) + 'K', '$ ' + TEXT( l.cwvLineItem.Total_iMDF__c))))}">
                                    <apex:param value="{!l.cwvLineItem.Total_iMDF__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideOth">
                                <apex:outputText rendered="{!NOT(isExcelRender)}" value="{!IF(ABS(l.OthLineItem.Total_iMDF__c ) >= 1000000000, '$ ' + TEXT(l.OthLineItem.Total_iMDF__c/1000000000) + 'G', IF(ABS(l.OthLineItem.Total_iMDF__c ) >= 1000000, '$ ' + TEXT(l.OthLineItem.Total_iMDF__c/1000000) + 'M', IF(ABS(l.OthLineItem.Total_iMDF__c ) >= 1000, '$ ' + TEXT(l.OthLineItem.Total_iMDF__c/1000) + 'K', '$ ' + TEXT( l.OthLineItem.Total_iMDF__c))))}">
                                    <apex:param value="{!l.OthLineItem.Total_iMDF__c}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!isExcelRender}" value="{!IF(ABS(l.OthLineItem.Total_iMDF__c ) >= 1000000000, '$ ' + TEXT(l.OthLineItem.Total_iMDF__c/1000000000) + 'G', IF(ABS(l.OthLineItem.Total_iMDF__c ) >= 1000000, '$ ' + TEXT(l.OthLineItem.Total_iMDF__c/1000000) + 'M', IF(ABS(l.OthLineItem.Total_iMDF__c ) >= 1000, '$ ' + TEXT(l.OthLineItem.Total_iMDF__c/1000) + 'K', '$ ' + TEXT( l.OthLineItem.Total_iMDF__c))))}">
                                    <apex:param value="{!l.OthLineItem.Total_iMDF__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                        <apex:repeat value="{!totalColumns}" var="l">
                             <td class="currency-cell showHidePOR total" >
                                <apex:outputText value="{!IF(ABS(l.TotalPorLineItem.imdf ) >= 1000000000, '$ ' + TEXT(l.TotalPorLineItem.imdf/1000000000) + 'G', IF(ABS(l.TotalPorLineItem.imdf ) >= 1000000, '$ ' + TEXT(l.TotalPorLineItem.imdf/1000000) + 'M', IF(ABS(l.TotalPorLineItem.imdf ) >= 1000, '$ ' + TEXT(l.TotalPorLineItem.imdf/1000) + 'K', '$ ' + TEXT( l.TotalPorLineItem.imdf))))}">
                                    <apex:param value="{!l.TotalPorLineItem.imdf}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideCWV total">
                                <apex:outputText value="{!IF(ABS(l.TotalCwvLineItem.imdf ) >= 1000000000, '$ ' + TEXT(l.TotalCwvLineItem.imdf/1000000000) + 'G', IF(ABS(l.TotalCwvLineItem.imdf ) >= 1000000, '$ ' + TEXT(l.TotalCwvLineItem.imdf/1000000) + 'M', IF(ABS(l.TotalCwvLineItem.imdf ) >= 1000, '$ ' + TEXT(l.TotalCwvLineItem.imdf/1000) + 'K', '$ ' + TEXT( l.TotalCwvLineItem.imdf))))}">
                                    <apex:param value="{!l.TotalCwvLineItem.imdf}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideOth total">
                                <apex:outputText value="{!IF(ABS(l.TotalOthLineItem.imdf ) >= 1000000000, '$ ' + TEXT(l.TotalOthLineItem.imdf/1000000000) + 'G', IF(ABS(l.TotalOthLineItem.imdf ) >= 1000000, '$ ' + TEXT(l.TotalOthLineItem.imdf/1000000) + 'M', IF(ABS(l.TotalOthLineItem.imdf ) >= 1000, '$ ' + TEXT(l.TotalOthLineItem.imdf/1000) + 'K', '$ ' + TEXT( l.TotalOthLineItem.imdf))))}">
                                    <apex:param value="{!l.TotalOthLineItem.imdf}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                    </tr>
                    <tr class="collapsableNS">
                        <td class="data-row-sub-label" >&nbsp;&nbsp;&nbsp; SVM </td><td>
                        <apex:outputText value="{!lineItemColumns[0].svmOpCommentField}" style="width: 45px; height:15px;" rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}"/>
                        <apex:outputText value="{!lineItemColumns[0].svmOpCommentField}" style="width: 45px; height:15px;" />
                        </td>
                        <apex:repeat value="{!lineItemColumns}" var="l">
                             <td class="currency-cell showHidePOR" >
                                <apex:outputText rendered="{!NOT(isExcelRender)}" value="{!IF(ABS(l.porLineItem.Total_SVM__c ) >= 1000000000, '$ ' + TEXT(l.porLineItem.Total_SVM__c/1000000000) + 'G', IF(ABS(l.porLineItem.Total_SVM__c ) >= 1000000, '$ ' + TEXT(l.porLineItem.Total_SVM__c/1000000) + 'M', IF(ABS(l.porLineItem.Total_SVM__c ) >= 1000, '$ ' + TEXT(l.porLineItem.Total_SVM__c/1000) + 'K', '$ ' + TEXT( l.porLineItem.Total_SVM__c))))}">
                                    <apex:param value="{!l.porLineItem.Total_SVM__c}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!isExcelRender}" value="{!IF(ABS(l.porLineItem.Total_SVM__c ) >= 1000000000, '$ ' + TEXT(l.porLineItem.Total_SVM__c/1000000000) + 'G', IF(ABS(l.porLineItem.Total_SVM__c ) >= 1000000, '$ ' + TEXT(l.porLineItem.Total_SVM__c/1000000) + 'M', IF(ABS(l.porLineItem.Total_SVM__c ) >= 1000, '$ ' + TEXT(l.porLineItem.Total_SVM__c/1000) + 'K', '$ ' + TEXT( l.porLineItem.Total_SVM__c))))}">
                                    <apex:param value="{!l.cwvLineItem.Total_SVM__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideCWV">
                                <apex:outputText rendered="{!NOT(isExcelRender)}" value="{!IF(ABS(l.cwvLineItem.Total_SVM__c ) >= 1000000000, '$ ' + TEXT(l.cwvLineItem.Total_SVM__c/1000000000) + 'G', IF(ABS(l.cwvLineItem.Total_SVM__c ) >= 1000000, '$ ' + TEXT(l.cwvLineItem.Total_SVM__c/1000000) + 'M', IF(ABS(l.cwvLineItem.Total_SVM__c ) >= 1000, '$ ' + TEXT(l.cwvLineItem.Total_SVM__c/1000) + 'K', '$ ' + TEXT( l.cwvLineItem.Total_SVM__c))))}">
                                    <apex:param value="{!l.cwvLineItem.Total_SVM__c}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!isExcelRender}" value="{!IF(ABS(l.cwvLineItem.Total_SVM__c ) >= 1000000000, '$ ' + TEXT(l.cwvLineItem.Total_SVM__c/1000000000) + 'G', IF(ABS(l.cwvLineItem.Total_SVM__c ) >= 1000000, '$ ' + TEXT(l.cwvLineItem.Total_SVM__c/1000000) + 'M', IF(ABS(l.cwvLineItem.Total_SVM__c ) >= 1000, '$ ' + TEXT(l.cwvLineItem.Total_SVM__c/1000) + 'K', '$ ' + TEXT( l.cwvLineItem.Total_SVM__c))))}">
                                    <apex:param value="{!l.cwvLineItem.Total_SVM__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideOth">
                                <apex:outputText rendered="{!NOT(isExcelRender)}" value="{!IF(ABS(l.OthLineItem.Total_SVM__c ) >= 1000000000, '$ ' + TEXT(l.OthLineItem.Total_SVM__c/1000000000) + 'G', IF(ABS(l.OthLineItem.Total_SVM__c ) >= 1000000, '$ ' + TEXT(l.OthLineItem.Total_SVM__c/1000000) + 'M', IF(ABS(l.OthLineItem.Total_SVM__c ) >= 1000, '$ ' + TEXT(l.OthLineItem.Total_SVM__c/1000) + 'K', '$ ' + TEXT( l.OthLineItem.Total_SVM__c))))}">
                                    <apex:param value="{!l.OthLineItem.Total_SVM__c}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!isExcelRender}" value="{!IF(ABS(l.OthLineItem.Total_SVM__c ) >= 1000000000, '$ ' + TEXT(l.OthLineItem.Total_SVM__c/1000000000) + 'G', IF(ABS(l.OthLineItem.Total_SVM__c ) >= 1000000, '$ ' + TEXT(l.OthLineItem.Total_SVM__c/1000000) + 'M', IF(ABS(l.OthLineItem.Total_SVM__c ) >= 1000, '$ ' + TEXT(l.OthLineItem.Total_SVM__c/1000) + 'K', '$ ' + TEXT( l.OthLineItem.Total_SVM__c))))}">
                                    <apex:param value="{!l.OthLineItem.Total_SVM__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                        <apex:repeat value="{!totalColumns}" var="l">
                             <td class="currency-cell showHidePOR total" >
                                <apex:outputText value="{!IF(ABS(l.TotalPorLineItem.svm ) >= 1000000000, '$ ' + TEXT(l.TotalPorLineItem.svm/1000000000) + 'G', IF(ABS(l.TotalPorLineItem.svm ) >= 1000000, '$ ' + TEXT(l.TotalPorLineItem.svm/1000000) + 'M', IF(ABS(l.TotalPorLineItem.svm ) >= 1000, '$ ' + TEXT(l.TotalPorLineItem.svm/1000) + 'K', '$ ' + TEXT( l.TotalPorLineItem.svm))))}">
                                    <apex:param value="{!l.TotalPorLineItem.svm}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideCWV total">
                                <apex:outputText value="{!IF(ABS(l.TotalCwvLineItem.svm ) >= 1000000000, '$ ' + TEXT(l.TotalCwvLineItem.svm/1000000000) + 'G', IF(ABS(l.TotalCwvLineItem.svm ) >= 1000000, '$ ' + TEXT(l.TotalCwvLineItem.svm/1000000) + 'M', IF(ABS(l.TotalCwvLineItem.svm ) >= 1000, '$ ' + TEXT(l.TotalCwvLineItem.svm/1000) + 'K', '$ ' + TEXT( l.TotalCwvLineItem.svm))))}">
                                    <apex:param value="{!l.TotalCwvLineItem.svm}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideOth total">
                                <apex:outputText value="{!IF(ABS(l.TotalOthLineItem.svm ) >= 1000000000, '$ ' + TEXT(l.TotalOthLineItem.svm/1000000000) + 'G', IF(ABS(l.TotalOthLineItem.svm ) >= 1000000, '$ ' + TEXT(l.TotalOthLineItem.svm/1000000) + 'M', IF(ABS(l.TotalOthLineItem.svm ) >= 1000, '$ ' + TEXT(l.TotalOthLineItem.svm/1000) + 'K', '$ ' + TEXT( l.TotalOthLineItem.svm))))}">
                                    <apex:param value="{!l.TotalOthLineItem.svm}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                    </tr>
                    <tr class="collapsableNS">
                        <td class="data-row-sub-label" >&nbsp;&nbsp;&nbsp; IPP </td><td>
                        <apex:outputText value="{!lineItemColumns[0].ippOpCommentField}" style="width: 45px; height:15px;" rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}"/>
                        <apex:outputText value="{!lineItemColumns[0].ippOpCommentField}" style="width: 45px; height:15px;" />
                        </td>
                        <apex:repeat value="{!lineItemColumns}" var="l">
                             <td class="currency-cell showHidePOR" >
                                <apex:outputText rendered="{!NOT(isExcelRender)}" value="{!IF(ABS(l.porLineItem.Total_IPP__c ) >= 1000000000, '$ ' + TEXT(l.porLineItem.Total_IPP__c/1000000000) + 'G', IF(ABS(l.porLineItem.Total_IPP__c ) >= 1000000, '$ ' + TEXT(l.porLineItem.Total_IPP__c/1000000) + 'M', IF(ABS(l.porLineItem.Total_IPP__c ) >= 1000, '$ ' + TEXT(l.porLineItem.Total_IPP__c/1000) + 'K', '$ ' + TEXT( l.porLineItem.Total_IPP__c))))}">
                                    <apex:param value="{!l.porLineItem.Total_IPP__c}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!isExcelRender}" value="{!IF(ABS(l.porLineItem.Total_IPP__c ) >= 1000000000, '$ ' + TEXT(l.porLineItem.Total_IPP__c/1000000000) + 'G', IF(ABS(l.porLineItem.Total_IPP__c ) >= 1000000, '$ ' + TEXT(l.porLineItem.Total_IPP__c/1000000) + 'M', IF(ABS(l.porLineItem.Total_IPP__c ) >= 1000, '$ ' + TEXT(l.porLineItem.Total_IPP__c/1000) + 'K', '$ ' + TEXT( l.porLineItem.Total_IPP__c))))}">
                                    <apex:param value="{!l.porLineItem.Total_IPP__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideCWV">
                                <apex:outputText rendered="{!NOT(isExcelRender)}" value="{!IF(ABS(l.cwvLineItem.Total_IPP__c ) >= 1000000000, '$ ' + TEXT(l.cwvLineItem.Total_IPP__c/1000000000) + 'G', IF(ABS(l.cwvLineItem.Total_IPP__c ) >= 1000000, '$ ' + TEXT(l.cwvLineItem.Total_IPP__c/1000000) + 'M', IF(ABS(l.cwvLineItem.Total_IPP__c ) >= 1000, '$ ' + TEXT(l.cwvLineItem.Total_IPP__c/1000) + 'K', '$ ' + TEXT( l.cwvLineItem.Total_IPP__c))))}">
                                    <apex:param value="{!l.cwvLineItem.Total_IPP__c}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!isExcelRender}" value="{!IF(ABS(l.cwvLineItem.Total_IPP__c ) >= 1000000000, '$ ' + TEXT(l.cwvLineItem.Total_IPP__c/1000000000) + 'G', IF(ABS(l.cwvLineItem.Total_IPP__c ) >= 1000000, '$ ' + TEXT(l.cwvLineItem.Total_IPP__c/1000000) + 'M', IF(ABS(l.cwvLineItem.Total_IPP__c ) >= 1000, '$ ' + TEXT(l.cwvLineItem.Total_IPP__c/1000) + 'K', '$ ' + TEXT( l.cwvLineItem.Total_IPP__c))))}">
                                    <apex:param value="{!l.cwvLineItem.Total_IPP__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideOth">
                                <apex:outputText rendered="{!NOT(isExcelRender)}" value="{!IF(ABS(l.OthLineItem.Total_IPP__c ) >= 1000000000, '$ ' + TEXT(l.OthLineItem.Total_IPP__c/1000000000) + 'G', IF(ABS(l.OthLineItem.Total_IPP__c ) >= 1000000, '$ ' + TEXT(l.OthLineItem.Total_IPP__c/1000000) + 'M', IF(ABS(l.OthLineItem.Total_IPP__c ) >= 1000, '$ ' + TEXT(l.OthLineItem.Total_IPP__c/1000) + 'K', '$ ' + TEXT( l.OthLineItem.Total_IPP__c))))}">
                                    <apex:param value="{!l.OthLineItem.Total_IPP__c}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!isExcelRender}" value="{!IF(ABS(l.OthLineItem.Total_IPP__c ) >= 1000000000, '$ ' + TEXT(l.OthLineItem.Total_IPP__c/1000000000) + 'G', IF(ABS(l.OthLineItem.Total_IPP__c ) >= 1000000, '$ ' + TEXT(l.OthLineItem.Total_IPP__c/1000000) + 'M', IF(ABS(l.OthLineItem.Total_IPP__c ) >= 1000, '$ ' + TEXT(l.OthLineItem.Total_IPP__c/1000) + 'K', '$ ' + TEXT( l.OthLineItem.Total_IPP__c))))}">
                                    <apex:param value="{!l.OthLineItem.Total_IPP__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                        <apex:repeat value="{!totalColumns}" var="l">
                             <td class="currency-cell showHidePOR total" >
                                <apex:outputText value="{!IF(ABS(l.TotalPorLineItem.ipp ) >= 1000000000, '$ ' + TEXT(l.TotalPorLineItem.ipp/1000000000) + 'G', IF(ABS(l.TotalPorLineItem.ipp ) >= 1000000, '$ ' + TEXT(l.TotalPorLineItem.ipp/1000000) + 'M', IF(ABS(l.TotalPorLineItem.ipp ) >= 1000, '$ ' + TEXT(l.TotalPorLineItem.ipp/1000) + 'K', '$ ' + TEXT( l.TotalPorLineItem.ipp))))}">
                                    <apex:param value="{!l.TotalPorLineItem.ipp}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideCWV total">
                                <apex:outputText value="{!IF(ABS(l.TotalCwvLineItem.ipp ) >= 1000000000, '$ ' + TEXT(l.TotalCwvLineItem.ipp/1000000000) + 'G', IF(ABS(l.TotalCwvLineItem.ipp ) >= 1000000, '$ ' + TEXT(l.TotalCwvLineItem.ipp/1000000) + 'M', IF(ABS(l.TotalCwvLineItem.ipp ) >= 1000, '$ ' + TEXT(l.TotalCwvLineItem.ipp/1000) + 'K', '$ ' + TEXT( l.TotalCwvLineItem.ipp))))}">
                                    <apex:param value="{!l.TotalCwvLineItem.ipp}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideOth total">
                                <apex:outputText value="{!IF(ABS(l.TotalOthLineItem.ipp ) >= 1000000000, '$ ' + TEXT(l.TotalOthLineItem.ipp/1000000000) + 'G', IF(ABS(l.TotalOthLineItem.ipp ) >= 1000000, '$ ' + TEXT(l.TotalOthLineItem.ipp/1000000) + 'M', IF(ABS(l.TotalOthLineItem.ipp ) >= 1000, '$ ' + TEXT(l.TotalOthLineItem.ipp/1000) + 'K', '$ ' + TEXT( l.TotalOthLineItem.ipp))))}">
                                    <apex:param value="{!l.TotalOthLineItem.ipp}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                    </tr>
                    <tr class="collapsableNS">
                        <td class="data-row-sub-label" >&nbsp;&nbsp;&nbsp; National Retail </td><td>
                        <apex:outputText value="{!lineItemColumns[0].nationalRetailOpCommentField}" style="width: 45px; height:15px;" rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}"/>
                        <apex:outputText value="{!lineItemColumns[0].nationalRetailOpCommentField}" style="width: 45px; height:15px;" />
                        </td>
                        <apex:repeat value="{!lineItemColumns}" var="l">
                            <td class="currency-cell showHidePOR" >
                                <apex:outputText rendered="{!NOT(isExcelRender)}" value="{!IF(ABS(l.porLineItem.Total_National_Retail__c ) >= 1000000000, '$ ' + TEXT(l.porLineItem.Total_National_Retail__c/1000000000) + 'G', IF(ABS(l.porLineItem.Total_National_Retail__c ) >= 1000000, '$ ' + TEXT(l.porLineItem.Total_National_Retail__c/1000000) + 'M', IF(ABS(l.porLineItem.Total_National_Retail__c ) >= 1000, '$ ' + TEXT(l.porLineItem.Total_National_Retail__c/1000) + 'K', '$ ' + TEXT( l.porLineItem.Total_National_Retail__c))))}">
                                    <apex:param value="{!l.porLineItem.Total_National_Retail__c}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!isExcelRender}" value="{!IF(ABS(l.porLineItem.Total_National_Retail__c ) >= 1000000000, '$ ' + TEXT(l.porLineItem.Total_National_Retail__c/1000000000) + 'G', IF(ABS(l.porLineItem.Total_National_Retail__c ) >= 1000000, '$ ' + TEXT(l.porLineItem.Total_National_Retail__c/1000000) + 'M', IF(ABS(l.porLineItem.Total_National_Retail__c ) >= 1000, '$ ' + TEXT(l.porLineItem.Total_National_Retail__c/1000) + 'K', '$ ' + TEXT( l.porLineItem.Total_National_Retail__c))))}">
                                    <apex:param value="{!l.porLineItem.Total_National_Retail__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideCWV">
                                <apex:outputText rendered="{!NOT(isExcelRender)}" value="{!IF(ABS(l.cwvLineItem.Total_National_Retail__c ) >= 1000000000, '$ ' + TEXT(l.cwvLineItem.Total_National_Retail__c/1000000000) + 'G', IF(ABS(l.cwvLineItem.Total_National_Retail__c ) >= 1000000, '$ ' + TEXT(l.cwvLineItem.Total_National_Retail__c/1000000) + 'M', IF(ABS(l.cwvLineItem.Total_National_Retail__c ) >= 1000, '$ ' + TEXT(l.cwvLineItem.Total_National_Retail__c/1000) + 'K', '$ ' + TEXT( l.cwvLineItem.Total_National_Retail__c))))}">
                                    <apex:param value="{!l.cwvLineItem.Total_National_Retail__c}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!isExcelRender}" value="{!IF(ABS(l.cwvLineItem.Total_National_Retail__c ) >= 1000000000, '$ ' + TEXT(l.cwvLineItem.Total_National_Retail__c/1000000000) + 'G', IF(ABS(l.cwvLineItem.Total_National_Retail__c ) >= 1000000, '$ ' + TEXT(l.cwvLineItem.Total_National_Retail__c/1000000) + 'M', IF(ABS(l.cwvLineItem.Total_National_Retail__c ) >= 1000, '$ ' + TEXT(l.cwvLineItem.Total_National_Retail__c/1000) + 'K', '$ ' + TEXT( l.cwvLineItem.Total_National_Retail__c))))}">
                                    <apex:param value="{!l.cwvLineItem.Total_National_Retail__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideOth">
                                <apex:outputText rendered="{!NOT(isExcelRender)}" value="{!IF(ABS(l.OthLineItem.Total_National_Retail__c ) >= 1000000000, '$ ' + TEXT(l.OthLineItem.Total_National_Retail__c/1000000000) + 'G', IF(ABS(l.OthLineItem.Total_National_Retail__c ) >= 1000000, '$ ' + TEXT(l.OthLineItem.Total_National_Retail__c/1000000) + 'M', IF(ABS(l.OthLineItem.Total_National_Retail__c ) >= 1000, '$ ' + TEXT(l.OthLineItem.Total_National_Retail__c/1000) + 'K', '$ ' + TEXT( l.OthLineItem.Total_National_Retail__c))))}">
                                    <apex:param value="{!l.OthLineItem.Total_National_Retail__c}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!isExcelRender}" value="{!IF(ABS(l.OthLineItem.Total_National_Retail__c ) >= 1000000000, '$ ' + TEXT(l.OthLineItem.Total_National_Retail__c/1000000000) + 'G', IF(ABS(l.OthLineItem.Total_National_Retail__c ) >= 1000000, '$ ' + TEXT(l.OthLineItem.Total_National_Retail__c/1000000) + 'M', IF(ABS(l.OthLineItem.Total_National_Retail__c ) >= 1000, '$ ' + TEXT(l.OthLineItem.Total_National_Retail__c/1000) + 'K', '$ ' + TEXT( l.OthLineItem.Total_National_Retail__c))))}">
                                    <apex:param value="{!l.OthLineItem.Total_National_Retail__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                        <apex:repeat value="{!totalColumns}" var="l">
                             <td class="currency-cell showHidePOR total" >
                                <apex:outputText value="{!IF(ABS(l.TotalPorLineItem.nationalRetail ) >= 1000000000, '$ ' + TEXT(l.TotalPorLineItem.nationalRetail/1000000000) + 'G', IF(ABS(l.TotalPorLineItem.nationalRetail ) >= 1000000, '$ ' + TEXT(l.TotalPorLineItem.nationalRetail/1000000) + 'M', IF(ABS(l.TotalPorLineItem.nationalRetail ) >= 1000, '$ ' + TEXT(l.TotalPorLineItem.nationalRetail/1000) + 'K', '$ ' + TEXT( l.TotalPorLineItem.nationalRetail))))}">
                                    <apex:param value="{!l.TotalPorLineItem.nationalRetail}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideCWV total">
                                <apex:outputText value="{!IF(ABS(l.TotalCwvLineItem.nationalRetail ) >= 1000000000, '$ ' + TEXT(l.TotalCwvLineItem.nationalRetail/1000000000) + 'G', IF(ABS(l.TotalCwvLineItem.nationalRetail ) >= 1000000, '$ ' + TEXT(l.TotalCwvLineItem.nationalRetail/1000000) + 'M', IF(ABS(l.TotalCwvLineItem.nationalRetail ) >= 1000, '$ ' + TEXT(l.TotalCwvLineItem.nationalRetail/1000) + 'K', '$ ' + TEXT( l.TotalCwvLineItem.nationalRetail))))}">
                                    <apex:param value="{!l.TotalCwvLineItem.nationalRetail}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideOth total">
                                <apex:outputText value="{!IF(ABS(l.TotalOthLineItem.nationalRetail ) >= 1000000000, '$ ' + TEXT(l.TotalOthLineItem.nationalRetail/1000000000) + 'G', IF(ABS(l.TotalOthLineItem.nationalRetail ) >= 1000000, '$ ' + TEXT(l.TotalOthLineItem.nationalRetail/1000000) + 'M', IF(ABS(l.TotalOthLineItem.nationalRetail ) >= 1000, '$ ' + TEXT(l.TotalOthLineItem.nationalRetail/1000) + 'K', '$ ' + TEXT( l.TotalOthLineItem.nationalRetail))))}">
                                    <apex:param value="{!l.TotalOthLineItem.nationalRetail}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                    </tr>
                    <tr class="collapsableNS"> 
                        <td class="data-row-sub-label" >&nbsp;&nbsp;&nbsp; CSAT </td><td>
                        <apex:outputText value="{!lineItemColumns[0].csatOpCommentField}" style="width: 45px; height:15px;" rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}"/>
                        <apex:outputText value="{!lineItemColumns[0].csatOpCommentField}" style="width: 45px; height:15px;" />
                        </td>
                        <apex:repeat value="{!lineItemColumns}" var="l">
                             <td class="currency-cell showHidePOR" >
                                <apex:outputText rendered="{!NOT(isExcelRender)}" value="{!IF(ABS(l.porLineItem.Total_CSAT__c ) >= 1000000000, '$ ' + TEXT(l.porLineItem.Total_CSAT__c/1000000000) + 'G', IF(ABS(l.porLineItem.Total_CSAT__c ) >= 1000000, '$ ' + TEXT(l.porLineItem.Total_CSAT__c/1000000) + 'M', IF(ABS(l.porLineItem.Total_CSAT__c ) >= 1000, '$ ' + TEXT(l.porLineItem.Total_CSAT__c/1000) + 'K', '$ ' + TEXT( l.porLineItem.Total_CSAT__c))))}">
                                    <apex:param value="{!l.porLineItem.Total_CSAT__c}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!isExcelRender}" value="{!IF(ABS(l.porLineItem.Total_CSAT__c ) >= 1000000000, '$ ' + TEXT(l.porLineItem.Total_CSAT__c/1000000000) + 'G', IF(ABS(l.porLineItem.Total_CSAT__c ) >= 1000000, '$ ' + TEXT(l.porLineItem.Total_CSAT__c/1000000) + 'M', IF(ABS(l.porLineItem.Total_CSAT__c ) >= 1000, '$ ' + TEXT(l.porLineItem.Total_CSAT__c/1000) + 'K', '$ ' + TEXT( l.porLineItem.Total_CSAT__c))))}">
                                    <apex:param value="{!l.porLineItem.Total_CSAT__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideCWV">
                                <apex:outputText rendered="{!NOT(isExcelRender)}" value="{!IF(ABS(l.cwvLineItem.Total_CSAT__c ) >= 1000000000, '$ ' + TEXT(l.cwvLineItem.Total_CSAT__c/1000000000) + 'G', IF(ABS(l.cwvLineItem.Total_CSAT__c ) >= 1000000, '$ ' + TEXT(l.cwvLineItem.Total_CSAT__c/1000000) + 'M', IF(ABS(l.cwvLineItem.Total_CSAT__c ) >= 1000, '$ ' + TEXT(l.cwvLineItem.Total_CSAT__c/1000) + 'K', '$ ' + TEXT( l.cwvLineItem.Total_CSAT__c))))}">
                                    <apex:param value="{!l.cwvLineItem.Total_CSAT__c}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!isExcelRender}" value="{!IF(ABS(l.cwvLineItem.Total_CSAT__c ) >= 1000000000, '$ ' + TEXT(l.cwvLineItem.Total_CSAT__c/1000000000) + 'G', IF(ABS(l.cwvLineItem.Total_CSAT__c ) >= 1000000, '$ ' + TEXT(l.cwvLineItem.Total_CSAT__c/1000000) + 'M', IF(ABS(l.cwvLineItem.Total_CSAT__c ) >= 1000, '$ ' + TEXT(l.cwvLineItem.Total_CSAT__c/1000) + 'K', '$ ' + TEXT( l.cwvLineItem.Total_CSAT__c))))}">
                                    <apex:param value="{!l.cwvLineItem.Total_CSAT__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideOth">
                                <apex:outputText rendered="{!NOT(isExcelRender)}" value="{!IF(ABS(l.OthLineItem.Total_CSAT__c ) >= 1000000000, '$ ' + TEXT(l.OthLineItem.Total_CSAT__c/1000000000) + 'G', IF(ABS(l.OthLineItem.Total_CSAT__c ) >= 1000000, '$ ' + TEXT(l.OthLineItem.Total_CSAT__c/1000000) + 'M', IF(ABS(l.OthLineItem.Total_CSAT__c ) >= 1000, '$ ' + TEXT(l.OthLineItem.Total_CSAT__c/1000) + 'K', '$ ' + TEXT( l.OthLineItem.Total_CSAT__c))))}">
                                    <apex:param value="{!l.OthLineItem.Total_CSAT__c}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!isExcelRender}" value="{!IF(ABS(l.OthLineItem.Total_CSAT__c ) >= 1000000000, '$ ' + TEXT(l.OthLineItem.Total_CSAT__c/1000000000) + 'G', IF(ABS(l.OthLineItem.Total_CSAT__c ) >= 1000000, '$ ' + TEXT(l.OthLineItem.Total_CSAT__c/1000000) + 'M', IF(ABS(l.OthLineItem.Total_CSAT__c ) >= 1000, '$ ' + TEXT(l.OthLineItem.Total_CSAT__c/1000) + 'K', '$ ' + TEXT( l.OthLineItem.Total_CSAT__c))))}">
                                    <apex:param value="{!l.OthLineItem.Total_CSAT__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                        <apex:repeat value="{!totalColumns}" var="l">
                             <td class="currency-cell showHidePOR total" >
                                <apex:outputText value="{!IF(ABS(l.TotalPorLineItem.csat ) >= 1000000000, '$ ' + TEXT(l.TotalPorLineItem.csat/1000000000) + 'G', IF(ABS(l.TotalPorLineItem.csat ) >= 1000000, '$ ' + TEXT(l.TotalPorLineItem.csat/1000000) + 'M', IF(ABS(l.TotalPorLineItem.csat ) >= 1000, '$ ' + TEXT(l.TotalPorLineItem.csat/1000) + 'K', '$ ' + TEXT( l.TotalPorLineItem.csat))))}">
                                    <apex:param value="{!l.TotalPorLineItem.csat}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideCWV total">
                                <apex:outputText value="{!IF(ABS(l.TotalCwvLineItem.csat ) >= 1000000000, '$ ' + TEXT(l.TotalCwvLineItem.csat/1000000000) + 'G', IF(ABS(l.TotalCwvLineItem.csat ) >= 1000000, '$ ' + TEXT(l.TotalCwvLineItem.csat/1000000) + 'M', IF(ABS(l.TotalCwvLineItem.csat ) >= 1000, '$ ' + TEXT(l.TotalCwvLineItem.csat/1000) + 'K', '$ ' + TEXT( l.TotalCwvLineItem.csat))))}">
                                    <apex:param value="{!l.TotalCwvLineItem.csat}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideOth total">
                                <apex:outputText value="{!IF(ABS(l.TotalOthLineItem.csat ) >= 1000000000, '$ ' + TEXT(l.TotalOthLineItem.csat/1000000000) + 'G', IF(ABS(l.TotalOthLineItem.csat ) >= 1000000, '$ ' + TEXT(l.TotalOthLineItem.csat/1000000) + 'M', IF(ABS(l.TotalOthLineItem.csat ) >= 1000, '$ ' + TEXT(l.TotalOthLineItem.csat/1000) + 'K', '$ ' + TEXT( l.TotalOthLineItem.csat))))}">
                                    <apex:param value="{!l.TotalOthLineItem.csat}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                    </tr>
                    <tr class="collapsableNS">
                        <td class="data-row-sub-label" >&nbsp;&nbsp;&nbsp; QP </td><td>
                        <apex:outputText value="{!lineItemColumns[0].qpOpCommentField}" style="width: 45px; height:15px;" rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}"/>
                        <apex:outputText value="{!lineItemColumns[0].qpOpCommentField}" style="width: 45px; height:15px;" />
                        </td>
                        <apex:repeat value="{!lineItemColumns}" var="l">
                             <td class="currency-cell showHidePOR" >
                                <apex:outputText rendered="{!NOT(isExcelRender)}" value="{!IF(ABS(l.porLineItem.Total_QP__c ) >= 1000000000, '$ ' + TEXT(l.porLineItem.Total_QP__c/1000000000) + 'G', IF(ABS(l.porLineItem.Total_QP__c ) >= 1000000, '$ ' + TEXT(l.porLineItem.Total_QP__c/1000000) + 'M', IF(ABS(l.porLineItem.Total_QP__c ) >= 1000, '$ ' + TEXT(l.porLineItem.Total_QP__c/1000) + 'K', '$ ' + TEXT( l.porLineItem.Total_QP__c))))}">
                                    <apex:param value="{!l.porLineItem.Total_QP__c}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!isExcelRender}" value="{!IF(ABS(l.porLineItem.Total_QP__c ) >= 1000000000, '$ ' + TEXT(l.porLineItem.Total_QP__c/1000000000) + 'G', IF(ABS(l.porLineItem.Total_QP__c ) >= 1000000, '$ ' + TEXT(l.porLineItem.Total_QP__c/1000000) + 'M', IF(ABS(l.porLineItem.Total_QP__c ) >= 1000, '$ ' + TEXT(l.porLineItem.Total_QP__c/1000) + 'K', '$ ' + TEXT( l.porLineItem.Total_QP__c))))}">
                                    <apex:param value="{!l.porLineItem.Total_QP__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideCWV">
                                <apex:outputText rendered="{!NOT(isExcelRender)}" value="{!IF(ABS(l.cwvLineItem.Total_QP__c ) >= 1000000000, '$ ' + TEXT(l.cwvLineItem.Total_QP__c/1000000000) + 'G', IF(ABS(l.cwvLineItem.Total_QP__c ) >= 1000000, '$ ' + TEXT(l.cwvLineItem.Total_QP__c/1000000) + 'M', IF(ABS(l.cwvLineItem.Total_QP__c ) >= 1000, '$ ' + TEXT(l.cwvLineItem.Total_QP__c/1000) + 'K', '$ ' + TEXT( l.cwvLineItem.Total_QP__c))))}">
                                    <apex:param value="{!l.cwvLineItem.Total_QP__c}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!isExcelRender}" value="{!IF(ABS(l.cwvLineItem.Total_QP__c ) >= 1000000000, '$ ' + TEXT(l.cwvLineItem.Total_QP__c/1000000000) + 'G', IF(ABS(l.cwvLineItem.Total_QP__c ) >= 1000000, '$ ' + TEXT(l.cwvLineItem.Total_QP__c/1000000) + 'M', IF(ABS(l.cwvLineItem.Total_QP__c ) >= 1000, '$ ' + TEXT(l.cwvLineItem.Total_QP__c/1000) + 'K', '$ ' + TEXT( l.cwvLineItem.Total_QP__c))))}">
                                    <apex:param value="{!l.cwvLineItem.Total_QP__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideOth">
                                <apex:outputText rendered="{!NOT(isExcelRender)}" value="{!IF(ABS(l.OthLineItem.Total_QP__c ) >= 1000000000, '$ ' + TEXT(l.OthLineItem.Total_QP__c/1000000000) + 'G', IF(ABS(l.OthLineItem.Total_QP__c ) >= 1000000, '$ ' + TEXT(l.OthLineItem.Total_QP__c/1000000) + 'M', IF(ABS(l.OthLineItem.Total_QP__c ) >= 1000, '$ ' + TEXT(l.OthLineItem.Total_QP__c/1000) + 'K', '$ ' + TEXT( l.OthLineItem.Total_QP__c))))}">
                                    <apex:param value="{!l.OthLineItem.Total_QP__c}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!isExcelRender}" value="{!IF(ABS(l.OthLineItem.Total_QP__c ) >= 1000000000, '$ ' + TEXT(l.OthLineItem.Total_QP__c/1000000000) + 'G', IF(ABS(l.OthLineItem.Total_QP__c ) >= 1000000, '$ ' + TEXT(l.OthLineItem.Total_QP__c/1000000) + 'M', IF(ABS(l.OthLineItem.Total_QP__c ) >= 1000, '$ ' + TEXT(l.OthLineItem.Total_QP__c/1000) + 'K', '$ ' + TEXT( l.OthLineItem.Total_QP__c))))}">
                                    <apex:param value="{!l.OthLineItem.Total_QP__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                        <apex:repeat value="{!totalColumns}" var="l">
                             <td class="currency-cell showHidePOR total" >
                                <apex:outputText value="{!IF(ABS(l.TotalPorLineItem.qp ) >= 1000000000, '$ ' + TEXT(l.TotalPorLineItem.qp/1000000000) + 'G', IF(ABS(l.TotalPorLineItem.qp ) >= 1000000, '$ ' + TEXT(l.TotalPorLineItem.qp/1000000) + 'M', IF(ABS(l.TotalPorLineItem.qp ) >= 1000, '$ ' + TEXT(l.TotalPorLineItem.qp/1000) + 'K', '$ ' + TEXT( l.TotalPorLineItem.qp))))}">
                                    <apex:param value="{!l.TotalPorLineItem.qp}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideCWV total">
                                <apex:outputText value="{!IF(ABS(l.TotalCwvLineItem.qp ) >= 1000000000, '$ ' + TEXT(l.TotalCwvLineItem.qp/1000000000) + 'G', IF(ABS(l.TotalCwvLineItem.qp ) >= 1000000, '$ ' + TEXT(l.TotalCwvLineItem.qp/1000000) + 'M', IF(ABS(l.TotalCwvLineItem.qp ) >= 1000, '$ ' + TEXT(l.TotalCwvLineItem.qp/1000) + 'K', '$ ' + TEXT( l.TotalCwvLineItem.qp))))}">
                                    <apex:param value="{!l.TotalCwvLineItem.qp}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideOth total">
                                <apex:outputText value="{!IF(ABS(l.TotalOthLineItem.qp ) >= 1000000000, '$ ' + TEXT(l.TotalOthLineItem.qp/1000000000) + 'G', IF(ABS(l.TotalOthLineItem.qp ) >= 1000000, '$ ' + TEXT(l.TotalOthLineItem.qp/1000000) + 'M', IF(ABS(l.TotalOthLineItem.qp ) >= 1000, '$ ' + TEXT(l.TotalOthLineItem.qp/1000) + 'K', '$ ' + TEXT( l.TotalOthLineItem.qp))))}">
                                    <apex:param value="{!l.TotalOthLineItem.qp}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                    </tr>
                    <tr class="collapsableNS">
                        <td class="data-row-sub-label" >&nbsp;&nbsp;&nbsp; TC </td><td>
                        <apex:outputText value="{!lineItemColumns[0].tcOpCommentField}" style="width: 45px; height:15px;" rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}"/>
                        <apex:outputText value="{!lineItemColumns[0].tcOpCommentField}" style="width: 45px; height:15px;" />
                        </td>
                        <apex:repeat value="{!lineItemColumns}" var="l">
                             <td class="currency-cell showHidePOR" >
                                <apex:outputText rendered="{!NOT(isExcelRender)}" value="{!IF(ABS(l.porLineItem.Total_TC__c ) >= 1000000000, '$ ' + TEXT(l.porLineItem.Total_TC__c/1000000000) + 'G', IF(ABS(l.porLineItem.Total_TC__c ) >= 1000000, '$ ' + TEXT(l.porLineItem.Total_TC__c/1000000) + 'M', IF(ABS(l.porLineItem.Total_TC__c ) >= 1000, '$ ' + TEXT(l.porLineItem.Total_TC__c/1000) + 'K', '$ ' + TEXT( l.porLineItem.Total_TC__c))))}">
                                    <apex:param value="{!l.porLineItem.Total_TC__c}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!isExcelRender}" value="{!IF(ABS(l.porLineItem.Total_TC__c ) >= 1000000000, '$ ' + TEXT(l.porLineItem.Total_TC__c/1000000000) + 'G', IF(ABS(l.porLineItem.Total_TC__c ) >= 1000000, '$ ' + TEXT(l.porLineItem.Total_TC__c/1000000) + 'M', IF(ABS(l.porLineItem.Total_TC__c ) >= 1000, '$ ' + TEXT(l.porLineItem.Total_TC__c/1000) + 'K', '$ ' + TEXT( l.porLineItem.Total_TC__c))))}">
                                    <apex:param value="{!l.porLineItem.Total_TC__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideCWV">
                                <apex:outputText rendered="{!NOT(isExcelRender)}" value="{!IF(ABS(l.cwvLineItem.Total_TC__c ) >= 1000000000, '$ ' + TEXT(l.cwvLineItem.Total_TC__c/1000000000) + 'G', IF(ABS(l.cwvLineItem.Total_TC__c ) >= 1000000, '$ ' + TEXT(l.cwvLineItem.Total_TC__c/1000000) + 'M', IF(ABS(l.cwvLineItem.Total_TC__c ) >= 1000, '$ ' + TEXT(l.cwvLineItem.Total_TC__c/1000) + 'K', '$ ' + TEXT( l.cwvLineItem.Total_TC__c))))}">
                                    <apex:param value="{!l.cwvLineItem.Total_TC__c}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!isExcelRender}" value="{!IF(ABS(l.cwvLineItem.Total_TC__c ) >= 1000000000, '$ ' + TEXT(l.cwvLineItem.Total_TC__c/1000000000) + 'G', IF(ABS(l.cwvLineItem.Total_TC__c ) >= 1000000, '$ ' + TEXT(l.cwvLineItem.Total_TC__c/1000000) + 'M', IF(ABS(l.cwvLineItem.Total_TC__c ) >= 1000, '$ ' + TEXT(l.cwvLineItem.Total_TC__c/1000) + 'K', '$ ' + TEXT( l.cwvLineItem.Total_TC__c))))}">
                                    <apex:param value="{!l.cwvLineItem.Total_TC__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideOth">
                                <apex:outputText rendered="{!NOT(isExcelRender)}" value="{!IF(ABS(l.OthLineItem.Total_TC__c ) >= 1000000000, '$ ' + TEXT(l.OthLineItem.Total_TC__c/1000000000) + 'G', IF(ABS(l.OthLineItem.Total_TC__c ) >= 1000000, '$ ' + TEXT(l.OthLineItem.Total_TC__c/1000000) + 'M', IF(ABS(l.OthLineItem.Total_TC__c ) >= 1000, '$ ' + TEXT(l.OthLineItem.Total_TC__c/1000) + 'K', '$ ' + TEXT( l.OthLineItem.Total_TC__c))))}">
                                    <apex:param value="{!l.OthLineItem.Total_TC__c}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!isExcelRender}" value="{!IF(ABS(l.OthLineItem.Total_TC__c ) >= 1000000000, '$ ' + TEXT(l.OthLineItem.Total_TC__c/1000000000) + 'G', IF(ABS(l.OthLineItem.Total_TC__c ) >= 1000000, '$ ' + TEXT(l.OthLineItem.Total_TC__c/1000000) + 'M', IF(ABS(l.OthLineItem.Total_TC__c ) >= 1000, '$ ' + TEXT(l.OthLineItem.Total_TC__c/1000) + 'K', '$ ' + TEXT( l.OthLineItem.Total_TC__c))))}">
                                    <apex:param value="{!l.OthLineItem.Total_TC__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                        <apex:repeat value="{!totalColumns}" var="l">
                             <td class="currency-cell showHidePOR total" >
                                <apex:outputText value="{!IF(ABS(l.TotalPorLineItem.tc ) >= 1000000000, '$ ' + TEXT(l.TotalPorLineItem.tc/1000000000) + 'G', IF(ABS(l.TotalPorLineItem.tc ) >= 1000000, '$ ' + TEXT(l.TotalPorLineItem.tc/1000000) + 'M', IF(ABS(l.TotalPorLineItem.tc ) >= 1000, '$ ' + TEXT(l.TotalPorLineItem.tc/1000) + 'K', '$ ' + TEXT( l.TotalPorLineItem.tc))))}">
                                    <apex:param value="{!l.TotalPorLineItem.tc}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideCWV total">
                                <apex:outputText value="{!IF(ABS(l.TotalCWvLineItem.tc ) >= 1000000000, '$ ' + TEXT(l.TotalCWvLineItem.tc/1000000000) + 'G', IF(ABS(l.TotalCWvLineItem.tc ) >= 1000000, '$ ' + TEXT(l.TotalCWvLineItem.tc/1000000) + 'M', IF(ABS(l.TotalCWvLineItem.tc ) >= 1000, '$ ' + TEXT(l.TotalCWvLineItem.tc/1000) + 'K', '$ ' + TEXT( l.TotalCWvLineItem.tc))))}">
                                    <apex:param value="{!l.TotalCWvLineItem.tc}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideOth total">
                                <apex:outputText value="{!IF(ABS(l.TotalOthLineItem.tc ) >= 1000000000, '$ ' + TEXT(l.TotalOthLineItem.tc/1000000000) + 'G', IF(ABS(l.TotalOthLineItem.tc ) >= 1000000, '$ ' + TEXT(l.TotalOthLineItem.tc/1000000) + 'M', IF(ABS(l.TotalOthLineItem.tc ) >= 1000, '$ ' + TEXT(l.TotalOthLineItem.tc/1000) + 'K', '$ ' + TEXT( l.TotalOthLineItem.tc))))}">
                                    <apex:param value="{!l.TotalOthLineItem.tc}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                    </tr>
                    <tr class="collapsableNS"> 
                        <td class="data-row-sub-label" >&nbsp;&nbsp;&nbsp; ILW </td><td>
                        <apex:outputText value="{!lineItemColumns[0].ilwOpCommentField}" style="width: 45px; height:15px;" rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}"/>
                        <apex:outputText value="{!lineItemColumns[0].ilwOpCommentField}" style="width: 45px; height:15px;" />
                        </td>
                        <apex:repeat value="{!lineItemColumns}" var="l">
                             <td class="currency-cell showHidePOR" >
                                <apex:outputText rendered="{!NOT(isExcelRender)}" value="{!IF(ABS(l.porLineItem.Total_ILW__c ) >= 1000000000, '$ ' + TEXT(l.porLineItem.Total_ILW__c/1000000000) + 'G', IF(ABS(l.porLineItem.Total_ILW__c ) >= 1000000, '$ ' + TEXT(l.porLineItem.Total_ILW__c/1000000) + 'M', IF(ABS(l.porLineItem.Total_ILW__c ) >= 1000, '$ ' + TEXT(l.porLineItem.Total_ILW__c/1000) + 'K', '$ ' + TEXT( l.porLineItem.Total_ILW__c))))}">
                                    <apex:param value="{!l.porLineItem.Total_ILW__c}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!isExcelRender}" value="{!IF(ABS(l.porLineItem.Total_ILW__c ) >= 1000000000, '$ ' + TEXT(l.porLineItem.Total_ILW__c/1000000000) + 'G', IF(ABS(l.porLineItem.Total_ILW__c ) >= 1000000, '$ ' + TEXT(l.porLineItem.Total_ILW__c/1000000) + 'M', IF(ABS(l.porLineItem.Total_ILW__c ) >= 1000, '$ ' + TEXT(l.porLineItem.Total_ILW__c/1000) + 'K', '$ ' + TEXT( l.porLineItem.Total_ILW__c))))}">
                                    <apex:param value="{!l.porLineItem.Total_ILW__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideCWV">
                                <apex:outputText rendered="{!NOT(isExcelRender)}" value="{!IF(ABS(l.cwvLineItem.Total_ILW__c ) >= 1000000000, '$ ' + TEXT(l.cwvLineItem.Total_ILW__c/1000000000) + 'G', IF(ABS(l.cwvLineItem.Total_ILW__c ) >= 1000000, '$ ' + TEXT(l.cwvLineItem.Total_ILW__c/1000000) + 'M', IF(ABS(l.cwvLineItem.Total_ILW__c ) >= 1000, '$ ' + TEXT(l.cwvLineItem.Total_ILW__c/1000) + 'K', '$ ' + TEXT( l.cwvLineItem.Total_ILW__c))))}">
                                    <apex:param value="{!l.cwvLineItem.Total_ILW__c}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!isExcelRender}" value="{!IF(ABS(l.cwvLineItem.Total_ILW__c ) >= 1000000000, '$ ' + TEXT(l.cwvLineItem.Total_ILW__c/1000000000) + 'G', IF(ABS(l.cwvLineItem.Total_ILW__c ) >= 1000000, '$ ' + TEXT(l.cwvLineItem.Total_ILW__c/1000000) + 'M', IF(ABS(l.cwvLineItem.Total_ILW__c ) >= 1000, '$ ' + TEXT(l.cwvLineItem.Total_ILW__c/1000) + 'K', '$ ' + TEXT( l.cwvLineItem.Total_ILW__c))))}">
                                    <apex:param value="{!l.cwvLineItem.Total_ILW__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideOth">
                                <apex:outputText rendered="{!NOT(isExcelRender)}" value="{!IF(ABS(l.OthLineItem.Total_ILW__c ) >= 1000000000, '$ ' + TEXT(l.OthLineItem.Total_ILW__c/1000000000) + 'G', IF(ABS(l.OthLineItem.Total_ILW__c ) >= 1000000, '$ ' + TEXT(l.OthLineItem.Total_ILW__c/1000000) + 'M', IF(ABS(l.OthLineItem.Total_ILW__c ) >= 1000, '$ ' + TEXT(l.OthLineItem.Total_ILW__c/1000) + 'K', '$ ' + TEXT( l.OthLineItem.Total_ILW__c))))}">
                                    <apex:param value="{!l.OthLineItem.Total_ILW__c}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!isExcelRender}" value="{!IF(ABS(l.OthLineItem.Total_ILW__c ) >= 1000000000, '$ ' + TEXT(l.OthLineItem.Total_ILW__c/1000000000) + 'G', IF(ABS(l.OthLineItem.Total_ILW__c ) >= 1000000, '$ ' + TEXT(l.OthLineItem.Total_ILW__c/1000000) + 'M', IF(ABS(l.OthLineItem.Total_ILW__c ) >= 1000, '$ ' + TEXT(l.OthLineItem.Total_ILW__c/1000) + 'K', '$ ' + TEXT( l.OthLineItem.Total_ILW__c))))}">
                                    <apex:param value="{!l.OthLineItem.Total_ILW__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                        <apex:repeat value="{!totalColumns}" var="l">
                             <td class="currency-cell showHidePOR total" >
                                <apex:outputText value="{!IF(ABS(l.TotalPorLineItem.ilw ) >= 1000000000, '$ ' + TEXT(l.TotalPorLineItem.ilw/1000000000) + 'G', IF(ABS(l.TotalPorLineItem.ilw ) >= 1000000, '$ ' + TEXT(l.TotalPorLineItem.ilw/1000000) + 'M', IF(ABS(l.TotalPorLineItem.ilw ) >= 1000, '$ ' + TEXT(l.TotalPorLineItem.ilw/1000) + 'K', '$ ' + TEXT( l.TotalPorLineItem.ilw))))}">
                                    <apex:param value="{!l.TotalPorLineItem.ilw}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideCWV total">
                                <apex:outputText value="{!IF(ABS(l.TotalCwvLineItem.ilw ) >= 1000000000, '$ ' + TEXT(l.TotalCwvLineItem.ilw/1000000000) + 'G', IF(ABS(l.TotalCwvLineItem.ilw ) >= 1000000, '$ ' + TEXT(l.TotalCwvLineItem.ilw/1000000) + 'M', IF(ABS(l.TotalCwvLineItem.ilw ) >= 1000, '$ ' + TEXT(l.TotalCwvLineItem.ilw/1000) + 'K', '$ ' + TEXT( l.TotalCwvLineItem.ilw))))}">
                                    <apex:param value="{!l.TotalCwvLineItem.ilw}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideOth total">
                                <apex:outputText value="{!IF(ABS(l.TotalOthLineItem.ilw ) >= 1000000000, '$ ' + TEXT(l.TotalOthLineItem.ilw/1000000000) + 'G', IF(ABS(l.TotalOthLineItem.ilw ) >= 1000000, '$ ' + TEXT(l.TotalOthLineItem.ilw/1000000) + 'M', IF(ABS(l.TotalOthLineItem.ilw ) >= 1000, '$ ' + TEXT(l.TotalOthLineItem.ilw/1000) + 'K', '$ ' + TEXT( l.TotalOthLineItem.ilw))))}">
                                    <apex:param value="{!l.TotalOthLineItem.ilw}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                    </tr>
                    <tr class="collapsableNS">
                        <td class="data-row-sub-label" >&nbsp;&nbsp;&nbsp; TDF </td><td>
                        <apex:outputText value="{!lineItemColumns[0].tdfOpCommentField}" style="width: 45px; height:15px;" rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}"/>
                        <apex:outputText value="{!lineItemColumns[0].tdfOpCommentField}" style="width: 45px; height:15px;" />
                        </td>
                        <apex:repeat value="{!lineItemColumns}" var="l">
                             <td class="currency-cell showHidePOR" >
                                <apex:outputText rendered="{!NOT(isExcelRender)}" value="{!IF(ABS(l.porLineItem.Total_TDF__c ) >= 1000000000, '$ ' + TEXT(l.porLineItem.Total_TDF__c/1000000000) + 'G', IF(ABS(l.porLineItem.Total_TDF__c ) >= 1000000, '$ ' + TEXT(l.porLineItem.Total_TDF__c/1000000) + 'M', IF(ABS(l.porLineItem.Total_TDF__c ) >= 1000, '$ ' + TEXT(l.porLineItem.Total_TDF__c/1000) + 'K', '$ ' + TEXT( l.porLineItem.Total_TDF__c))))}">
                                    <apex:param value="{!l.porLineItem.Total_TDF__c}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!isExcelRender}" value="{!IF(ABS(l.porLineItem.Total_TDF__c ) >= 1000000000, '$ ' + TEXT(l.porLineItem.Total_TDF__c/1000000000) + 'G', IF(ABS(l.porLineItem.Total_TDF__c ) >= 1000000, '$ ' + TEXT(l.porLineItem.Total_TDF__c/1000000) + 'M', IF(ABS(l.porLineItem.Total_TDF__c ) >= 1000, '$ ' + TEXT(l.porLineItem.Total_TDF__c/1000) + 'K', '$ ' + TEXT( l.porLineItem.Total_TDF__c))))}">
                                    <apex:param value="{!l.porLineItem.Total_TDF__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideCWV">
                                <apex:outputText rendered="{!NOT(isExcelRender)}" value="{!IF(ABS(l.cwvLineItem.Total_TDF__c ) >= 1000000000, '$ ' + TEXT(l.cwvLineItem.Total_TDF__c/1000000000) + 'G', IF(ABS(l.cwvLineItem.Total_TDF__c ) >= 1000000, '$ ' + TEXT(l.cwvLineItem.Total_TDF__c/1000000) + 'M', IF(ABS(l.cwvLineItem.Total_TDF__c ) >= 1000, '$ ' + TEXT(l.cwvLineItem.Total_TDF__c/1000) + 'K', '$ ' + TEXT( l.cwvLineItem.Total_TDF__c))))}">
                                    <apex:param value="{!l.cwvLineItem.Total_TDF__c}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!isExcelRender}" value="{!IF(ABS(l.cwvLineItem.Total_TDF__c ) >= 1000000000, '$ ' + TEXT(l.cwvLineItem.Total_TDF__c/1000000000) + 'G', IF(ABS(l.cwvLineItem.Total_TDF__c ) >= 1000000, '$ ' + TEXT(l.cwvLineItem.Total_TDF__c/1000000) + 'M', IF(ABS(l.cwvLineItem.Total_TDF__c ) >= 1000, '$ ' + TEXT(l.cwvLineItem.Total_TDF__c/1000) + 'K', '$ ' + TEXT( l.cwvLineItem.Total_TDF__c))))}">
                                    <apex:param value="{!l.cwvLineItem.Total_TDF__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideOth">
                                <apex:outputText rendered="{!NOT(isExcelRender)}" value="{!IF(ABS(l.OthLineItem.Total_TDF__c ) >= 1000000000, '$ ' + TEXT(l.OthLineItem.Total_TDF__c/1000000000) + 'G', IF(ABS(l.OthLineItem.Total_TDF__c ) >= 1000000, '$ ' + TEXT(l.OthLineItem.Total_TDF__c/1000000) + 'M', IF(ABS(l.OthLineItem.Total_TDF__c ) >= 1000, '$ ' + TEXT(l.OthLineItem.Total_TDF__c/1000) + 'K', '$ ' + TEXT( l.OthLineItem.Total_TDF__c))))}">
                                    <apex:param value="{!l.OthLineItem.Total_TDF__c}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!isExcelRender}" value="{!IF(ABS(l.OthLineItem.Total_TDF__c ) >= 1000000000, '$ ' + TEXT(l.OthLineItem.Total_TDF__c/1000000000) + 'G', IF(ABS(l.OthLineItem.Total_TDF__c ) >= 1000000, '$ ' + TEXT(l.OthLineItem.Total_TDF__c/1000000) + 'M', IF(ABS(l.OthLineItem.Total_TDF__c ) >= 1000, '$ ' + TEXT(l.OthLineItem.Total_TDF__c/1000) + 'K', '$ ' + TEXT( l.OthLineItem.Total_TDF__c))))}">
                                    <apex:param value="{!l.OthLineItem.Total_TDF__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                        <apex:repeat value="{!totalColumns}" var="l">
                             <td class="currency-cell showHidePOR total" >
                                <apex:outputText value="{!IF(ABS(l.TotalPorLineItem.tdf ) >= 1000000000, '$ ' + TEXT(l.TotalPorLineItem.tdf/1000000000) + 'G', IF(ABS(l.TotalPorLineItem.tdf ) >= 1000000, '$ ' + TEXT(l.TotalPorLineItem.tdf/1000000) + 'M', IF(ABS(l.TotalPorLineItem.tdf ) >= 1000, '$ ' + TEXT(l.TotalPorLineItem.tdf/1000) + 'K', '$ ' + TEXT( l.TotalPorLineItem.tdf))))}">
                                    <apex:param value="{!l.TotalPorLineItem.tdf}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideCWV total">
                                <apex:outputText value="{!IF(ABS(l.TotalCwvLineItem.tdf ) >= 1000000000, '$ ' + TEXT(l.TotalCwvLineItem.tdf/1000000000) + 'G', IF(ABS(l.TotalCwvLineItem.tdf ) >= 1000000, '$ ' + TEXT(l.TotalCwvLineItem.tdf/1000000) + 'M', IF(ABS(l.TotalCwvLineItem.tdf ) >= 1000, '$ ' + TEXT(l.TotalCwvLineItem.tdf/1000) + 'K', '$ ' + TEXT( l.TotalCwvLineItem.tdf))))}">
                                    <apex:param value="{!l.TotalCwvLineItem.tdf}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideOth total">
                                <apex:outputText value="{!IF(ABS(l.TotalOthLineItem.tdf ) >= 1000000000, '$ ' + TEXT(l.TotalOthLineItem.tdf/1000000000) + 'G', IF(ABS(l.TotalOthLineItem.tdf ) >= 1000000, '$ ' + TEXT(l.TotalOthLineItem.tdf/1000000) + 'M', IF(ABS(l.TotalOthLineItem.tdf ) >= 1000, '$ ' + TEXT(l.TotalOthLineItem.tdf/1000) + 'K', '$ ' + TEXT( l.TotalOthLineItem.tdf))))}">
                                    <apex:param value="{!l.TotalOthLineItem.tdf}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                    </tr>
                    <tr class="collapsableNS">
                        <td class="data-row-sub-label" >&nbsp;&nbsp;&nbsp; Fees </td><td>
                        <apex:outputText value="{!lineItemColumns[0].feesOpCommentField}" style="width: 45px; height:15px;" rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}"/>
                        <apex:outputText value="{!lineItemColumns[0].feesOpCommentField}" style="width: 45px; height:15px;" />
                        </td>
                        <apex:repeat value="{!lineItemColumns}" var="l">
                             <td class="currency-cell showHidePOR" >
                                <apex:outputText rendered="{!NOT(isExcelRender)}" value="{!IF(ABS(l.porLineItem.Total_Fees__c ) >= 1000000000, '$ ' + TEXT(l.porLineItem.Total_Fees__c/1000000000) + 'G', IF(ABS(l.porLineItem.Total_Fees__c ) >= 1000000, '$ ' + TEXT(l.porLineItem.Total_Fees__c/1000000) + 'M', IF(ABS(l.porLineItem.Total_Fees__c ) >= 1000, '$ ' + TEXT(l.porLineItem.Total_Fees__c/1000) + 'K', '$ ' + TEXT( l.porLineItem.Total_Fees__c))))}">
                                    <apex:param value="{!l.porLineItem.Total_Fees__c}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!isExcelRender}" value="{!IF(ABS(l.porLineItem.Total_Fees__c ) >= 1000000000, '$ ' + TEXT(l.porLineItem.Total_Fees__c/1000000000) + 'G', IF(ABS(l.porLineItem.Total_Fees__c ) >= 1000000, '$ ' + TEXT(l.porLineItem.Total_Fees__c/1000000) + 'M', IF(ABS(l.porLineItem.Total_Fees__c ) >= 1000, '$ ' + TEXT(l.porLineItem.Total_Fees__c/1000) + 'K', '$ ' + TEXT( l.porLineItem.Total_Fees__c))))}">
                                    <apex:param value="{!l.porLineItem.Total_Fees__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideCWV">
                                <apex:outputText rendered="{!NOT(isExcelRender)}" value="{!IF(ABS(l.cwvLineItem.Total_Fees__c ) >= 1000000000, '$ ' + TEXT(l.cwvLineItem.Total_Fees__c/1000000000) + 'G', IF(ABS(l.cwvLineItem.Total_Fees__c ) >= 1000000, '$ ' + TEXT(l.cwvLineItem.Total_Fees__c/1000000) + 'M', IF(ABS(l.cwvLineItem.Total_Fees__c ) >= 1000, '$ ' + TEXT(l.cwvLineItem.Total_Fees__c/1000) + 'K', '$ ' + TEXT( l.cwvLineItem.Total_Fees__c))))}">
                                    <apex:param value="{!l.cwvLineItem.Total_Fees__c}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!isExcelRender}" value="{!IF(ABS(l.cwvLineItem.Total_Fees__c ) >= 1000000000, '$ ' + TEXT(l.cwvLineItem.Total_Fees__c/1000000000) + 'G', IF(ABS(l.cwvLineItem.Total_Fees__c ) >= 1000000, '$ ' + TEXT(l.cwvLineItem.Total_Fees__c/1000000) + 'M', IF(ABS(l.cwvLineItem.Total_Fees__c ) >= 1000, '$ ' + TEXT(l.cwvLineItem.Total_Fees__c/1000) + 'K', '$ ' + TEXT( l.cwvLineItem.Total_Fees__c))))}">
                                    <apex:param value="{!l.cwvLineItem.Total_Fees__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideOth">
                                <apex:outputText rendered="{!NOT(isExcelRender)}" value="{!IF(ABS(l.OthLineItem.Total_Fees__c ) >= 1000000000, '$ ' + TEXT(l.OthLineItem.Total_Fees__c/1000000000) + 'G', IF(ABS(l.OthLineItem.Total_Fees__c ) >= 1000000, '$ ' + TEXT(l.OthLineItem.Total_Fees__c/1000000) + 'M', IF(ABS(l.OthLineItem.Total_Fees__c ) >= 1000, '$ ' + TEXT(l.OthLineItem.Total_Fees__c/1000) + 'K', '$ ' + TEXT( l.OthLineItem.Total_Fees__c))))}">
                                    <apex:param value="{!l.OthLineItem.Total_Fees__c}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!isExcelRender}" value="{!IF(ABS(l.OthLineItem.Total_Fees__c ) >= 1000000000, '$ ' + TEXT(l.OthLineItem.Total_Fees__c/1000000000) + 'G', IF(ABS(l.OthLineItem.Total_Fees__c ) >= 1000000, '$ ' + TEXT(l.OthLineItem.Total_Fees__c/1000000) + 'M', IF(ABS(l.OthLineItem.Total_Fees__c ) >= 1000, '$ ' + TEXT(l.OthLineItem.Total_Fees__c/1000) + 'K', '$ ' + TEXT( l.OthLineItem.Total_Fees__c))))}">
                                    <apex:param value="{!l.OthLineItem.Total_Fees__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                        <apex:repeat value="{!totalColumns}" var="l">
                             <td class="currency-cell showHidePOR total" >
                                <apex:outputText value="{!IF(ABS(l.TotalPorLineItem.fees ) >= 1000000000, '$ ' + TEXT(l.TotalPorLineItem.fees/1000000000) + 'G', IF(ABS(l.TotalPorLineItem.fees ) >= 1000000, '$ ' + TEXT(l.TotalPorLineItem.fees/1000000) + 'M', IF(ABS(l.TotalPorLineItem.fees ) >= 1000, '$ ' + TEXT(l.TotalPorLineItem.fees/1000) + 'K', '$ ' + TEXT( l.TotalPorLineItem.fees))))}">
                                    <apex:param value="{!l.TotalPorLineItem.fees}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideCWV total">
                                <apex:outputText value="{!IF(ABS(l.TotalCwvLineItem.fees ) >= 1000000000, '$ ' + TEXT(l.TotalCwvLineItem.fees/1000000000) + 'G', IF(ABS(l.TotalCwvLineItem.fees ) >= 1000000, '$ ' + TEXT(l.TotalCwvLineItem.fees/1000000) + 'M', IF(ABS(l.TotalCwvLineItem.fees ) >= 1000, '$ ' + TEXT(l.TotalCwvLineItem.fees/1000) + 'K', '$ ' + TEXT( l.TotalCwvLineItem.fees))))}">
                                    <apex:param value="{!l.TotalCwvLineItem.fees}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideOth total">
                                <apex:outputText value="{!IF(ABS(l.TotalOthLineItem.fees ) >= 1000000000, '$ ' + TEXT(l.TotalOthLineItem.fees/1000000000) + 'G', IF(ABS(l.TotalOthLineItem.fees ) >= 1000000, '$ ' + TEXT(l.TotalOthLineItem.fees/1000000) + 'M', IF(ABS(l.TotalOthLineItem.fees ) >= 1000, '$ ' + TEXT(l.TotalOthLineItem.fees/1000) + 'K', '$ ' + TEXT( l.TotalOthLineItem.fees))))}">
                                    <apex:param value="{!l.TotalOthLineItem.fees}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                    </tr>
                    <tr class="collapsableNS">
                        <td class="data-row-sub-label" >&nbsp;&nbsp;&nbsp;Negotiation Buffer </td><td>
                        <apex:outputText value="{!lineItemColumns[0].negotiationBufferOpCommentField}" style="width: 45px; height:15px;" rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}"/>
                        <apex:outputText value="{!lineItemColumns[0].negotiationBufferOpCommentField}" style="width: 45px; height:15px;" />
                        </td>
                        <apex:repeat value="{!lineItemColumns}" var="l">
                             <td class="currency-cell showHidePOR" >
                                <apex:outputText rendered="{!NOT(isExcelRender)}" value="{!IF(ABS(l.porLineItem.Total_Negotiation_Buffer__c ) >= 1000000000, '$ ' + TEXT(l.porLineItem.Total_Negotiation_Buffer__c/1000000000) + 'G', IF(ABS(l.porLineItem.Total_Negotiation_Buffer__c ) >= 1000000, '$ ' + TEXT(l.porLineItem.Total_Negotiation_Buffer__c/1000000) + 'M', IF(ABS(l.porLineItem.Total_Negotiation_Buffer__c ) >= 1000, '$ ' + TEXT(l.porLineItem.Total_Negotiation_Buffer__c/1000) + 'K', '$ ' + TEXT( l.porLineItem.Total_Negotiation_Buffer__c))))}">
                                    <apex:param value="{!l.porLineItem.Total_Negotiation_Buffer__c}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!isExcelRender}" value="{!IF(ABS(l.porLineItem.Total_Negotiation_Buffer__c ) >= 1000000000, '$ ' + TEXT(l.porLineItem.Total_Negotiation_Buffer__c/1000000000) + 'G', IF(ABS(l.porLineItem.Total_Negotiation_Buffer__c ) >= 1000000, '$ ' + TEXT(l.porLineItem.Total_Negotiation_Buffer__c/1000000) + 'M', IF(ABS(l.porLineItem.Total_Negotiation_Buffer__c ) >= 1000, '$ ' + TEXT(l.porLineItem.Total_Negotiation_Buffer__c/1000) + 'K', '$ ' + TEXT( l.porLineItem.Total_Negotiation_Buffer__c))))}">
                                    <apex:param value="{!l.porLineItem.Total_Negotiation_Buffer__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideCWV">
                                <apex:outputText rendered="{!NOT(isExcelRender)}" value="{!IF(ABS(l.cwvLineItem.Total_Negotiation_Buffer__c ) >= 1000000000, '$ ' + TEXT(l.cwvLineItem.Total_Negotiation_Buffer__c/1000000000) + 'G', IF(ABS(l.cwvLineItem.Total_Negotiation_Buffer__c ) >= 1000000, '$ ' + TEXT(l.cwvLineItem.Total_Negotiation_Buffer__c/1000000) + 'M', IF(ABS(l.cwvLineItem.Total_Negotiation_Buffer__c ) >= 1000, '$ ' + TEXT(l.cwvLineItem.Total_Negotiation_Buffer__c/1000) + 'K', '$ ' + TEXT( l.cwvLineItem.Total_Negotiation_Buffer__c))))}">
                                    <apex:param value="{!l.cwvLineItem.Total_Negotiation_Buffer__c}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!isExcelRender}" value="{!IF(ABS(l.cwvLineItem.Total_Negotiation_Buffer__c ) >= 1000000000, '$ ' + TEXT(l.cwvLineItem.Total_Negotiation_Buffer__c/1000000000) + 'G', IF(ABS(l.cwvLineItem.Total_Negotiation_Buffer__c ) >= 1000000, '$ ' + TEXT(l.cwvLineItem.Total_Negotiation_Buffer__c/1000000) + 'M', IF(ABS(l.cwvLineItem.Total_Negotiation_Buffer__c ) >= 1000, '$ ' + TEXT(l.cwvLineItem.Total_Negotiation_Buffer__c/1000) + 'K', '$ ' + TEXT( l.cwvLineItem.Total_Negotiation_Buffer__c))))}">
                                    <apex:param value="{!l.cwvLineItem.Total_Negotiation_Buffer__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideOth">
                                <apex:outputText rendered="{!NOT(isExcelRender)}" value="{!IF(ABS(l.OthLineItem.Total_Negotiation_Buffer__c ) >= 1000000000, '$ ' + TEXT(l.OthLineItem.Total_Negotiation_Buffer__c/1000000000) + 'G', IF(ABS(l.OthLineItem.Total_Negotiation_Buffer__c ) >= 1000000, '$ ' + TEXT(l.OthLineItem.Total_Negotiation_Buffer__c/1000000) + 'M', IF(ABS(l.OthLineItem.Total_Negotiation_Buffer__c ) >= 1000, '$ ' + TEXT(l.OthLineItem.Total_Negotiation_Buffer__c/1000) + 'K', '$ ' + TEXT( l.OthLineItem.Total_Negotiation_Buffer__c))))}">
                                    <apex:param value="{!l.OthLineItem.Total_Negotiation_Buffer__c}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!isExcelRender}" value="{!IF(ABS(l.OthLineItem.Total_Negotiation_Buffer__c ) >= 1000000000, '$ ' + TEXT(l.OthLineItem.Total_Negotiation_Buffer__c/1000000000) + 'G', IF(ABS(l.OthLineItem.Total_Negotiation_Buffer__c ) >= 1000000, '$ ' + TEXT(l.OthLineItem.Total_Negotiation_Buffer__c/1000000) + 'M', IF(ABS(l.OthLineItem.Total_Negotiation_Buffer__c ) >= 1000, '$ ' + TEXT(l.OthLineItem.Total_Negotiation_Buffer__c/1000) + 'K', '$ ' + TEXT( l.OthLineItem.Total_Negotiation_Buffer__c))))}">
                                    <apex:param value="{!l.OthLineItem.Total_Negotiation_Buffer__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                        <apex:repeat value="{!totalColumns}" var="l">
                             <td class="currency-cell showHidePOR total" >
                                <apex:outputText value="{!IF(ABS(l.TotalPorLineItem.negotiationBuffer ) >= 1000000000, '$ ' + TEXT(l.TotalPorLineItem.negotiationBuffer/1000000000) + 'G', IF(ABS(l.TotalPorLineItem.negotiationBuffer ) >= 1000000, '$ ' + TEXT(l.TotalPorLineItem.negotiationBuffer/1000000) + 'M', IF(ABS(l.TotalPorLineItem.negotiationBuffer ) >= 1000, '$ ' + TEXT(l.TotalPorLineItem.negotiationBuffer/1000) + 'K', '$ ' + TEXT( l.TotalPorLineItem.negotiationBuffer))))}">
                                    <apex:param value="{!l.TotalPorLineItem.negotiationBuffer}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideCWV total">
                                <apex:outputText value="{!IF(ABS(l.TotalCwvLineItem.negotiationBuffer ) >= 1000000000, '$ ' + TEXT(l.TotalCwvLineItem.negotiationBuffer/1000000000) + 'G', IF(ABS(l.TotalCwvLineItem.negotiationBuffer ) >= 1000000, '$ ' + TEXT(l.TotalCwvLineItem.negotiationBuffer/1000000) + 'M', IF(ABS(l.TotalCwvLineItem.negotiationBuffer ) >= 1000, '$ ' + TEXT(l.TotalCwvLineItem.negotiationBuffer/1000) + 'K', '$ ' + TEXT( l.TotalCwvLineItem.negotiationBuffer))))}">
                                    <apex:param value="{!l.TotalCwvLineItem.negotiationBuffer}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideOth total">
                                <apex:outputText value="{!IF(ABS(l.TotalOthLineItem.negotiationBuffer ) >= 1000000000, '$ ' + TEXT(l.TotalOthLineItem.negotiationBuffer/1000000000) + 'G', IF(ABS(l.TotalOthLineItem.negotiationBuffer ) >= 1000000, '$ ' + TEXT(l.TotalOthLineItem.negotiationBuffer/1000000) + 'M', IF(ABS(l.TotalOthLineItem.negotiationBuffer ) >= 1000, '$ ' + TEXT(l.TotalOthLineItem.negotiationBuffer/1000) + 'K', '$ ' + TEXT( l.TotalOthLineItem.negotiationBuffer))))}">
                                    <apex:param value="{!l.TotalOthLineItem.negotiationBuffer}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                    </tr>
                    <tr class="single-underscore" style="border-bottom:1px solid #000;">
                        <td class="data-row-label">Total Discount</td><td></td>
                        <apex:repeat value="{!lineItemColumns}" var="l">
                             <td class="currency-cell showHidePOR" >
                                <apex:outputText rendered="{!NOT(isExcelRender)}" value="{!IF(ABS(l.porLineItem.Total_Aggregate_Discounts__c ) >= 1000000000, '$ ' + TEXT(l.porLineItem.Total_Aggregate_Discounts__c/1000000000) + 'G', IF(ABS(l.porLineItem.Total_Aggregate_Discounts__c ) >= 1000000, '$ ' + TEXT(l.porLineItem.Total_Aggregate_Discounts__c/1000000) + 'M', IF(ABS(l.porLineItem.Total_Aggregate_Discounts__c ) >= 1000, '$ ' + TEXT(l.porLineItem.Total_Aggregate_Discounts__c/1000) + 'K', '$ ' + TEXT( l.porLineItem.Total_Aggregate_Discounts__c))))}">
                                    <apex:param value="{!l.porLineItem.Total_Aggregate_Discounts__c}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!isExcelRender}" value="{!IF(ABS(l.porLineItem.Total_Aggregate_Discounts__c ) >= 1000000000, '$ ' + TEXT(l.porLineItem.Total_Aggregate_Discounts__c/1000000000) + 'G', IF(ABS(l.porLineItem.Total_Aggregate_Discounts__c ) >= 1000000, '$ ' + TEXT(l.porLineItem.Total_Aggregate_Discounts__c/1000000) + 'M', IF(ABS(l.porLineItem.Total_Aggregate_Discounts__c ) >= 1000, '$ ' + TEXT(l.porLineItem.Total_Aggregate_Discounts__c/1000) + 'K', '$ ' + TEXT( l.porLineItem.Total_Aggregate_Discounts__c))))}">
                                    <apex:param value="{!l.porLineItem.Total_Aggregate_Discounts__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideCWV">
                                <apex:outputText rendered="{!NOT(isExcelRender)}" value="{!IF(ABS(l.cwvLineItem.Total_Aggregate_Discounts__c ) >= 1000000000, '$ ' + TEXT(l.cwvLineItem.Total_Aggregate_Discounts__c/1000000000) + 'G', IF(ABS(l.cwvLineItem.Total_Aggregate_Discounts__c ) >= 1000000, '$ ' + TEXT(l.cwvLineItem.Total_Aggregate_Discounts__c/1000000) + 'M', IF(ABS(l.cwvLineItem.Total_Aggregate_Discounts__c ) >= 1000, '$ ' + TEXT(l.cwvLineItem.Total_Aggregate_Discounts__c/1000) + 'K', '$ ' + TEXT( l.cwvLineItem.Total_Aggregate_Discounts__c))))}">
                                    <apex:param value="{!l.cwvLineItem.Total_Aggregate_Discounts__c}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!isExcelRender}" value="{!IF(ABS(l.cwvLineItem.Total_Aggregate_Discounts__c ) >= 1000000000, '$ ' + TEXT(l.cwvLineItem.Total_Aggregate_Discounts__c/1000000000) + 'G', IF(ABS(l.cwvLineItem.Total_Aggregate_Discounts__c ) >= 1000000, '$ ' + TEXT(l.cwvLineItem.Total_Aggregate_Discounts__c/1000000) + 'M', IF(ABS(l.cwvLineItem.Total_Aggregate_Discounts__c ) >= 1000, '$ ' + TEXT(l.cwvLineItem.Total_Aggregate_Discounts__c/1000) + 'K', '$ ' + TEXT( l.cwvLineItem.Total_Aggregate_Discounts__c))))}">
                                    <apex:param value="{!l.cwvLineItem.Total_Aggregate_Discounts__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideOth">
                                <apex:outputText rendered="{!NOT(isExcelRender)}" value="{!IF(ABS(l.OthLineItem.Total_Aggregate_Discounts__c ) >= 1000000000, '$ ' + TEXT(l.OthLineItem.Total_Aggregate_Discounts__c/1000000000) + 'G', IF(ABS(l.OthLineItem.Total_Aggregate_Discounts__c ) >= 1000000, '$ ' + TEXT(l.OthLineItem.Total_Aggregate_Discounts__c/1000000) + 'M', IF(ABS(l.OthLineItem.Total_Aggregate_Discounts__c ) >= 1000, '$ ' + TEXT(l.OthLineItem.Total_Aggregate_Discounts__c/1000) + 'K', '$ ' + TEXT( l.OthLineItem.Total_Aggregate_Discounts__c))))}">
                                    <apex:param value="{!l.OthLineItem.Total_Aggregate_Discounts__c}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!isExcelRender}" value="{!IF(ABS(l.OthLineItem.Total_Aggregate_Discounts__c ) >= 1000000000, '$ ' + TEXT(l.OthLineItem.Total_Aggregate_Discounts__c/1000000000) + 'G', IF(ABS(l.OthLineItem.Total_Aggregate_Discounts__c ) >= 1000000, '$ ' + TEXT(l.OthLineItem.Total_Aggregate_Discounts__c/1000000) + 'M', IF(ABS(l.OthLineItem.Total_Aggregate_Discounts__c ) >= 1000, '$ ' + TEXT(l.OthLineItem.Total_Aggregate_Discounts__c/1000) + 'K', '$ ' + TEXT( l.OthLineItem.Total_Aggregate_Discounts__c))))}">
                                    <apex:param value="{!l.OthLineItem.Total_Aggregate_Discounts__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                        <apex:repeat value="{!totalColumns}" var="l">
                             <td class="currency-cell showHidePOR total" >
                                <apex:outputText value="{!IF(ABS(l.TotalPorLineItem.discount ) >= 1000000000, '$ ' + TEXT(l.TotalPorLineItem.discount/1000000000) + 'G', IF(ABS(l.TotalPorLineItem.discount ) >= 1000000, '$ ' + TEXT(l.TotalPorLineItem.discount/1000000) + 'M', IF(ABS(l.TotalPorLineItem.discount ) >= 1000, '$ ' + TEXT(l.TotalPorLineItem.discount/1000) + 'K', '$ ' + TEXT( l.TotalPorLineItem.discount))))}">
                                    <apex:param value="{!l.TotalPorLineItem.discount}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideCWV total">
                                <apex:outputText value="{!IF(ABS(l.TotalCwvLineItem.discount ) >= 1000000000, '$ ' + TEXT(l.TotalCwvLineItem.discount/1000000000) + 'G', IF(ABS(l.TotalCwvLineItem.discount ) >= 1000000, '$ ' + TEXT(l.TotalCwvLineItem.discount/1000000) + 'M', IF(ABS(l.TotalCwvLineItem.discount ) >= 1000, '$ ' + TEXT(l.TotalCwvLineItem.discount/1000) + 'K', '$ ' + TEXT( l.TotalCwvLineItem.discount))))}">
                                    <apex:param value="{!l.TotalCwvLineItem.discount}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideOth total">
                                <apex:outputText value="{!IF(ABS(l.TotalOthLineItem.discount ) >= 1000000000, '$ ' + TEXT(l.TotalOthLineItem.discount/1000000000) + 'G', IF(ABS(l.TotalOthLineItem.discount ) >= 1000000, '$ ' + TEXT(l.TotalOthLineItem.discount/1000000) + 'M', IF(ABS(l.TotalOthLineItem.discount ) >= 1000, '$ ' + TEXT(l.TotalOthLineItem.discount/1000) + 'K', '$ ' + TEXT( l.TotalOthLineItem.discount))))}">
                                    <apex:param value="{!l.TotalOthLineItem.discount}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                    </tr>
                    <tr class="single-underscore" style="border-bottom:1px solid #000;">
                        <td class="data-row-label">NSAD</td><td></td>
                        <apex:repeat value="{!lineItemColumns}" var="l">
                             <td class="currency-cell showHidePOR" >
                                <apex:outputText rendered="{!NOT(isExcelRender)}" value="{!IF(ABS(l.porLineItem.Total_NSAD__c ) >= 1000000000, '$ ' + TEXT(l.porLineItem.Total_NSAD__c/1000000000) + 'G', IF(ABS(l.porLineItem.Total_NSAD__c ) >= 1000000, '$ ' + TEXT(l.porLineItem.Total_NSAD__c/1000000) + 'M', IF(ABS(l.porLineItem.Total_NSAD__c ) >= 1000, '$ ' + TEXT(l.porLineItem.Total_NSAD__c/1000) + 'K', '$ ' + TEXT( l.porLineItem.Total_NSAD__c))))}">
                                    <apex:param value="{!l.porLineItem.Total_NSAD__c}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!isExcelRender}" value="{!IF(ABS(l.porLineItem.Total_NSAD__c ) >= 1000000000, '$ ' + TEXT(l.porLineItem.Total_NSAD__c/1000000000) + 'G', IF(ABS(l.porLineItem.Total_NSAD__c ) >= 1000000, '$ ' + TEXT(l.porLineItem.Total_NSAD__c/1000000) + 'M', IF(ABS(l.porLineItem.Total_NSAD__c ) >= 1000, '$ ' + TEXT(l.porLineItem.Total_NSAD__c/1000) + 'K', '$ ' + TEXT( l.porLineItem.Total_NSAD__c))))}">
                                    <apex:param value="{!l.porLineItem.Total_NSAD__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideCWV">
                                <apex:outputText rendered="{!NOT(isExcelRender)}" value="{!IF(ABS(l.cwvLineItem.Total_NSAD__c ) >= 1000000000, '$ ' + TEXT(l.cwvLineItem.Total_NSAD__c/1000000000) + 'G', IF(ABS(l.cwvLineItem.Total_NSAD__c ) >= 1000000, '$ ' + TEXT(l.cwvLineItem.Total_NSAD__c/1000000) + 'M', IF(ABS(l.cwvLineItem.Total_NSAD__c ) >= 1000, '$ ' + TEXT(l.cwvLineItem.Total_NSAD__c/1000) + 'K', '$ ' + TEXT( l.cwvLineItem.Total_NSAD__c))))}">
                                    <apex:param value="{!l.cwvLineItem.Total_NSAD__c}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!isExcelRender}" value="{!IF(ABS(l.cwvLineItem.Total_NSAD__c ) >= 1000000000, '$ ' + TEXT(l.cwvLineItem.Total_NSAD__c/1000000000) + 'G', IF(ABS(l.cwvLineItem.Total_NSAD__c ) >= 1000000, '$ ' + TEXT(l.cwvLineItem.Total_NSAD__c/1000000) + 'M', IF(ABS(l.cwvLineItem.Total_NSAD__c ) >= 1000, '$ ' + TEXT(l.cwvLineItem.Total_NSAD__c/1000) + 'K', '$ ' + TEXT( l.cwvLineItem.Total_NSAD__c))))}">
                                    <apex:param value="{!l.cwvLineItem.Total_NSAD__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideOth">
                                <apex:outputText rendered="{!NOT(isExcelRender)}" value="{!IF(ABS(l.OthLineItem.Total_NSAD__c ) >= 1000000000, '$ ' + TEXT(l.OthLineItem.Total_NSAD__c/1000000000) + 'G', IF(ABS(l.OthLineItem.Total_NSAD__c ) >= 1000000, '$ ' + TEXT(l.OthLineItem.Total_NSAD__c/1000000) + 'M', IF(ABS(l.OthLineItem.Total_NSAD__c ) >= 1000, '$ ' + TEXT(l.OthLineItem.Total_NSAD__c/1000) + 'K', '$ ' + TEXT( l.OthLineItem.Total_NSAD__c))))}">
                                    <apex:param value="{!l.OthLineItem.Total_NSAD__c}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!isExcelRender}" value="{!IF(ABS(l.OthLineItem.Total_NSAD__c ) >= 1000000000, '$ ' + TEXT(l.OthLineItem.Total_NSAD__c/1000000000) + 'G', IF(ABS(l.OthLineItem.Total_NSAD__c ) >= 1000000, '$ ' + TEXT(l.OthLineItem.Total_NSAD__c/1000000) + 'M', IF(ABS(l.OthLineItem.Total_NSAD__c ) >= 1000, '$ ' + TEXT(l.OthLineItem.Total_NSAD__c/1000) + 'K', '$ ' + TEXT( l.OthLineItem.Total_NSAD__c))))}">
                                    <apex:param value="{!l.OthLineItem.Total_NSAD__c}"/>
                                </apex:outputText>
                            </td>

                            <td class="col-sep"></td>
                        </apex:repeat>
                        <apex:repeat value="{!totalColumns}" var="l">
                             <td class="currency-cell showHidePOR total" >
                                <apex:outputText value="{!IF(ABS(l.TotalPorLineItem.nsad ) >= 1000000000, '$ ' + TEXT(l.TotalPorLineItem.nsad/1000000000) + 'G', IF(ABS(l.TotalPorLineItem.nsad ) >= 1000000, '$ ' + TEXT(l.TotalPorLineItem.nsad/1000000) + 'M', IF(ABS(l.TotalPorLineItem.nsad ) >= 1000, '$ ' + TEXT(l.TotalPorLineItem.nsad/1000) + 'K', '$ ' + TEXT( l.TotalPorLineItem.nsad))))}">
                                    <apex:param value="{!l.TotalPorLineItem.nsad}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideCWV total">
                                <apex:outputText value="{!IF(ABS(l.TotalCwvLineItem.nsad ) >= 1000000000, '$ ' + TEXT(l.TotalCwvLineItem.nsad/1000000000) + 'G', IF(ABS(l.TotalCwvLineItem.nsad ) >= 1000000, '$ ' + TEXT(l.TotalCwvLineItem.nsad/1000000) + 'M', IF(ABS(l.TotalCwvLineItem.nsad ) >= 1000, '$ ' + TEXT(l.TotalCwvLineItem.nsad/1000) + 'K', '$ ' + TEXT( l.TotalCwvLineItem.nsad))))}">
                                    <apex:param value="{!l.TotalCwvLineItem.nsad}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideOth total">
                                <apex:outputText value="{!IF(ABS(l.TotalOthLineItem.nsad ) >= 1000000000, '$ ' + TEXT(l.TotalOthLineItem.nsad/1000000000) + 'G', IF(ABS(l.TotalOthLineItem.nsad ) >= 1000000, '$ ' + TEXT(l.TotalOthLineItem.nsad/1000000) + 'M', IF(ABS(l.TotalOthLineItem.nsad ) >= 1000, '$ ' + TEXT(l.TotalOthLineItem.nsad/1000) + 'K', '$ ' + TEXT( l.TotalOthLineItem.nsad))))}">
                                    <apex:param value="{!l.TotalOthLineItem.nsad}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                    </tr>
                    <tr class="double-underscore" style="border-bottom:3px double #000;">
                        <td class="data-row-label">Gross Margin</td><td></td>
                        <apex:repeat value="{!lineItemColumns}" var="l">
                             <td class="currency-cell showHidePOR" >
                                <apex:outputText rendered="{!NOT(isExcelRender)}" value="{!IF(ABS(l.porLineItem.Total_Gross_Margin__c ) >= 1000000000, '$ ' + TEXT(l.porLineItem.Total_Gross_Margin__c/1000000000) + 'G', IF(ABS(l.porLineItem.Total_Gross_Margin__c ) >= 1000000, '$ ' + TEXT(l.porLineItem.Total_Gross_Margin__c/1000000) + 'M', IF(ABS(l.porLineItem.Total_Gross_Margin__c ) >= 1000, '$ ' + TEXT(l.porLineItem.Total_Gross_Margin__c/1000) + 'K', '$ ' + TEXT( l.porLineItem.Total_Gross_Margin__c))))}">
                                    <apex:param value="{!l.porLineItem.Total_Gross_Margin__c}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!isExcelRender}" value="{!IF(ABS(l.porLineItem.Total_Gross_Margin__c ) >= 1000000000, '$ ' + TEXT(l.porLineItem.Total_Gross_Margin__c/1000000000) + 'G', IF(ABS(l.porLineItem.Total_Gross_Margin__c ) >= 1000000, '$ ' + TEXT(l.porLineItem.Total_Gross_Margin__c/1000000) + 'M', IF(ABS(l.porLineItem.Total_Gross_Margin__c ) >= 1000, '$ ' + TEXT(l.porLineItem.Total_Gross_Margin__c/1000) + 'K', '$ ' + TEXT( l.porLineItem.Total_Gross_Margin__c))))}">
                                    <apex:param value="{!l.porLineItem.Total_Gross_Margin__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideCWV">
                                <apex:outputText rendered="{!NOT(isExcelRender)}" value="{!IF(ABS(l.cwvLineItem.Total_Gross_Margin__c ) >= 1000000000, '$ ' + TEXT(l.cwvLineItem.Total_Gross_Margin__c/1000000000) + 'G', IF(ABS(l.cwvLineItem.Total_Gross_Margin__c ) >= 1000000, '$ ' + TEXT(l.cwvLineItem.Total_Gross_Margin__c/1000000) + 'M', IF(ABS(l.cwvLineItem.Total_Gross_Margin__c ) >= 1000, '$ ' + TEXT(l.cwvLineItem.Total_Gross_Margin__c/1000) + 'K', '$ ' + TEXT( l.cwvLineItem.Total_Gross_Margin__c))))}">
                                    <apex:param value="{!l.cwvLineItem.Total_Gross_Margin__c}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!isExcelRender}" value="{!IF(ABS(l.cwvLineItem.Total_Gross_Margin__c ) >= 1000000000, '$ ' + TEXT(l.cwvLineItem.Total_Gross_Margin__c/1000000000) + 'G', IF(ABS(l.cwvLineItem.Total_Gross_Margin__c ) >= 1000000, '$ ' + TEXT(l.cwvLineItem.Total_Gross_Margin__c/1000000) + 'M', IF(ABS(l.cwvLineItem.Total_Gross_Margin__c ) >= 1000, '$ ' + TEXT(l.cwvLineItem.Total_Gross_Margin__c/1000) + 'K', '$ ' + TEXT( l.cwvLineItem.Total_Gross_Margin__c))))}">
                                    <apex:param value="{!l.cwvLineItem.Total_Gross_Margin__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideOth">
                                <apex:outputText rendered="{!NOT(isExcelRender)}" value="{!IF(ABS(l.OthLineItem.Total_Gross_Margin__c ) >= 1000000000, '$ ' + TEXT(l.OthLineItem.Total_Gross_Margin__c/1000000000) + 'G', IF(ABS(l.OthLineItem.Total_Gross_Margin__c ) >= 1000000, '$ ' + TEXT(l.OthLineItem.Total_Gross_Margin__c/1000000) + 'M', IF(ABS(l.OthLineItem.Total_Gross_Margin__c ) >= 1000, '$ ' + TEXT(l.OthLineItem.Total_Gross_Margin__c/1000) + 'K', '$ ' + TEXT( l.OthLineItem.Total_Gross_Margin__c))))}">
                                    <apex:param value="{!l.OthLineItem.Total_Gross_Margin__c}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!isExcelRender}" value="{!IF(ABS(l.OthLineItem.Total_Gross_Margin__c ) >= 1000000000, '$ ' + TEXT(l.OthLineItem.Total_Gross_Margin__c/1000000000) + 'G', IF(ABS(l.OthLineItem.Total_Gross_Margin__c ) >= 1000000, '$ ' + TEXT(l.OthLineItem.Total_Gross_Margin__c/1000000) + 'M', IF(ABS(l.OthLineItem.Total_Gross_Margin__c ) >= 1000, '$ ' + TEXT(l.OthLineItem.Total_Gross_Margin__c/1000) + 'K', '$ ' + TEXT( l.OthLineItem.Total_Gross_Margin__c))))}">
                                    <apex:param value="{!l.OthLineItem.Total_Gross_Margin__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                        <apex:repeat value="{!totalColumns}" var="l">
                             <td class="currency-cell showHidePOR total" >
                                <apex:outputText value="{!IF(ABS(l.TotalPorLineItem.grossMargin ) >= 1000000000, '$ ' + TEXT(l.TotalPorLineItem.grossMargin/1000000000) + 'G', IF(ABS(l.TotalPorLineItem.grossMargin ) >= 1000000, '$ ' + TEXT(l.TotalPorLineItem.grossMargin/1000000) + 'M', IF(ABS(l.TotalPorLineItem.grossMargin ) >= 1000, '$ ' + TEXT(l.TotalPorLineItem.grossMargin/1000) + 'K', '$ ' + TEXT( l.TotalPorLineItem.grossMargin))))}">
                                    <apex:param value="{!l.TotalPorLineItem.grossMargin}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideCWV total">
                                <apex:outputText value="{!IF(ABS(l.TotalCwvLineItem.grossMargin ) >= 1000000000, '$ ' + TEXT(l.TotalCwvLineItem.grossMargin/1000000000) + 'G', IF(ABS(l.TotalCwvLineItem.grossMargin ) >= 1000000, '$ ' + TEXT(l.TotalCwvLineItem.grossMargin/1000000) + 'M', IF(ABS(l.TotalCwvLineItem.grossMargin ) >= 1000, '$ ' + TEXT(l.TotalCwvLineItem.grossMargin/1000) + 'K', '$ ' + TEXT( l.TotalCwvLineItem.grossMargin))))}">
                                    <apex:param value="{!l.TotalCwvLineItem.grossMargin}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideOth total">
                                <apex:outputText value="{!IF(ABS(l.TotalOthLineItem.grossMargin ) >= 1000000000, '$ ' + TEXT(l.TotalOthLineItem.grossMargin/1000000000) + 'G', IF(ABS(l.TotalOthLineItem.grossMargin ) >= 1000000, '$ ' + TEXT(l.TotalOthLineItem.grossMargin/1000000) + 'M', IF(ABS(l.TotalOthLineItem.grossMargin ) >= 1000, '$ ' + TEXT(l.TotalOthLineItem.grossMargin/1000) + 'K', '$ ' + TEXT( l.TotalOthLineItem.grossMargin))))}">
                                    <apex:param value="{!l.TotalOthLineItem.grossMargin}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                    </tr>
                    <tr class="single-underscore" style="border-bottom:1px solid #000;">
                        <td class="data-row-label">Total A&amp;P</td><td></td>
                        <apex:repeat value="{!lineItemColumns}" var="l">
                             <td class="currency-cell showHidePOR" >
                                <apex:outputText rendered="{!NOT(isExcelRender)}" value="{!IF(ABS(l.porLineItem.Total_A_P__c ) >= 1000000000, '$ ' + TEXT(l.porLineItem.Total_A_P__c/1000000000) + 'G', IF(ABS(l.porLineItem.Total_A_P__c ) >= 1000000, '$ ' + TEXT(l.porLineItem.Total_A_P__c/1000000) + 'M', IF(ABS(l.porLineItem.Total_A_P__c ) >= 1000, '$ ' + TEXT(l.porLineItem.Total_A_P__c/1000) + 'K', '$ ' + TEXT( l.porLineItem.Total_A_P__c))))}">
                                    <apex:param value="{!l.porLineItem.Total_A_P__c}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!isExcelRender}" value="{!IF(ABS(l.porLineItem.Total_A_P__c ) >= 1000000000, '$ ' + TEXT(l.porLineItem.Total_A_P__c/1000000000) + 'G', IF(ABS(l.porLineItem.Total_A_P__c ) >= 1000000, '$ ' + TEXT(l.porLineItem.Total_A_P__c/1000000) + 'M', IF(ABS(l.porLineItem.Total_A_P__c ) >= 1000, '$ ' + TEXT(l.porLineItem.Total_A_P__c/1000) + 'K', '$ ' + TEXT( l.porLineItem.Total_A_P__c))))}">
                                    <apex:param value="{!l.porLineItem.Total_A_P__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideCWV">
                                <apex:outputText rendered="{!NOT(isExcelRender)}" value="{!IF(ABS(l.cwvLineItem.Total_A_P__c ) >= 1000000000, '$ ' + TEXT(l.cwvLineItem.Total_A_P__c/1000000000) + 'G', IF(ABS(l.cwvLineItem.Total_A_P__c ) >= 1000000, '$ ' + TEXT(l.cwvLineItem.Total_A_P__c/1000000) + 'M', IF(ABS(l.cwvLineItem.Total_A_P__c ) >= 1000, '$ ' + TEXT(l.cwvLineItem.Total_A_P__c/1000) + 'K', '$ ' + TEXT( l.cwvLineItem.Total_A_P__c))))}">
                                    <apex:param value="{!l.cwvLineItem.Total_A_P__c}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!isExcelRender}" value="{!IF(ABS(l.cwvLineItem.Total_A_P__c ) >= 1000000000, '$ ' + TEXT(l.cwvLineItem.Total_A_P__c/1000000000) + 'G', IF(ABS(l.cwvLineItem.Total_A_P__c ) >= 1000000, '$ ' + TEXT(l.cwvLineItem.Total_A_P__c/1000000) + 'M', IF(ABS(l.cwvLineItem.Total_A_P__c ) >= 1000, '$ ' + TEXT(l.cwvLineItem.Total_A_P__c/1000) + 'K', '$ ' + TEXT( l.cwvLineItem.Total_A_P__c))))}">
                                    <apex:param value="{!l.cwvLineItem.Total_A_P__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideOth">
                                <apex:outputText rendered="{!NOT(isExcelRender)}" value="{!IF(ABS(l.OthLineItem.Total_A_P__c ) >= 1000000000, '$ ' + TEXT(l.OthLineItem.Total_A_P__c/1000000000) + 'G', IF(ABS(l.OthLineItem.Total_A_P__c ) >= 1000000, '$ ' + TEXT(l.OthLineItem.Total_A_P__c/1000000) + 'M', IF(ABS(l.OthLineItem.Total_A_P__c ) >= 1000, '$ ' + TEXT(l.OthLineItem.Total_A_P__c/1000) + 'K', '$ ' + TEXT( l.OthLineItem.Total_A_P__c))))}">
                                    <apex:param value="{!l.OthLineItem.Total_A_P__c}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!isExcelRender}" value="{!IF(ABS(l.OthLineItem.Total_A_P__c ) >= 1000000000, '$ ' + TEXT(l.OthLineItem.Total_A_P__c/1000000000) + 'G', IF(ABS(l.OthLineItem.Total_A_P__c ) >= 1000000, '$ ' + TEXT(l.OthLineItem.Total_A_P__c/1000000) + 'M', IF(ABS(l.OthLineItem.Total_A_P__c ) >= 1000, '$ ' + TEXT(l.OthLineItem.Total_A_P__c/1000) + 'K', '$ ' + TEXT( l.OthLineItem.Total_A_P__c))))}">
                                    <apex:param value="{!l.OthLineItem.Total_A_P__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                        <apex:repeat value="{!totalColumns}" var="l">
                             <td class="currency-cell showHidePOR total" >
                                <apex:outputText value="{!IF(ABS(l.TotalPorLineItem.aAndP ) >= 1000000000, '$ ' + TEXT(l.TotalPorLineItem.aAndP/1000000000) + 'G', IF(ABS(l.TotalPorLineItem.aAndP ) >= 1000000, '$ ' + TEXT(l.TotalPorLineItem.aAndP/1000000) + 'M', IF(ABS(l.TotalPorLineItem.aAndP ) >= 1000, '$ ' + TEXT(l.TotalPorLineItem.aAndP/1000) + 'K', '$ ' + TEXT( l.TotalPorLineItem.aAndP))))}">
                                    <apex:param value="{!l.TotalPorLineItem.aAndP}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideCWV total">
                                <apex:outputText value="{!IF(ABS(l.TotalCwvLineItem.aAndP ) >= 1000000000, '$ ' + TEXT(l.TotalCwvLineItem.aAndP/1000000000) + 'G', IF(ABS(l.TotalCwvLineItem.aAndP ) >= 1000000, '$ ' + TEXT(l.TotalCwvLineItem.aAndP/1000000) + 'M', IF(ABS(l.TotalCwvLineItem.aAndP ) >= 1000, '$ ' + TEXT(l.TotalCwvLineItem.aAndP/1000) + 'K', '$ ' + TEXT( l.TotalCwvLineItem.aAndP))))}">
                                    <apex:param value="{!l.TotalCwvLineItem.aAndP}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideOth total">
                                <apex:outputText value="{!IF(ABS(l.TotalOthLineItem.aAndP ) >= 1000000000, '$ ' + TEXT(l.TotalOthLineItem.aAndP/1000000000) + 'G', IF(ABS(l.TotalOthLineItem.aAndP ) >= 1000000, '$ ' + TEXT(l.TotalOthLineItem.aAndP/1000000) + 'M', IF(ABS(l.TotalOthLineItem.aAndP ) >= 1000, '$ ' + TEXT(l.TotalOthLineItem.aAndP/1000) + 'K', '$ ' + TEXT( l.TotalOthLineItem.aAndP))))}">
                                    <apex:param value="{!l.TotalOthLineItem.aAndP}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                    </tr>
                    <tr class="single-underscore" style="border-bottom:1px solid #000;">
                        <td class="data-row-label">Motoagents</td><td></td>
                        <apex:repeat value="{!lineItemColumns}" var="l">
                             <td class="currency-cell showHidePOR" >
                                <apex:outputText rendered="{!NOT(isExcelRender)}" value="{!IF(ABS(l.porLineItem.Total_Motoagents__c ) >= 1000000000, '$ ' + TEXT(l.porLineItem.Total_Motoagents__c/1000000000) + 'G', IF(ABS(l.porLineItem.Total_Motoagents__c ) >= 1000000, '$ ' + TEXT(l.porLineItem.Total_Motoagents__c/1000000) + 'M', IF(ABS(l.porLineItem.Total_Motoagents__c ) >= 1000, '$ ' + TEXT(l.porLineItem.Total_Motoagents__c/1000) + 'K', '$ ' + TEXT( l.porLineItem.Total_Motoagents__c))))}">
                                    <apex:param value="{!l.porLineItem.Total_Motoagents__c}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!isExcelRender}" value="{!IF(ABS(l.porLineItem.Total_Motoagents__c ) >= 1000000000, '$ ' + TEXT(l.porLineItem.Total_Motoagents__c/1000000000) + 'G', IF(ABS(l.porLineItem.Total_Motoagents__c ) >= 1000000, '$ ' + TEXT(l.porLineItem.Total_Motoagents__c/1000000) + 'M', IF(ABS(l.porLineItem.Total_Motoagents__c ) >= 1000, '$ ' + TEXT(l.porLineItem.Total_Motoagents__c/1000) + 'K', '$ ' + TEXT( l.porLineItem.Total_Motoagents__c))))}">
                                    <apex:param value="{!l.porLineItem.Total_Motoagents__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideCWV">
                                <apex:outputText rendered="{!NOT(isExcelRender)}" value="{!IF(ABS(l.cwvLineItem.Total_Motoagents__c ) >= 1000000000, '$ ' + TEXT(l.cwvLineItem.Total_Motoagents__c/1000000000) + 'G', IF(ABS(l.cwvLineItem.Total_Motoagents__c ) >= 1000000, '$ ' + TEXT(l.cwvLineItem.Total_Motoagents__c/1000000) + 'M', IF(ABS(l.cwvLineItem.Total_Motoagents__c ) >= 1000, '$ ' + TEXT(l.cwvLineItem.Total_Motoagents__c/1000) + 'K', '$ ' + TEXT( l.cwvLineItem.Total_Motoagents__c))))}">
                                    <apex:param value="{!l.cwvLineItem.Total_Motoagents__c}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!isExcelRender}" value="{!IF(ABS(l.cwvLineItem.Total_Motoagents__c ) >= 1000000000, '$ ' + TEXT(l.cwvLineItem.Total_Motoagents__c/1000000000) + 'G', IF(ABS(l.cwvLineItem.Total_Motoagents__c ) >= 1000000, '$ ' + TEXT(l.cwvLineItem.Total_Motoagents__c/1000000) + 'M', IF(ABS(l.cwvLineItem.Total_Motoagents__c ) >= 1000, '$ ' + TEXT(l.cwvLineItem.Total_Motoagents__c/1000) + 'K', '$ ' + TEXT( l.cwvLineItem.Total_Motoagents__c))))}">
                                    <apex:param value="{!l.cwvLineItem.Total_Motoagents__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideOth">
                                <apex:outputText rendered="{!NOT(isExcelRender)}" value="{!IF(ABS(l.OthLineItem.Total_Motoagents__c ) >= 1000000000, '$ ' + TEXT(l.OthLineItem.Total_Motoagents__c/1000000000) + 'G', IF(ABS(l.OthLineItem.Total_Motoagents__c ) >= 1000000, '$ ' + TEXT(l.OthLineItem.Total_Motoagents__c/1000000) + 'M', IF(ABS(l.OthLineItem.Total_Motoagents__c ) >= 1000, '$ ' + TEXT(l.OthLineItem.Total_Motoagents__c/1000) + 'K', '$ ' + TEXT( l.OthLineItem.Total_Motoagents__c))))}">
                                    <apex:param value="{!l.OthLineItem.Total_Motoagents__c}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!isExcelRender}" value="{!IF(ABS(l.OthLineItem.Total_Motoagents__c ) >= 1000000000, '$ ' + TEXT(l.OthLineItem.Total_Motoagents__c/1000000000) + 'G', IF(ABS(l.OthLineItem.Total_Motoagents__c ) >= 1000000, '$ ' + TEXT(l.OthLineItem.Total_Motoagents__c/1000000) + 'M', IF(ABS(l.OthLineItem.Total_Motoagents__c ) >= 1000, '$ ' + TEXT(l.OthLineItem.Total_Motoagents__c/1000) + 'K', '$ ' + TEXT( l.OthLineItem.Total_Motoagents__c))))}">
                                    <apex:param value="{!l.OthLineItem.Total_Motoagents__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                        <apex:repeat value="{!totalColumns}" var="l">
                             <td class="currency-cell showHidePOR total" >
                                <apex:outputText value="{!IF(ABS(l.TotalPorLineItem.motoagents ) >= 1000000000, '$ ' + TEXT(l.TotalPorLineItem.motoagents/1000000000) + 'G', IF(ABS(l.TotalPorLineItem.motoagents ) >= 1000000, '$ ' + TEXT(l.TotalPorLineItem.motoagents/1000000) + 'M', IF(ABS(l.TotalPorLineItem.motoagents ) >= 1000, '$ ' + TEXT(l.TotalPorLineItem.motoagents/1000) + 'K', '$ ' + TEXT( l.TotalPorLineItem.motoagents))))}">
                                    <apex:param value="{!l.TotalPorLineItem.motoagents}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideCWV total">
                                <apex:outputText value="{!IF(ABS(l.TotalCwvLineItem.motoagents ) >= 1000000000, '$ ' + TEXT(l.TotalCwvLineItem.motoagents/1000000000) + 'G', IF(ABS(l.TotalCwvLineItem.motoagents ) >= 1000000, '$ ' + TEXT(l.TotalCwvLineItem.motoagents/1000000) + 'M', IF(ABS(l.TotalCwvLineItem.motoagents ) >= 1000, '$ ' + TEXT(l.TotalCwvLineItem.motoagents/1000) + 'K', '$ ' + TEXT( l.TotalCwvLineItem.motoagents))))}">
                                    <apex:param value="{!l.TotalCwvLineItem.motoagents}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideOth total">
                                <apex:outputText value="{!IF(ABS(l.TotalOthLineItem.motoagents ) >= 1000000000, '$ ' + TEXT(l.TotalOthLineItem.motoagents/1000000000) + 'G', IF(ABS(l.TotalOthLineItem.motoagents ) >= 1000000, '$ ' + TEXT(l.TotalOthLineItem.motoagents/1000000) + 'M', IF(ABS(l.TotalOthLineItem.motoagents ) >= 1000, '$ ' + TEXT(l.TotalOthLineItem.motoagents/1000) + 'K', '$ ' + TEXT( l.TotalOthLineItem.motoagents))))}">
                                    <apex:param value="{!l.TotalOthLineItem.motoagents}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                    </tr>
                    <tr class="double-underscore" style="border-bottom:3px double #000;">
                        <td class="data-row-label">Contribution Margin</td><td></td>
                        <apex:repeat value="{!lineItemColumns}" var="l">
                             <td class="currency-cell showHidePOR" >
                                <apex:outputText rendered="{!NOT(isExcelRender)}" value="{!IF(ABS(l.porLineItem.Total_Contribution_Margin__c ) >= 1000000000, '$ ' + TEXT(l.porLineItem.Total_Contribution_Margin__c/1000000000) + 'G', IF(ABS(l.porLineItem.Total_Contribution_Margin__c ) >= 1000000, '$ ' + TEXT(l.porLineItem.Total_Contribution_Margin__c/1000000) + 'M', IF(ABS(l.porLineItem.Total_Contribution_Margin__c ) >= 1000, '$ ' + TEXT(l.porLineItem.Total_Contribution_Margin__c/1000) + 'K', '$ ' + TEXT( l.porLineItem.Total_Contribution_Margin__c))))}">
                                    <apex:param value="{!l.porLineItem.Total_Contribution_Margin__c}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!isExcelRender}" value="{!IF(ABS(l.porLineItem.Total_Contribution_Margin__c )  >= 1000000000, '$ ' + TEXT(l.porLineItem.Total_Contribution_Margin__c/1000000000) + 'G', IF(ABS(l.porLineItem.Total_Contribution_Margin__c ) >= 1000000, '$ ' + TEXT(l.porLineItem.Total_Contribution_Margin__c/1000000) + 'M', IF(ABS(l.porLineItem.Total_Contribution_Margin__c ) >= 1000, '$ ' + TEXT(l.porLineItem.Total_Contribution_Margin__c/1000) + 'K', '$ ' + TEXT( l.porLineItem.Total_Contribution_Margin__c))))}">
                                    <apex:param value="{!l.porLineItem.Total_Contribution_Margin__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideCWV">
                                <apex:outputText rendered="{!NOT(isExcelRender)}" value="{!IF(ABS(l.cwvlineItem.Total_Contribution_Margin__c ) >= 1000000000, '$ ' + TEXT(l.cwvlineItem.Total_Contribution_Margin__c/1000000000) + 'G', IF(ABS(l.cwvlineItem.Total_Contribution_Margin__c ) >= 1000000, '$ ' + TEXT(l.cwvlineItem.Total_Contribution_Margin__c/1000000) + 'M', IF(ABS(l.cwvlineItem.Total_Contribution_Margin__c ) >= 1000, '$ ' + TEXT(l.cwvlineItem.Total_Contribution_Margin__c/1000) + 'K', '$ ' + TEXT( l.cwvlineItem.Total_Contribution_Margin__c))))}">
                                    <apex:param value="{!l.cwvlineItem.Total_Contribution_Margin__c}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!isExcelRender}" value="{!IF(ABS(l.cwvlineItem.Total_Contribution_Margin__c ) >= 1000000000, '$ ' + TEXT(l.cwvlineItem.Total_Contribution_Margin__c/1000000000) + 'G', IF(ABS(l.cwvlineItem.Total_Contribution_Margin__c ) >= 1000000, '$ ' + TEXT(l.cwvlineItem.Total_Contribution_Margin__c/1000000) + 'M', IF(ABS(l.cwvlineItem.Total_Contribution_Margin__c ) >= 1000, '$ ' + TEXT(l.cwvlineItem.Total_Contribution_Margin__c/1000) + 'K', '$ ' + TEXT( l.cwvlineItem.Total_Contribution_Margin__c))))}">
                                    <apex:param value="{!l.cwvLineItem.Total_Contribution_Margin__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideOth">
                                <apex:outputText rendered="{!NOT(isExcelRender)}" value="{!IF(ABS(l.OthlineItem.Total_Contribution_Margin__c ) >= 1000000000, '$ ' + TEXT(l.OthlineItem.Total_Contribution_Margin__c/1000000000) + 'G', IF(ABS(l.OthlineItem.Total_Contribution_Margin__c ) >= 1000000, '$ ' + TEXT(l.OthlineItem.Total_Contribution_Margin__c/1000000) + 'M', IF(ABS(l.OthlineItem.Total_Contribution_Margin__c ) >= 1000, '$ ' + TEXT(l.OthlineItem.Total_Contribution_Margin__c/1000) + 'K', '$ ' + TEXT( l.OthlineItem.Total_Contribution_Margin__c))))}">
                                    <apex:param value="{!l.OthlineItem.Total_Contribution_Margin__c}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!isExcelRender}" value="{!IF(ABS(l.OthlineItem.Total_Contribution_Margin__c ) >= 1000000000, '$ ' + TEXT(l.OthlineItem.Total_Contribution_Margin__c/1000000000) + 'G', IF(ABS(l.OthlineItem.Total_Contribution_Margin__c ) >= 1000000, '$ ' + TEXT(l.OthlineItem.Total_Contribution_Margin__c/1000000) + 'M', IF(ABS(l.OthlineItem.Total_Contribution_Margin__c ) >= 1000, '$ ' + TEXT(l.OthlineItem.Total_Contribution_Margin__c/1000) + 'K', '$ ' + TEXT( l.OthlineItem.Total_Contribution_Margin__c))))}">
                                    <apex:param value="{!l.OthLineItem.Total_Contribution_Margin__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                        <apex:repeat value="{!totalColumns}" var="l">
                             <td class="currency-cell showHidePOR total" >
                                <apex:outputText value="{!IF(ABS(l.TotalPorLineItem.contributionMargin ) >= 1000000000, '$ ' + TEXT(l.TotalPorLineItem.contributionMargin/1000000000) + 'G', IF(ABS(l.TotalPorLineItem.contributionMargin ) >= 1000000, '$ ' + TEXT(l.TotalPorLineItem.contributionMargin/1000000) + 'M', IF(ABS(l.TotalPorLineItem.contributionMargin ) >= 1000, '$ ' + TEXT(l.TotalPorLineItem.contributionMargin/1000) + 'K', '$ ' + TEXT( l.TotalPorLineItem.contributionMargin))))}">
                                    <apex:param value="{!l.TotalPorLineItem.contributionMargin}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideCWV total">
                                <apex:outputText value="{!IF(ABS(l.TotalCwvLineItem.contributionMargin ) >= 1000000000, '$ ' + TEXT(l.TotalCwvLineItem.contributionMargin/1000000000) + 'G', IF(ABS(l.TotalCwvLineItem.contributionMargin ) >= 1000000, '$ ' + TEXT(l.TotalCwvLineItem.contributionMargin/1000000) + 'M', IF(ABS(l.TotalCwvLineItem.contributionMargin ) >= 1000, '$ ' + TEXT(l.TotalCwvLineItem.contributionMargin/1000) + 'K', '$ ' + TEXT( l.TotalCwvLineItem.contributionMargin))))}">
                                    <apex:param value="{!l.TotalCwvLineItem.contributionMargin}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideOth total">
                                <apex:outputText value="{!IF(ABS(l.TotalOthLineItem.contributionMargin ) >= 1000000000, '$ ' + TEXT(l.TotalOthLineItem.contributionMargin/1000000000) + 'G', IF(ABS(l.TotalOthLineItem.contributionMargin ) >= 1000000, '$ ' + TEXT(l.TotalOthLineItem.contributionMargin/1000000) + 'M', IF(ABS(l.TotalOthLineItem.contributionMargin ) >= 1000, '$ ' + TEXT(l.TotalOthLineItem.contributionMargin/1000) + 'K', '$ ' + TEXT( l.TotalOthLineItem.contributionMargin))))}">
                                    <apex:param value="{!l.TotalOthLineItem.contributionMargin}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                    </tr>
                    <tr>
                        <td class="blank-row" colspan="{!1+(4*lineItemCount)+(4*totalItemCount)}"></td>
                    </tr>
                    <!--END OPERATOR/RETAIL TABLE-->
                </table>
                </apex:outputPanel>
          </apex:outputPanel>
          <apex:outputPanel rendered="{!IF($CurrentPage.parameters.exportMode == 'summary', true, false)}">
                        <table cellpadding="0" cellspacing="0" border="0" class="dataTable" id="notesTabPanel">
                              <tr>
                                <td class="section-header" colspan="{!1+(4*lineItemCount)+(4*totalItemCount)}" style="font-weight:bold;font-size:1.2em;text-transform:uppercase;border-bottom:1px solid #000;padding-top: 20px;">Summary</td>
                              </tr>
                            <tr>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td class="col-sep"></td>
                                <apex:repeat rendered="{!summaryProductCount>1}" value="{!summaryProductColumns}" var="l" >
                                    <td class="col-sep"></td>
                                    <td class="prod-header" colspan="3">
                                        <span> {!l.ProductName}</span>
                                    </td>
                                </apex:repeat>
                            </tr>
                            <tr>
                                <td></td>
                                <td class="prod-sub-header">Plan</td>
                                <td class="prod-sub-header" >Proposal</td>
                                <td class="prod-sub-header" >Others</td>
                                <td class="col-sep"></td>
                                <apex:repeat rendered="{!summaryProductCount>1}" value="{!summaryProductColumns}" var="l" >
                                    <td class="prod-sub-header">Plan</td>
                                    <td class="prod-sub-header" >Proposal</td>
                                    <td class="prod-sub-header" >Others</td>
                                    <td class="col-sep"></td>
                                </apex:repeat>
                            </tr>
                           <tr>
                                <td class="data-row-label">Units</td>
                                <td class="currency-cell">
                                    <apex:outputText value="{!IF(ABS(summaryColumns.porLineItem.units) >= 1000000000, TEXT(ROUND(summaryColumns.porLineItem.units/1000000000, 2)) + 'G', IF(ABS(summaryColumns.porLineItem.units) >= 1000000, TEXT(ROUND(summaryColumns.porLineItem.units/1000000, 2)) + 'M', IF(ABS(summaryColumns.porLineItem.units) >= 1000, TEXT(ROUND(summaryColumns.porLineItem.units/1000, 2)) + 'K', TEXT(ROUND(summaryColumns.porLineItem.units, 2)))))}">
                                        <apex:param value="{!summaryColumns.porLineItem.units}"/>
                                    </apex:outputText>
                                </td>
                                <td class="currency-cell">
                                    <apex:outputText value="{!IF(ABS(summaryColumns.cwvLineItem.units) >= 1000000000, TEXT(ROUND(summaryColumns.cwvLineItem.units/1000000000, 2)) + 'G', IF(ABS(summaryColumns.cwvLineItem.units) >= 1000000, TEXT(ROUND(summaryColumns.cwvLineItem.units/1000000, 2)) + 'M', IF(ABS(summaryColumns.cwvLineItem.units) >= 1000, TEXT(ROUND(summaryColumns.cwvLineItem.units/1000, 2)) + 'K', TEXT(ROUND(summaryColumns.cwvLineItem.units, 2)))))}">
                                        <apex:param value="{!summaryColumns.cwvLineItem.units}"/>
                                    </apex:outputText>
                                </td>
                                <td class="currency-cell">
                                    <apex:outputText value="{!IF(ABS(summaryColumns.OthLineItem.units) >= 1000000000, TEXT(ROUND(summaryColumns.OthLineItem.units/1000000000, 2)) + 'G', IF(ABS(summaryColumns.OthLineItem.units) >= 1000000, TEXT(ROUND(summaryColumns.OthLineItem.units/1000000, 2)) + 'M', IF(ABS(summaryColumns.OthLineItem.units) >= 1000, TEXT(ROUND(summaryColumns.OthLineItem.units/1000, 2)) + 'K', TEXT(ROUND(summaryColumns.OthLineItem.units, 2)))))}">
                                        <apex:param value="{!summaryColumns.OthLineItem.units}"/>
                                    </apex:outputText>
                                </td>
                               <td class="col-sep"></td>
                               <apex:repeat rendered="{!summaryProductCount>1}" value="{!summaryProductColumns}" var="l" >
                                   <td class="currency-cell">
                                        <apex:outputText value="{!IF(ABS(l.porLineItem.units) >= 1000000000, TEXT(ROUND(l.porLineItem.units/1000000000, 2)) + 'G', IF(ABS(l.porLineItem.units) >= 1000000, TEXT(ROUND(l.porLineItem.units/1000000, 2)) + 'M', IF(ABS(l.porLineItem.units) >= 1000, TEXT(ROUND(l.porLineItem.units/1000, 2)) + 'K', TEXT(ROUND(l.porLineItem.units, 2)))))}">
                                            <apex:param value="{!l.porLineItem.units}"/>
                                        </apex:outputText>
                                    </td>
                                    <td class="currency-cell">
                                        <apex:outputText value="{!IF(ABS(l.cwvLineItem.units) >= 1000000000, TEXT(ROUND(l.cwvLineItem.units/1000000000, 2)) + 'G', IF(ABS(l.cwvLineItem.units) >= 1000000, TEXT(ROUND(l.cwvLineItem.units/1000000, 2)) + 'M', IF(ABS(l.cwvLineItem.units) >= 1000, TEXT(ROUND(l.cwvLineItem.units/1000, 2)) + 'K', TEXT(ROUND(l.cwvLineItem.units, 2)))))}">
                                            <apex:param value="{!l.cwvLineItem.units}"/>
                                        </apex:outputText>
                                    </td>
                                    <td class="currency-cell">
                                        <apex:outputText value="{!IF(ABS(l.OthLineItem.units) >= 1000000000, TEXT(ROUND(l.OthLineItem.units/1000000000, 2)) + 'G', IF(ABS(l.OthLineItem.units) >= 1000000, TEXT(ROUND(l.OthLineItem.units/1000000, 2)) + 'M', IF(ABS(l.OthLineItem.units) >= 1000, TEXT(ROUND(l.OthLineItem.units/1000, 2)) + 'K', TEXT(ROUND(l.OthLineItem.units, 2)))))}">
                                            <apex:param value="{!l.OthLineItem.units}"/>
                                        </apex:outputText>
                                    </td>
                                   <td class="col-sep"></td>
                                </apex:repeat>
                            </tr>
                            <tr>
                                <td class="data-row-label"> Minimum Commit</td>
                                <td class="currency-cell">
                                    <apex:outputText value="{!IF(ABS(summaryColumns.porLineItem.minCommit ) >= 1000000000, TEXT(ROUND(summaryColumns.porLineItem.minCommit/1000000000, 2)) + 'G', IF(ABS(summaryColumns.porLineItem.minCommit) >= 1000000, TEXT(ROUND(summaryColumns.porLineItem.minCommit/1000000, 2)) + 'M', IF(ABS(summaryColumns.porLineItem.minCommit) >= 1000, TEXT(ROUND(summaryColumns.porLineItem.minCommit/1000, 2)) + 'K', TEXT(ROUND(summaryColumns.porLineItem.minCommit, 2)))))}">
                                        <apex:param value="{!summaryColumns.porLineItem.minCommit}"/>
                                    </apex:outputText>
                                </td>
                                <td class="currency-cell">
                                    <apex:outputText value="{!IF(ABS(summaryColumns.cwvLineItem.minCommit) >= 1000000000, TEXT(ROUND(summaryColumns.cwvLineItem.minCommit/1000000000, 2)) + 'G', IF(ABS(summaryColumns.cwvLineItem.minCommit) >= 1000000, TEXT(ROUND(summaryColumns.cwvLineItem.minCommit/1000000, 2)) + 'M', IF(ABS(summaryColumns.cwvLineItem.minCommit) >= 1000, TEXT(ROUND(summaryColumns.cwvLineItem.minCommit/1000, 2)) + 'K', TEXT(ROUND(summaryColumns.cwvLineItem.minCommit, 2)))))}">
                                        <apex:param value="{!summaryColumns.cwvLineItem.minCommit}"/>
                                    </apex:outputText>
                                </td>
                                <td class="currency-cell">
                                    <apex:outputText value="{!IF(ABS(summaryColumns.OthLineItem.minCommit) >= 1000000000, TEXT(ROUND(summaryColumns.OthLineItem.minCommit/1000000000, 2)) + 'G', IF(ABS(summaryColumns.OthLineItem.minCommit) >= 1000000, TEXT(ROUND(summaryColumns.OthLineItem.minCommit/1000000, 2)) + 'M', IF(ABS(summaryColumns.OthLineItem.minCommit) >= 1000, TEXT(ROUND(summaryColumns.OthLineItem.minCommit/1000, 2)) + 'K', TEXT(ROUND(summaryColumns.OthLineItem.minCommit, 2)))))}">
                                        <apex:param value="{!summaryColumns.OthLineItem.minCommit}"/>
                                    </apex:outputText>
                                </td>
                                <td class="col-sep"></td>
                                <apex:repeat rendered="{!summaryProductCount>1}" value="{!summaryProductColumns}" var="l" >
                                    <td class="currency-cell">
                                        <apex:outputText value="{!IF(ABS(l.porLineItem.minCommit ) >= 1000000000, TEXT(ROUND(l.porLineItem.minCommit/1000000000, 2)) + 'G', IF(ABS(l.porLineItem.minCommit) >= 1000000, TEXT(ROUND(l.porLineItem.minCommit/1000000, 2)) + 'M', IF(ABS(l.porLineItem.minCommit) >= 1000, TEXT(ROUND(l.porLineItem.minCommit/1000, 2)) + 'K', TEXT(ROUND(l.porLineItem.minCommit, 2)))))}">
                                            <apex:param value="{!l.porLineItem.minCommit}"/>
                                        </apex:outputText>
                                    </td>
                                    <td class="currency-cell">
                                        <apex:outputText value="{!IF(ABS(l.cwvLineItem.minCommit) >= 1000000000, TEXT(ROUND(l.cwvLineItem.minCommit/1000000000, 2)) + 'G', IF(ABS(l.cwvLineItem.minCommit) >= 1000000, TEXT(ROUND(l.cwvLineItem.minCommit/1000000, 2)) + 'M', IF(ABS(l.cwvLineItem.minCommit) >= 1000, TEXT(ROUND(l.cwvLineItem.minCommit/1000, 2)) + 'K', TEXT(ROUND(l.cwvLineItem.minCommit, 2)))))}">
                                            <apex:param value="{!l.cwvLineItem.minCommit}"/>
                                        </apex:outputText>
                                    </td>
                                    <td class="currency-cell">
                                        <apex:outputText value="{!IF(ABS(l.OthLineItem.minCommit) >= 1000000000, TEXT(ROUND(l.OthLineItem.minCommit/1000000000, 2)) + 'G', IF(ABS(l.OthLineItem.minCommit) >= 1000000, TEXT(ROUND(l.OthLineItem.minCommit/1000000, 2)) + 'M', IF(ABS(l.OthLineItem.minCommit) >= 1000, TEXT(ROUND(l.OthLineItem.minCommit/1000, 2)) + 'K', TEXT(ROUND(l.OthLineItem.minCommit, 2)))))}">
                                            <apex:param value="{!l.OthLineItem.minCommit}"/>
                                        </apex:outputText>
                                    </td>
                                    <td class="col-sep"></td>
                                </apex:repeat>
                            </tr>
                            <tr>
                                <td class="data-row-label">NSBD</td>
                                <td class="currency-cell">
                                    <apex:outputText value="{!IF(ABS(summaryColumns.porLineItem.nsbd ) >= 1000000000, '$ ' + TEXT(ROUND(summaryColumns.porLineItem.nsbd/1000000000, 2)) + 'G', IF(ABS(summaryColumns.porLineItem.nsbd ) >= 1000000, '$ ' + TEXT(ROUND(summaryColumns.porLineItem.nsbd/1000000, 2)) + 'M', IF(ABS(summaryColumns.porLineItem.nsbd ) >= 1000, '$ ' + TEXT(ROUND(summaryColumns.porLineItem.nsbd/1000, 2)) + 'K', '$ ' + TEXT( ROUND(summaryColumns.porLineItem.nsbd, 2)))))}">
                                        <apex:param value="{!summaryColumns.porLineItem.nsbd}"/>
                                    </apex:outputText>
                                </td>                            
                                <td class="currency-cell">
                                    <apex:outputText value="{!IF(ABS(summaryColumns.cwvLineItem.nsbd ) >= 1000000000, '$ ' + TEXT(ROUND(summaryColumns.cwvLineItem.nsbd/1000000000, 2)) + 'G', IF(ABS(summaryColumns.cwvLineItem.nsbd)  >= 1000000, '$ ' + TEXT(ROUND(summaryColumns.cwvLineItem.nsbd/1000000, 2)) + 'M', IF(ABS(summaryColumns.cwvLineItem.nsbd ) >= 1000, '$ ' + TEXT(ROUND(summaryColumns.cwvLineItem.nsbd/1000, 2)) + 'K', '$ ' + TEXT( ROUND(summaryColumns.cwvLineItem.nsbd, 2)))))}">
                                        <apex:param value="{!summaryColumns.cwvLineItem.nsbd}"/>
                                    </apex:outputText>
                                </td>
                                <td class="currency-cell">
                                    <apex:outputText value="{!IF(ABS(summaryColumns.OthLineItem.nsbd ) >= 1000000000, '$ ' + TEXT(ROUND(summaryColumns.OthLineItem.nsbd/1000000000, 2)) + 'G', IF(ABS(summaryColumns.OthLineItem.nsbd)  >= 1000000, '$ ' + TEXT(ROUND(summaryColumns.OthLineItem.nsbd/1000000, 2)) + 'M', IF(ABS(summaryColumns.OthLineItem.nsbd ) >= 1000, '$ ' + TEXT(ROUND(summaryColumns.OthLineItem.nsbd/1000, 2)) + 'K', '$ ' + TEXT( ROUND(summaryColumns.OthLineItem.nsbd, 2)))))}">
                                        <apex:param value="{!summaryColumns.OthLineItem.nsbd}"/>
                                    </apex:outputText>
                                </td>
                                <td class="col-sep"></td>
                                <apex:repeat rendered="{!summaryProductCount>1}" value="{!summaryProductColumns}" var="l" >
                                    <td class="currency-cell">
                                        <apex:outputText value="{!IF(ABS(l.porLineItem.nsbd ) >= 1000000000, '$ ' + TEXT(ROUND(l.porLineItem.nsbd/1000000000, 2)) + 'G', IF(ABS(l.porLineItem.nsbd ) >= 1000000, '$ ' + TEXT(ROUND(l.porLineItem.nsbd/1000000, 2)) + 'M', IF(ABS(l.porLineItem.nsbd ) >= 1000, '$ ' + TEXT(ROUND(l.porLineItem.nsbd/1000, 2)) + 'K', '$ ' + TEXT(ROUND( l.porLineItem.nsbd, 2)))))}">
                                            <apex:param value="{!l.porLineItem.nsbd}"/>
                                        </apex:outputText>
                                    </td>                            
                                    <td class="currency-cell">
                                        <apex:outputText value="{!IF(ABS(l.cwvLineItem.nsbd ) >= 1000000000, '$ ' + TEXT(ROUND(l.cwvLineItem.nsbd/1000000000, 2)) + 'G', IF(ABS(l.cwvLineItem.nsbd)  >= 1000000, '$ ' + TEXT(ROUND(l.cwvLineItem.nsbd/1000000, 2)) + 'M', IF(ABS(l.cwvLineItem.nsbd ) >= 1000, '$ ' + TEXT(ROUND(l.cwvLineItem.nsbd/1000, 2)) + 'K', '$ ' + TEXT(ROUND( l.cwvLineItem.nsbd, 2)))))}">
                                            <apex:param value="{!l.cwvLineItem.nsbd}"/>
                                        </apex:outputText>
                                    </td>
                                    <td class="currency-cell">
                                        <apex:outputText value="{!IF(ABS(l.OthLineItem.nsbd ) >= 1000000000, '$ ' + TEXT(ROUND(l.OthLineItem.nsbd/1000000000, 2)) + 'G', IF(ABS(l.OthLineItem.nsbd)  >= 1000000, '$ ' + TEXT(ROUND(l.OthLineItem.nsbd/1000000, 2)) + 'M', IF(ABS(l.OthLineItem.nsbd ) >= 1000, '$ ' + TEXT(ROUND(l.OthLineItem.nsbd/1000, 2)) + 'K', '$ ' + TEXT(ROUND( l.OthLineItem.nsbd, 2)))))}">
                                            <apex:param value="{!l.OthLineItem.nsbd}"/>
                                        </apex:outputText>
                                    </td>
                                    <td class="col-sep"></td>
                                </apex:repeat>
                            </tr>
                            <tr>
                                <td class="data-row-label">Total Discount</td>
                                <td class="currency-cell">
                                    <apex:outputText value="{!IF(ABS(summaryColumns.porLineItem.discount ) >= 1000000000, '$ ' + TEXT(ROUND(summaryColumns.porLineItem.discount/1000000000, 2)) + 'G', IF(ABS(summaryColumns.porLineItem.discount) >= 1000000, '$ ' + TEXT(ROUND(summaryColumns.porLineItem.discount/1000000, 2)) + 'M', IF(ABS(summaryColumns.porLineItem.discount ) >= 1000, '$ ' + TEXT(ROUND(summaryColumns.porLineItem.discount/1000, 2)) + 'K', '$ ' + TEXT( ROUND(summaryColumns.porLineItem.discount, 2)))))}">
                                        <apex:param value="{!summaryColumns.porLineItem.discount}"/>
                                    </apex:outputText>
                                </td>
                                <td class="currency-cell">
                                    <apex:outputText value="{!IF(ABS(summaryColumns.cwvLineItem.discount ) >= 1000000000, '$ ' + TEXT(ROUND(summaryColumns.cwvLineItem.discount/1000000000, 2)) + 'G', IF(ABS(summaryColumns.cwvLineItem.discount) >= 1000000, '$ ' + TEXT(ROUND(summaryColumns.cwvLineItem.discount/1000000, 2)) + 'M', IF(ABS(summaryColumns.cwvLineItem.discount ) >= 1000, '$ ' + TEXT(ROUND(summaryColumns.cwvLineItem.discount/1000, 2)) + 'K', '$ ' + TEXT( ROUND(summaryColumns.cwvLineItem.discount, 2)))))}">
                                        <apex:param value="{!summaryColumns.cwvLineItem.discount}"/>
                                    </apex:outputText>
                                </td>
                                <td class="currency-cell">
                                    <apex:outputText value="{!IF(ABS(summaryColumns.OthLineItem.discount ) >= 1000000000, '$ ' + TEXT(ROUND(summaryColumns.OthLineItem.discount/1000000000, 2)) + 'G', IF(ABS(summaryColumns.OthLineItem.discount) >= 1000000, '$ ' + TEXT(ROUND(summaryColumns.OthLineItem.discount/1000000, 2)) + 'M', IF(ABS(summaryColumns.OthLineItem.discount ) >= 1000, '$ ' + TEXT(ROUND(summaryColumns.OthLineItem.discount/1000, 2)) + 'K', '$ ' + TEXT( ROUND(summaryColumns.OthLineItem.discount, 2)))))}">
                                        <apex:param value="{!summaryColumns.OthLineItem.discount}"/>
                                    </apex:outputText>
                                </td>
                                <td class="col-sep"></td>
                                <apex:repeat rendered="{!summaryProductCount>1}" value="{!summaryProductColumns}" var="l" >
                                    <td class="currency-cell">
                                        <apex:outputText value="{!IF(ABS(l.porLineItem.discount ) >= 1000000000, '$ ' + TEXT(ROUND(l.porLineItem.discount/1000000000, 2)) + 'G', IF(ABS(l.porLineItem.discount ) >= 1000000, '$ ' + TEXT(ROUND(l.porLineItem.discount/1000000, 2)) + 'M', IF(ABS(l.porLineItem.discount ) >= 1000, '$ ' + TEXT(ROUND(l.porLineItem.discount/1000, 2)) + 'K', '$ ' + TEXT(ROUND( l.porLineItem.discount, 2)))))}">
                                            <apex:param value="{!l.porLineItem.discount}"/>
                                        </apex:outputText>
                                    </td>                            
                                    <td class="currency-cell">
                                        <apex:outputText value="{!IF(ABS(l.cwvLineItem.discount ) >= 1000000000, '$ ' + TEXT(ROUND(l.cwvLineItem.discount/1000000000, 2)) + 'G', IF(ABS(l.cwvLineItem.discount)  >= 1000000, '$ ' + TEXT(ROUND(l.cwvLineItem.discount/1000000, 2)) + 'M', IF(ABS(l.cwvLineItem.discount ) >= 1000, '$ ' + TEXT(ROUND(l.cwvLineItem.discount/1000, 2)) + 'K', '$ ' + TEXT(ROUND( l.cwvLineItem.discount, 2)))))}">
                                            <apex:param value="{!l.cwvLineItem.discount}"/>
                                        </apex:outputText>
                                    </td>
                                    <td class="currency-cell">
                                        <apex:outputText value="{!IF(ABS(l.OthLineItem.discount ) >= 1000000000, '$ ' + TEXT(ROUND(l.OthLineItem.discount/1000000000, 2)) + 'G', IF(ABS(l.OthLineItem.discount)  >= 1000000, '$ ' + TEXT(ROUND(l.OthLineItem.discount/1000000, 2)) + 'M', IF(ABS(l.OthLineItem.discount ) >= 1000, '$ ' + TEXT(ROUND(l.OthLineItem.discount/1000, 2)) + 'K', '$ ' + TEXT(ROUND( l.OthLineItem.discount, 2)))))}">
                                            <apex:param value="{!l.OthLineItem.discount}"/>
                                        </apex:outputText>
                                    </td>
                                    <td class="col-sep"></td>
                                </apex:repeat>
                            </tr>
                            <tr>
                                <td class="data-row-label">NSAD</td>
                                <td class="currency-cell">
                                    <apex:outputText value="{!IF(ABS(summaryColumns.porLineItem.nsad ) >= 1000000000, '$ ' + TEXT(ROUND(summaryColumns.porLineItem.nsad/1000000000, 2)) + 'G', IF(ABS(summaryColumns.porLineItem.nsad ) >= 1000000, '$ ' + TEXT(ROUND(summaryColumns.porLineItem.nsad/1000000, 2)) + 'M', IF(ABS(summaryColumns.porLineItem.nsad ) >= 1000, '$ ' + TEXT(ROUND(summaryColumns.porLineItem.nsad/1000, 2)) + 'K', '$ ' + TEXT(ROUND( summaryColumns.porLineItem.nsad, 2)))))}">
                                        <apex:param value="{!summaryColumns.porLineItem.nsad}"/>
                                    </apex:outputText>
                                </td>
                                <td class="currency-cell">
                                    <apex:outputText value="{!IF(ABS(summaryColumns.cwvLineItem.nsad ) >= 1000000000, '$ ' + TEXT(ROUND(summaryColumns.cwvLineItem.nsad/1000000000, 2)) + 'G', IF(ABS(summaryColumns.cwvLineItem.nsad) >= 1000000, '$ ' + TEXT(ROUND(summaryColumns.cwvLineItem.nsad/1000000, 2)) + 'M', IF(ABS(summaryColumns.cwvLineItem.nsad ) >= 1000, '$ ' + TEXT(ROUND(summaryColumns.cwvLineItem.nsad/1000, 2)) + 'K', '$ ' + TEXT( ROUND(summaryColumns.cwvLineItem.nsad, 2)))))}">
                                        <apex:param value="{!summaryColumns.cwvLineItem.nsad}"/>
                                    </apex:outputText>
                                </td>
                                <td class="currency-cell">
                                    <apex:outputText value="{!IF(ABS(summaryColumns.OthLineItem.nsad ) >= 1000000000, '$ ' + TEXT(ROUND(summaryColumns.OthLineItem.nsad/1000000000, 2)) + 'G', IF(ABS(summaryColumns.OthLineItem.nsad) >= 1000000, '$ ' + TEXT(ROUND(summaryColumns.OthLineItem.nsad/1000000, 2)) + 'M', IF(ABS(summaryColumns.OthLineItem.nsad ) >= 1000, '$ ' + TEXT(ROUND(summaryColumns.OthLineItem.nsad/1000, 2)) + 'K', '$ ' + TEXT( ROUND(summaryColumns.OthLineItem.nsad, 2)))))}">
                                        <apex:param value="{!summaryColumns.OthLineItem.nsad}"/>
                                    </apex:outputText>
                                </td>
                                <td class="col-sep"></td>
                                <apex:repeat rendered="{!summaryProductCount>1}" value="{!summaryProductColumns}" var="l" >
                                    <td class="currency-cell">
                                        <apex:outputText value="{!IF(ABS(l.porLineItem.nsad ) >= 1000000000, '$ ' + TEXT(ROUND(l.porLineItem.nsad/1000000000, 2)) + 'G', IF(ABS(l.porLineItem.nsad ) >= 1000000, '$ ' + TEXT(ROUND(l.porLineItem.nsad/1000000, 2)) + 'M', IF(ABS(l.porLineItem.nsad ) >= 1000, '$ ' + TEXT(ROUND(l.porLineItem.nsad/1000, 2)) + 'K', '$ ' + TEXT(ROUND( l.porLineItem.nsad, 2)))))}">
                                            <apex:param value="{!l.porLineItem.nsad}"/>
                                        </apex:outputText>
                                    </td>
                                    <td class="currency-cell">
                                        <apex:outputText value="{!IF(ABS(l.cwvLineItem.nsad ) >= 1000000000, '$ ' + TEXT(ROUND(l.cwvLineItem.nsad/1000000000, 2)) + 'G', IF(ABS(l.cwvLineItem.nsad) >= 1000000, '$ ' + TEXT(ROUND(l.cwvLineItem.nsad/1000000, 2)) + 'M', IF(ABS(l.cwvLineItem.nsad ) >= 1000, '$ ' + TEXT(ROUND(l.cwvLineItem.nsad/1000, 2)) + 'K', '$ ' + TEXT(ROUND( l.cwvLineItem.nsad, 2)))))}">
                                            <apex:param value="{!l.cwvLineItem.nsad}"/>
                                        </apex:outputText>
                                    </td>
                                    <td class="currency-cell">
                                        <apex:outputText value="{!IF(ABS(l.OthLineItem.nsad ) >= 1000000000, '$ ' + TEXT(ROUND(l.OthLineItem.nsad/1000000000, 2)) + 'G', IF(ABS(l.OthLineItem.nsad) >= 1000000, '$ ' + TEXT(ROUND(l.OthLineItem.nsad/1000000, 2)) + 'M', IF(ABS(l.OthLineItem.nsad ) >= 1000, '$ ' + TEXT(ROUND(l.OthLineItem.nsad/1000, 2)) + 'K', '$ ' + TEXT(ROUND( l.OthLineItem.nsad, 2)))))}">
                                            <apex:param value="{!l.OthLineItem.nsad}"/>
                                        </apex:outputText>
                                    </td>
                                    <td class="col-sep"></td>
                                </apex:repeat>
                            </tr>
                            <tr>
                                <td class="data-row-label">Gross Margin</td>
                                <td class="currency-cell">
                                    <apex:outputText value="{!IF(ABS(summaryColumns.porLineItem.grossMargin ) >= 1000000000, '$ ' + TEXT(ROUND(summaryColumns.porLineItem.grossMargin/1000000000, 2)) + 'G', IF(ABS(summaryColumns.porLineItem.grossMargin) >= 1000000, '$ ' + TEXT(ROUND(summaryColumns.porLineItem.grossMargin/1000000, 2)) + 'M', IF(ABS(summaryColumns.porLineItem.grossMargin ) >= 1000, '$ ' + TEXT(ROUND(summaryColumns.porLineItem.grossMargin/1000, 2)) + 'K', '$ ' + TEXT( ROUND(summaryColumns.porLineItem.grossMargin, 2)))))}">
                                        <apex:param value="{!summaryColumns.porLineItem.grossMargin}"/>
                                    </apex:outputText>
                                </td>
                                <td class="currency-cell">
                                    <apex:outputText value="{!IF(ABS(summaryColumns.cwvLineItem.grossMargin ) >= 1000000000, '$ ' + TEXT(ROUND(summaryColumns.cwvLineItem.grossMargin/1000000000, 2)) + 'G', IF(ABS(summaryColumns.cwvLineItem.grossMargin) >= 1000000, '$ ' + TEXT(ROUND(summaryColumns.cwvLineItem.grossMargin/1000000, 2)) + 'M', IF(ABS(summaryColumns.cwvLineItem.grossMargin ) >= 1000, '$ ' + TEXT(ROUND(summaryColumns.cwvLineItem.grossMargin/1000, 2)) + 'K', '$ ' + TEXT( ROUND(summaryColumns.cwvLineItem.grossMargin, 2)))))}">
                                        <apex:param value="{!summaryColumns.cwvLineItem.grossMargin}"/>
                                    </apex:outputText>
                                </td>
                                <td class="currency-cell">
                                    <apex:outputText value="{!IF(ABS(summaryColumns.OthLineItem.grossMargin ) >= 1000000000, '$ ' + TEXT(ROUND(summaryColumns.OthLineItem.grossMargin/1000000000, 2)) + 'G', IF(ABS(summaryColumns.OthLineItem.grossMargin) >= 1000000, '$ ' + TEXT(ROUND(summaryColumns.OthLineItem.grossMargin/1000000, 2)) + 'M', IF(ABS(summaryColumns.OthLineItem.grossMargin ) >= 1000, '$ ' + TEXT(ROUND(summaryColumns.OthLineItem.grossMargin/1000, 2)) + 'K', '$ ' + TEXT( ROUND(summaryColumns.OthLineItem.grossMargin, 2)))))}">
                                        <apex:param value="{!summaryColumns.OthLineItem.grossMargin}"/>
                                    </apex:outputText>
                                </td>
                                <td class="col-sep"></td>
                                <apex:repeat rendered="{!summaryProductCount>1}" value="{!summaryProductColumns}" var="l" >
                                    <td class="currency-cell">
                                        <apex:outputText value="{!IF(ABS(l.porLineItem.grossMargin ) >= 1000000000, '$ ' + TEXT(ROUND(l.porLineItem.grossMargin/1000000000, 2)) + 'G', IF(ABS(l.porLineItem.grossMargin) >= 1000000, '$ ' + TEXT(ROUND(l.porLineItem.grossMargin/1000000, 2)) + 'M', IF(ABS(l.porLineItem.grossMargin ) >= 1000, '$ ' + TEXT(ROUND(l.porLineItem.grossMargin/1000, 2)) + 'K', '$ ' + TEXT(ROUND( l.porLineItem.grossMargin, 2)))))}">
                                            <apex:param value="{!l.porLineItem.grossMargin}"/>
                                        </apex:outputText>
                                    </td>
                                    <td class="currency-cell">
                                        <apex:outputText value="{!IF(ABS(l.cwvLineItem.grossMargin ) >= 1000000000, '$ ' + TEXT(ROUND(l.cwvLineItem.grossMargin/1000000000, 2)) + 'G', IF(ABS(l.cwvLineItem.grossMargin) >= 1000000, '$ ' + TEXT(ROUND(l.cwvLineItem.grossMargin/1000000, 2)) + 'M', IF(ABS(l.cwvLineItem.grossMargin ) >= 1000, '$ ' + TEXT(ROUND(l.cwvLineItem.grossMargin/1000, 2)) + 'K', '$ ' + TEXT(ROUND( l.cwvLineItem.grossMargin, 2)))))}">
                                            <apex:param value="{!l.cwvLineItem.grossMargin}"/>
                                        </apex:outputText>
                                    </td>
                                    <td class="currency-cell">
                                        <apex:outputText value="{!IF(ABS(l.OthLineItem.grossMargin ) >= 1000000000, '$ ' + TEXT(ROUND(l.OthLineItem.grossMargin/1000000000, 2)) + 'G', IF(ABS(l.OthLineItem.grossMargin) >= 1000000, '$ ' + TEXT(ROUND(l.OthLineItem.grossMargin/1000000, 2)) + 'M', IF(ABS(l.OthLineItem.grossMargin ) >= 1000, '$ ' + TEXT(ROUND(l.OthLineItem.grossMargin/1000, 2)) + 'K', '$ ' + TEXT(ROUND( l.OthLineItem.grossMargin, 2)))))}">
                                            <apex:param value="{!l.OthLineItem.grossMargin}"/>
                                        </apex:outputText>
                                    </td>
                                    <td class="col-sep"></td>
                                </apex:repeat>
                            </tr>
                            
                            <tr>
                                <td class="data-row-label">GM%</td>
                                <td class="currency-cell">
                                    <apex:outputText value="{0,number,###,##0.00%}">
                                        <apex:param value="{!summaryColumns.porLineItem.totalGMPercentage}"/>
                                    </apex:outputText>
                                </td>
                                <td class="currency-cell">
                                    <apex:outputText value="{0,number,###,##0.00%}">
                                        <apex:param value="{!summaryColumns.cwvLineItem.totalGMPercentage}"/>
                                    </apex:outputText>
                                </td>
                                <td class="currency-cell">
                                    <apex:outputText value="{0,number,###,##0.00%}">
                                        <apex:param value="{!summaryColumns.othLineItem.totalGMPercentage}"/>
                                    </apex:outputText>
                                </td>
                                <td class="col-sep"></td>
                                <apex:repeat rendered="{!summaryProductCount>1}" value="{!summaryProductColumns}" var="l" >
                                    <td class="currency-cell">
                                        <apex:outputText value="{0,number,###,##0.00%}">
                                            <apex:param value="{!l.porLineItem.gm}"/>
                                        </apex:outputText>
                                    </td>
                                    <td class="currency-cell">
                                        <apex:outputText value="{0,number,###,##0.00%}">
                                            <apex:param value="{!l.cwvLineItem.gm}"/>
                                        </apex:outputText>
                                    </td>
                                    <td class="currency-cell">
                                        <apex:outputText value="{0,number,###,##0.00%}">
                                            <apex:param value="{!l.othLineItem.gm}"/>
                                        </apex:outputText>
                                    </td>
                                    <td class="col-sep"></td>
                                </apex:repeat>
                            </tr>                       
                            <tr>
                                <td class="data-row-label">A&amp;P</td>
                                <td class="currency-cell">
                                    <apex:outputText value="{!IF(ABS(summaryColumns.porLineItem.aAndP ) >= 1000000000, '$ ' + TEXT(ROUND(summaryColumns.porLineItem.aAndP/1000000000, 2)) + 'G', IF(ABS(summaryColumns.porLineItem.aAndP) >= 1000000, '$ ' + TEXT(ROUND(summaryColumns.porLineItem.aAndP/1000000, 2)) + 'M', IF(ABS(summaryColumns.porLineItem.aAndP ) >= 1000, '$ ' + TEXT(ROUND(summaryColumns.porLineItem.aAndP/1000, 2)) + 'K', '$ ' + TEXT(ROUND( summaryColumns.porLineItem.aAndP, 2)))))}">
                                        <apex:param value="{!summaryColumns.porLineItem.aAndP}"/>
                                    </apex:outputText>
                                </td>
                                <td class="currency-cell">
                                    <apex:outputText value="{!IF(ABS(summaryColumns.cwvLineItem.aAndP ) >= 1000000000, '$ ' + TEXT(ROUND(summaryColumns.cwvLineItem.aAndP/1000000000, 2)) + 'G', IF(ABS(summaryColumns.cwvLineItem.aAndP) >= 1000000, '$ ' + TEXT(ROUND(summaryColumns.cwvLineItem.aAndP/1000000, 2)) + 'M', IF(ABS(summaryColumns.cwvLineItem.aAndP ) >= 1000, '$ ' + TEXT(ROUND(summaryColumns.cwvLineItem.aAndP/1000, 2)) + 'K', '$ ' + TEXT( ROUND(summaryColumns.cwvLineItem.aAndP, 2)))))}">
                                        <apex:param value="{!summaryColumns.cwvLineItem.aAndP}"/>
                                    </apex:outputText>
                                </td>
                                <td class="currency-cell">
                                    <apex:outputText value="{!IF(ABS(summaryColumns.OthLineItem.aAndP ) >= 1000000000, '$ ' + TEXT(ROUND(summaryColumns.OthLineItem.aAndP/1000000000, 2)) + 'G', IF(ABS(summaryColumns.OthLineItem.aAndP) >= 1000000, '$ ' + TEXT(ROUND(summaryColumns.OthLineItem.aAndP/1000000, 2)) + 'M', IF(ABS(summaryColumns.OthLineItem.aAndP ) >= 1000, '$ ' + TEXT(ROUND(summaryColumns.OthLineItem.aAndP/1000, 2)) + 'K', '$ ' + TEXT( ROUND(summaryColumns.OthLineItem.aAndP, 2)))))}">
                                        <apex:param value="{!summaryColumns.OthLineItem.aAndP}"/>
                                    </apex:outputText>
                                </td>
                                <td class="col-sep"></td>
                                <apex:repeat rendered="{!summaryProductCount>1}" value="{!summaryProductColumns}" var="l" >
                                    <td class="currency-cell">
                                        <apex:outputText value="{!IF(ABS(l.porLineItem.aAndP ) >= 1000000000, '$ ' + TEXT(ROUND(l.porLineItem.aAndP/1000000000, 2)) + 'G', IF(ABS(l.porLineItem.aAndP) >= 1000000, '$ ' + TEXT(ROUND(l.porLineItem.aAndP/1000000, 2)) + 'M', IF(ABS(l.porLineItem.aAndP ) >= 1000, '$ ' + TEXT(ROUND(l.porLineItem.aAndP/1000, 2)) + 'K', '$ ' + TEXT(ROUND( l.porLineItem.aAndP, 2)))))}">
                                            <apex:param value="{!l.porLineItem.aAndP}"/>
                                        </apex:outputText>
                                    </td>
                                    <td class="currency-cell">
                                        <apex:outputText value="{!IF(ABS(l.cwvLineItem.aAndP ) >= 1000000000, '$ ' + TEXT(ROUND(l.cwvLineItem.aAndP/1000000000, 2)) + 'G', IF(ABS(l.cwvLineItem.aAndP) >= 1000000, '$ ' + TEXT(ROUND(l.cwvLineItem.aAndP/1000000, 2)) + 'M', IF(ABS(l.cwvLineItem.aAndP ) >= 1000, '$ ' + TEXT(ROUND(l.cwvLineItem.aAndP/1000, 2)) + 'K', '$ ' + TEXT(ROUND( l.cwvLineItem.aAndP, 2)))))}">
                                            <apex:param value="{!l.cwvLineItem.aAndP}"/>
                                        </apex:outputText>
                                    </td>
                                    <td class="currency-cell">
                                        <apex:outputText value="{!IF(ABS(l.OthLineItem.aAndP ) >= 1000000000, '$ ' + TEXT(ROUND(l.OthLineItem.aAndP/1000000000, 2)) + 'G', IF(ABS(l.OthLineItem.aAndP) >= 1000000, '$ ' + TEXT(ROUND(l.OthLineItem.aAndP/1000000, 2)) + 'M', IF(ABS(l.OthLineItem.aAndP ) >= 1000, '$ ' + TEXT(ROUND(l.OthLineItem.aAndP/1000, 2)) + 'K', '$ ' + TEXT(ROUND( l.OthLineItem.aAndP, 2)))))}">
                                            <apex:param value="{!l.OthLineItem.aAndP}"/>
                                        </apex:outputText>
                                    </td>
                                    <td class="col-sep"></td>
                                </apex:repeat>
                            </tr>
                            <tr>
                                <td class="data-row-label">Motoagents</td>
                                <td class="currency-cell">
                                    <apex:outputText value="{!IF(ABS(summaryColumns.porLineItem.motoagents ) >= 1000000000, '$ ' + TEXT(ROUND(summaryColumns.porLineItem.motoagents/1000000000, 2)) + 'G', IF(ABS(summaryColumns.porLineItem.motoagents) >= 1000000, '$ ' + TEXT(ROUND(summaryColumns.porLineItem.motoagents/1000000, 2)) + 'M', IF(ABS(summaryColumns.porLineItem.motoagents ) >= 1000, '$ ' + TEXT(ROUND(summaryColumns.porLineItem.motoagents/1000, 2)) + 'K', '$ ' + TEXT( ROUND(summaryColumns.porLineItem.motoagents, 2)))))}">
                                        <apex:param value="{!summaryColumns.porLineItem.motoagents}"/>
                                    </apex:outputText>
                                </td>
                                <td class="currency-cell">
                                    <apex:outputText value="{!IF(ABS(summaryColumns.cwvLineItem.motoagents ) >= 1000000000, '$ ' + TEXT(ROUND(summaryColumns.cwvLineItem.motoagents/1000000000, 2)) + 'G', IF(ABS(summaryColumns.cwvLineItem.motoagents) >= 1000000, '$ ' + TEXT(ROUND(summaryColumns.cwvLineItem.motoagents/1000000, 2)) + 'M', IF(ABS(summaryColumns.cwvLineItem.motoagents ) >= 1000, '$ ' + TEXT(ROUND(summaryColumns.cwvLineItem.motoagents/1000, 2)) + 'K', '$ ' + TEXT( ROUND(summaryColumns.cwvLineItem.motoagents, 2)))))}">
                                        <apex:param value="{!summaryColumns.cwvLineItem.motoagents}"/>
                                    </apex:outputText>
                                </td>
                                <td class="currency-cell">
                                    <apex:outputText value="{!IF(ABS(summaryColumns.OthLineItem.motoagents ) >= 1000000000, '$ ' + TEXT(ROUND(summaryColumns.OthLineItem.motoagents/1000000000, 2)) + 'G', IF(ABS(summaryColumns.OthLineItem.motoagents) >= 1000000, '$ ' + TEXT(ROUND(summaryColumns.OthLineItem.motoagents/1000000, 2)) + 'M', IF(ABS(summaryColumns.OthLineItem.motoagents ) >= 1000, '$ ' + TEXT(ROUND(summaryColumns.OthLineItem.motoagents/1000, 2)) + 'K', '$ ' + TEXT( ROUND(summaryColumns.OthLineItem.motoagents, 2)))))}">
                                        <apex:param value="{!summaryColumns.OthLineItem.motoagents}"/>
                                    </apex:outputText>
                                </td>
                                <td class="col-sep"></td>
                                <apex:repeat rendered="{!summaryProductCount>1}" value="{!summaryProductColumns}" var="l" >
                                    <td class="currency-cell">
                                        <apex:outputText value="{!IF(ABS(l.porLineItem.motoagents ) >= 1000000000, '$ ' + TEXT(ROUND(l.porLineItem.motoagents/1000000000, 2)) + 'G', IF(ABS(l.porLineItem.motoagents) >= 1000000, '$ ' + TEXT(ROUND(l.porLineItem.motoagents/1000000, 2)) + 'M', IF(ABS(l.porLineItem.motoagents ) >= 1000, '$ ' + TEXT(ROUND(l.porLineItem.motoagents/1000, 2)) + 'K', '$ ' + TEXT(ROUND( l.porLineItem.motoagents, 2)))))}">
                                            <apex:param value="{!l.porLineItem.motoagents}"/>
                                        </apex:outputText>
                                    </td>
                                    <td class="currency-cell">
                                        <apex:outputText value="{!IF(ABS(l.cwvLineItem.motoagents ) >= 1000000000, '$ ' + TEXT(ROUND(l.cwvLineItem.motoagents/1000000000, 2)) + 'G', IF(ABS(l.cwvLineItem.motoagents) >= 1000000, '$ ' + TEXT(ROUND(l.cwvLineItem.motoagents/1000000, 2)) + 'M', IF(ABS(l.cwvLineItem.motoagents ) >= 1000, '$ ' + TEXT(ROUND(l.cwvLineItem.motoagents/1000, 2)) + 'K', '$ ' + TEXT(ROUND( l.cwvLineItem.motoagents, 2)))))}">
                                            <apex:param value="{!l.cwvLineItem.motoagents}"/>
                                        </apex:outputText>
                                    </td>
                                    <td class="currency-cell">
                                        <apex:outputText value="{!IF(ABS(l.OthLineItem.motoagents ) >= 1000000000, '$ ' + TEXT(ROUND(l.OthLineItem.motoagents/1000000000, 2)) + 'G', IF(ABS(l.OthLineItem.motoagents) >= 1000000, '$ ' + TEXT(ROUND(l.OthLineItem.motoagents/1000000, 2)) + 'M', IF(ABS(l.OthLineItem.motoagents ) >= 1000, '$ ' + TEXT(ROUND(l.OthLineItem.motoagents/1000, 2)) + 'K', '$ ' + TEXT(ROUND( l.OthLineItem.motoagents, 2)))))}">
                                            <apex:param value="{!l.OthLineItem.motoagents}"/>
                                        </apex:outputText>
                                    </td>
                                    <td class="col-sep"></td>
                                </apex:repeat>
                            </tr>
                            <tr>
                                <td class="data-row-label">Contribution Margin</td>
                                <td class="currency-cell">
                                    <apex:outputText value="{!IF(ABS(summaryColumns.porLineItem.contributionMargin ) >= 1000000000, '$ ' + TEXT(ROUND(summaryColumns.porLineItem.contributionMargin/1000000000, 2)) + 'G', IF(ABS(summaryColumns.porLineItem.contributionMargin) >= 1000000, '$ ' + TEXT(ROUND(summaryColumns.porLineItem.contributionMargin/1000000, 2)) + 'M', IF(ABS(summaryColumns.porLineItem.contributionMargin ) >= 1000, '$ ' + TEXT(ROUND(summaryColumns.porLineItem.contributionMargin/1000, 2)) + 'K', '$ ' + TEXT(ROUND( summaryColumns.porLineItem.contributionMargin, 2)))))}">
                                        <apex:param value="{!summaryColumns.porLineItem.contributionMargin}"/>
                                    </apex:outputText>
                                </td>
                                <td class="currency-cell">
                                    <apex:outputText value="{!IF(ABS(summaryColumns.cwvLineItem.contributionMargin ) >= 1000000000, '$ ' + TEXT(ROUND(summaryColumns.cwvLineItem.contributionMargin/1000000000, 2)) + 'G', IF(ABS(summaryColumns.cwvLineItem.contributionMargin) >= 1000000, '$ ' + TEXT(ROUND(summaryColumns.cwvLineItem.contributionMargin/1000000, 2)) + 'M', IF(ABS(summaryColumns.cwvLineItem.contributionMargin ) >= 1000, '$ ' + TEXT(ROUND(summaryColumns.cwvLineItem.contributionMargin/1000, 2)) + 'K', '$ ' + TEXT( ROUND(summaryColumns.cwvLineItem.contributionMargin, 2)))))}">
                                        <apex:param value="{!summaryColumns.cwvLineItem.contributionMargin}"/>
                                    </apex:outputText>
                                </td>
                                <td class="currency-cell">
                                    <apex:outputText value="{!IF(ABS(summaryColumns.OthLineItem.contributionMargin ) >= 1000000000, '$ ' + TEXT(ROUND(summaryColumns.OthLineItem.contributionMargin/1000000000, 2)) + 'G', IF(ABS(summaryColumns.OthLineItem.contributionMargin) >= 1000000, '$ ' + TEXT(ROUND(summaryColumns.OthLineItem.contributionMargin/1000000, 2)) + 'M', IF(ABS(summaryColumns.OthLineItem.contributionMargin ) >= 1000, '$ ' + TEXT(ROUND(summaryColumns.OthLineItem.contributionMargin/1000, 2)) + 'K', '$ ' + TEXT( ROUND(summaryColumns.OthLineItem.contributionMargin, 2)))))}">
                                        <apex:param value="{!summaryColumns.OthLineItem.contributionMargin}"/>
                                    </apex:outputText>
                                </td>
                                <td class="col-sep"></td>
                                <apex:repeat rendered="{!summaryProductCount>1}" value="{!summaryProductColumns}" var="l" >
                                    <td class="currency-cell">
                                        <apex:outputText value="{!IF(ABS(l.porLineItem.contributionMargin ) >= 1000000000, '$ ' + TEXT(ROUND(l.porLineItem.contributionMargin/1000000000, 2)) + 'G', IF(ABS(l.porLineItem.contributionMargin) >= 1000000, '$ ' + TEXT(ROUND(l.porLineItem.contributionMargin/1000000, 2)) + 'M', IF(ABS(l.porLineItem.contributionMargin ) >= 1000, '$ ' + TEXT(ROUND(l.porLineItem.contributionMargin/1000, 2)) + 'K', '$ ' + TEXT(ROUND( l.porLineItem.contributionMargin, 2)))))}">
                                            <apex:param value="{!l.porLineItem.contributionMargin}"/>
                                        </apex:outputText>
                                    </td>
                                    <td class="currency-cell">
                                        <apex:outputText value="{!IF(ABS(l.cwvLineItem.contributionMargin ) >= 1000000000, '$ ' + TEXT(ROUND(l.cwvLineItem.contributionMargin/1000000000, 2)) + 'G', IF(ABS(l.cwvLineItem.contributionMargin) >= 1000000, '$ ' + TEXT(ROUND(l.cwvLineItem.contributionMargin/1000000, 2)) + 'M', IF(ABS(l.cwvLineItem.contributionMargin ) >= 1000, '$ ' + TEXT(ROUND(l.cwvLineItem.contributionMargin/1000, 2)) + 'K', '$ ' + TEXT(ROUND( l.cwvLineItem.contributionMargin, 2)))))}">
                                            <apex:param value="{!l.cwvLineItem.contributionMargin}"/>
                                        </apex:outputText>
                                    </td>
                                    <td class="currency-cell">
                                        <apex:outputText value="{!IF(ABS(l.OthLineItem.contributionMargin ) >= 1000000000, '$ ' + TEXT(ROUND(l.OthLineItem.contributionMargin/1000000000, 2)) + 'G', IF(ABS(l.OthLineItem.contributionMargin) >= 1000000, '$ ' + TEXT(ROUND(l.OthLineItem.contributionMargin/1000000, 2)) + 'M', IF(ABS(l.OthLineItem.contributionMargin ) >= 1000, '$ ' + TEXT(ROUND(l.OthLineItem.contributionMargin/1000, 2)) + 'K', '$ ' + TEXT(ROUND( l.OthLineItem.contributionMargin, 2)))))}">
                                            <apex:param value="{!l.OthLineItem.contributionMargin}"/>
                                        </apex:outputText>
                                    </td>
                                    <td class="col-sep"></td>
                                </apex:repeat>
                            </tr>
                            <tr>
                                <td class="data-row-label">CM%</td>
                                <td class="currency-cell">
                                    <apex:outputText value="{0,number,###,##0.00%}">
                                        <apex:param value="{!summaryColumns.porLineItem.totalCMPercentage}"/>
                                    </apex:outputText>
                                </td>
                                <td class="currency-cell">
                                    <apex:outputText value="{0,number,###,##0.00%}">
                                        <apex:param value="{!summaryColumns.cwvLineItem.totalCMPercentage}"/>
                                    </apex:outputText>
                                </td>
                                <td class="currency-cell">
                                    <apex:outputText value="{0,number,###,##0.00%}">
                                        <apex:param value="{!summaryColumns.OthLineItem.totalCMPercentage}"/>
                                    </apex:outputText>
                                </td>
                                <td class="col-sep"></td>
                                <apex:repeat rendered="{!summaryProductCount>1}" value="{!summaryProductColumns}" var="l" >
                                    <td class="currency-cell">
                                    <apex:outputText value="{0,number,###,##0.00%}">
                                        <apex:param value="{!l.porLineItem.cm}"/>
                                    </apex:outputText>
                                </td>
                                <td class="currency-cell">
                                    <apex:outputText value="{0,number,###,##0.00%}">
                                        <apex:param value="{!l.cwvLineItem.cm}"/>
                                    </apex:outputText>
                                </td>
                                <td class="currency-cell">
                                    <apex:outputText value="{0,number,###,##0.00%}">
                                        <apex:param value="{!l.OthLineItem.cm}"/>
                                    </apex:outputText>
                                </td>
                                    <td class="col-sep"></td>
                                </apex:repeat>
                            </tr>
                        </table>
                        <!-- SUMMARY NOTES SECTION -->
                            <table>
                                <tr>
                                    <td class="section-header" colspan="{!1+(4*lineItemCount)+(4*totalItemCount)}" style="font-weight:bold;font-size:1.2em;text-transform:uppercase;border-bottom:1px solid #000;padding-top: 20px;">Summary Notes</td>
                                </tr>
                            </table>
                            <apex:repeat value="{!summaryNotes}" var="summaryNote">
                                <table>
                                    <tr>
                                        <td>
                                            <apex:outputText value="Created By: {!summaryNote.Owner.FirstName + ' ' + summaryNote.Owner.LastName}">
                                            </apex:outputText>
                                        </td>
                                        <td>
                                            <apex:outputText value="Title: {!summaryNote.Title}"/>
                                        </td>
                                        <td>
                                            <apex:outputPanel id="notesPanel">
                                                <apex:outputText value="Date Created:"></apex:outputText> 
                                                <apex:outputText value="{0, date, MMMM d','  yyyy}">
                                                    <apex:param value="{!summaryNote.CreatedDate}" />
                                                </apex:outputText>
                                            </apex:outputPanel>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td colspan='4' class='notesPadding'>
                                           <apex:outputText value="{!summaryNote.Body}"></apex:outputText>
                                        </td>
                                    </tr>
                                </table>
                            </apex:repeat>
         </apex:outputPanel>
</apex:page>
<apex:page tabStyle="Opportunity" controller="DealViewController" contentType="{!customRender}" standardStylesheets="true">
    
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"> 
    </script>
    <link rel="stylesheet" href="{!IF(Not(isExcelRender),'//code.jquery.com/ui/1.11.1/themes/smoothness/jquery-ui.css','#')}"/>

    <style>
        .dataTable {border-collapse:collapse;}
        .dataTable td {padding:2px 2px 2px 2px;}
        .section-header {font-weight:bold;font-size:1.2em;text-transform:uppercase;border-bottom:1px solid #000;}
        .section-header.operator{padding-top: 20px;}
        .prod-header {font-weight:bold;text-align:center;font-size:1.2em;line-height: 26px;}
        .prod-sub-header {font-weight:bold;text-align:center; border-bottom:1px solid #000;}
        .currency-cell {text-align:right;width:80px;}
        .currency-cell-single-underscore .inlineEditDiv input,
        .currency-cell .inlineEditDiv input{width:60px !important;}
        .inlineEditWrite{background-color: #DAF3FF;}
        .data-row-label {font-weight:bold; min-width:90px;}
        .data-row-sub-label {font-weight:bold ;font-size:.95em;padding-left:10px; min-width:90px;}
        .blank-row {height:25px;}
        .notesStyle{border: 2px solid #e5c130;}
        .notesPanel{float:right;}
        .notesPadding{padding-bottom: 33px;}
        #notesTabPanel{margin-bottom: 23px;}
        
        .hiddenButtons{width: 24%;margin: 0 auto;display: inline;margin-left: 38%;}
        .pad-top td {padding-top:20px;}
        .col-sep {width:9px;}
        
        
        .single-underscore td {border-bottom:1px solid #000;}
        .double-underscore td {border-bottom:3px double #000;}
          
        
        #filter-fields {padding:0;margin:0;list-style:none;}
        #filter-fields li {margin:0 5px 0 0; padding:0; float:left;}    
        #filter-fields li label {display:block; font-weight:bold; padding-bottom:3px;}
        
        .pager {display:block;padding:8px; text-align:center;}
        .page-count {margin:0 20px;}
        .disabled-text {color:#ccc;}
        
        .spinner-16 {display:block; height:16px; width:16px; background:url('/img/loading.gif');}
        
        .overflow {max-height:400px; overflow:auto; border-color:#E0E3E5; border-style:solid; border-width:1px 0 1px 0;}
        
        .clear-floats {clear:both;}
        
        .multilist {min-width:200px;}

    </style>
    <apex:sectionHeader rendered="{!Not(isExcelRender)}" title="{!thisQuote.Name}" subtitle="Deal Products" />
    <apex:outputLink value="/{!recId}" target="_blank" rendered="{!Not(isExcelRender)}">Click For Quote Details {!thisQuote.Name}</apex:outputLink>
    
    <c:ModalWaitingSpinner title="" message=""/>
        <apex:form enctype="multipart/form-data">
        <apex:pageBlock title="Select Product" id="optionBlock" rendered="{!Not(isExcelRender) && hasProducts}">
            <apex:outputPanel id="multiSelectPanel">
                <c:Multiselect leftLabel="Available Products" leftOptionsAttr="{!availableOptions}" rightLabel="Selected Products" rightOptionsAttr="{!selectedOptions}" size="8" width="auto" />
            </apex:outputPanel>
            <apex:pageBlockButtons location="top">
                <apex:commandButton value="View Deal Products" action="{!loadTable}" onclick="setTitle('Please Wait');setMessage('Getting Products...');showModal();" oncomplete="hideModal();checkList();checkFormulaError();" reRender="tablePanel" />
                <apex:OutputLabel id="quoteStatusId" value="DEAL STATUS: {!quoteStatus.Status}"/> 
            </apex:pageBlockButtons>
            <apex:pageMessages id="showmsg"></apex:pageMessages>
        </apex:pageBlock>
        </apex:form>
        <apex:outputPanel id="tablePanel">
            <apex:form enctype="multipart/form-data">
            <apex:pageBlock mode="inlineEdit" rendered="{!isTableVisible}">
                <apex:pageBlockButtons location="top" rendered="{!NOT(isVisible) && Not(isExcelRender)}"> 
                    <apex:commandButton id="btnAddDeal" value="Add Deal Product" action="{!setDisplayPanelVisibility}" rendered="{!Not(inApprovalProccess)}"/>
                    <apex:commandButton id="btnCancel" immediate="true" value="Discard Changes" action="{!getProducts}" onclick="setTitle('Please Wait');setMessage('Discarding Changes...');showModal()" oncomplete="hideModal()" reRender="tablePanel" rendered="{!Not(inApprovalProccess)}"/>
                    <apex:commandButton id="btnSaveChanges" value="Save Changes" action="{!saveChanges}" onclick="setTitle('Please Wait');setMessage('Saving Changes...');showModal()" oncomplete="hideModal()" reRender="tablePanel" rendered="{!Not(inApprovalProccess)}"/>
                    <apex:commandButton id="btnExport" value="Export to Excel" action="{!exportToExcel}" />                    
                    <input type="button" id="btnEditAll" value="Edit All" class="btn" reRender="none" style="{!IF(Not(inApprovalProccess),'display:inline;','display:none;')}"/>
                    <apex:commandButton action="{!attachmentsPopUp}" value="Attachment" rendered="{!Not(inApprovalProccess)}" onclick="setTitle('Please Wait');setMessage('Opening...');showModal();" oncomplete="hideModal();" rerender="Attachmentsresults"/>
                    <apex:commandButton action="{!notesPopUp}" value="Notes" rendered="{!Not(inApprovalProccess)}" onclick="setTitle('Please Wait');setMessage('Opening New Note...');showModal();" oncomplete="hideModal();" rerender="results"/>
                    <apex:commandButton action="{!approvalProcess}" value="Submit for Approval" rendered="{!Not(inApprovalProccess)}"/>
                    <apex:commandButton action="{!recallProcess}" value="Recall Approval Request" rendered="{!submitterWorkItems}"/>
                    <apex:commandButton action="{!acceptWorkItem}" value="Approve" rendered="{!hasWorkItems}"/>
                    <apex:commandButton action="{!rejectWorkItem}" value="Reject" rendered="{!hasWorkItems}"/>
                </apex:pageBlockButtons>
                <!-- BEGIN ADD PRODUCTS -->
                <apex:outputPanel rendered="{!displayPanel || NOT(hasProducts)}" id="productsAddArea">
                    <div id="newProdForm">
                        <!-- PRODUCT QUEUE AREA -->
                         <apex:pageBlock tabStyle="Product2" title="Products Queue" rendered="{!productsQueue.size > 0}" id="productQueueBlock">
                          <apex:inputTextarea style="width:600px;height:200px;" rendered="{!IF(ISNULL(feedbackMsg),false,true) }" value="{!feedbackMsg}" />
                                <apex:pageBlockButtons location="top">
                                    <apex:commandButton id="btnSaveProduct" value="Save Products to Deal" action="{!createLineItemsFromQueue}" onclick="setTitle('Please Wait');setMessage('Saving Products to Deal...');showModal();" oncomplete="hideModal();alignDealStatus();" reRender="optionBlock,productsAddArea"/>
                                    <apex:commandButton id="btnRemoveProduct" value="Remove Selected" action="{!removeProductsFromQueue}" reRender="productQueueBlock" onclick="setTitle('Please Wait');setMessage('Removing Products from Queue...');showModal();" oncomplete="hideModal();"/>
                                </apex:pageBlockButtons>
                           <div class="overflow">
                                    <apex:pageBlockTable value="{!productsQueue}" var="pq" id="productsQueueTable">
                                        <apex:column >
                                           <apex:inputCheckbox value="{!pq.remove}"/>
                                        </apex:column>
                                         <apex:column headerValue="Quarter"> 
                                            <a href="/{!pq.pbe.Product2Id}">{!pq.quarter}</a>
                                        </apex:column>
                                        <apex:column headerValue="Year"> 
                                            <a href="/{!pq.pbe.Product2Id}">{!pq.year}</a>
                                        </apex:column>
                                         <apex:column headerValue="Product Name"> 
                                            <a href="/{!pq.pbe.Product2Id}">{!pq.pbe.Product2.Name}</a>
                                        </apex:column>
                                        <apex:column headerValue="Project">
                                            {!pq.pbe.Product2.Project__c}
                                        </apex:column>
                                        <apex:column headerValue="Program">
                                            {!pq.pbe.Product2.Program__c}``
                                        </apex:column>
                                        <apex:column headerValue="Product Family">
                                            {!pq.pbe.Product2.Family}
                                        </apex:column>
                                        <apex:column headerValue="Product Family">
                                            {!pq.pbe.Product2.Family}
                                        </apex:column>
                                        <apex:column headerValue="Standard Price">
                                            {!pq.pbe.UnitPrice}
                                        </apex:column>
                                        <apex:column headerValue="Business Unit">
                                            {!pq.pbe.Product2.Business_Unit__c}
                                        </apex:column>
                                    </apex:pageBlockTable>
                                </div>
                        </apex:pageBlock>
                         <!-- FIND PRODUCT AREA -->
                        <apex:pageBlock tabStyle="Product2" title="Find Products" rendered="{!NOT(hasProducts) || hasProducts}">
                            <div id="filter-controls">
                                <ul id="filter-fields">  
                                    <li>
                                        <label>By Keyword</label>
                                        <apex:inputText value="{!selectedKeywords}" />
                                    </li>
                                </ul>
                                <div class="clear-floats">
                                    <apex:commandButton value="Search" action="{!searchButtonClick}" reRender="searchresults" onclick="jQuery('#search-spinner').show();jQuery('#filter-controls').hide();" oncomplete="jQuery('#search-spinner').hide();jQuery('#filter-controls').show();" />
                                </div>
                            </div>
                            <img alt="" src="/s.gif" class="spinner-16" id="search-spinner" style="margin:0 auto;display:none;" />
                        </apex:pageBlock>
                         <!-- PRODUCT SELECTION AREA -->
                        <apex:outputPanel id="searchresults" rendered="{!NOT(hasProducts) || hasProducts}">
                            <apex:inputHidden id="hfSelectedId" value="{!selectedIdString}"/>
                            <apex:pageBlock tabStyle="Product2"> 
                                <apex:pageBlockButtons location="top">
                                    <apex:commandButton id="q1" value="{!fiscalYearValueQ1}" action="{!checkQuarterQ1}" onclick="getCheckedBoxes();setTitle('Please Wait');setMessage('Adding Product to Queue...');showModal();clearPersistenceCookie();" />
                                    <apex:commandButton id="q2" value="{!fiscalYearValueQ2}" action="{!checkQuarterQ2}" onclick="getCheckedBoxes();setTitle('Please Wait');setMessage('Adding Product to Queue...');showModal();clearPersistenceCookie()" />
                                    <apex:commandButton id="q3" value="{!fiscalYearValueQ3}" action="{!checkQuarterQ3}" onclick="getCheckedBoxes();setTitle('Please Wait');setMessage('Adding Product to Queue...');showModal();clearPersistenceCookie()" />
                                    <apex:commandButton id="q4" value="{!fiscalYearValueQ4}" action="{!checkQuarterQ4}" onclick="getCheckedBoxes();setTitle('Please Wait');setMessage('Adding Product to Queue...');showModal();clearPersistenceCookie()" />
                                </apex:pageBlockButtons>
                                <div class="overflow">
                                    <apex:pageBlockTable value="{!currentList}" var="sr" >
                                        <apex:column >
                                            <input type="checkbox" name="pidcheckboxes" id="ccbb-{!sr.Product2Id}" onChange= "persistCheckBox(this);" />
                                        </apex:column>
                                        <apex:column headerValue="Product Name"> 
                                            <a href="/{!sr.Product2Id}">{!sr.Product2.Name}</a>
                                        </apex:column>
                                        <apex:column headerValue="Project">
                                            {!sr.Product2.Project__c}
                                        </apex:column>
                                        <apex:column headerValue="Program">
                                            {!sr.Product2.Program__c}
                                        </apex:column>
                                        <apex:column headerValue="Product Family">
                                            {!sr.Product2.Family}
                                        </apex:column>
                                        <apex:column headerValue="Product Family">
                                            {!sr.Product2.Family}
                                        </apex:column>
                                        <apex:column headerValue="Standard Price">
                                            {!sr.UnitPrice}
                                        </apex:column>
                                        <apex:column headerValue="Business Unit">
                                            {!sr.Product2.Business_Unit__c}
                                        </apex:column>
                                    </apex:pageBlockTable>
                                </div>
                                <apex:facet name="footer">
                                    <apex:outputPanel styleClass="pager" rendered="{!totalPages > 1}">
                                        <div id="page-controls">
                                            <apex:commandLink value="<< Previous Page" action="{!goToPreviousPage}" rendered="{!NOT(onFirstPage)}" reRender="searchresults"  onclick="jQuery('#pagination-spinner').show();jQuery('#page-controls').hide();restorePersistedCheckBoxes();" oncomplete="jQuery('#pagination-spinner').hide();jQuery('#page-controls').show();restorePersistedCheckBoxes();"/>
                                            <apex:outputText value="<< Previous Page" rendered="{!onFirstPage}" styleClass="disabled-text" />
                                            <span class="page-count"> Page {!CurrentPage} of {!totalPages}</span>
                                            <apex:commandLink value="Next Page >>" action="{!goToNextPage}" rendered="{!NOT(onLastPage)}" reRender="searchresults" onclick="jQuery('#pagination-spinner').show();jQuery('#page-controls').hide();restorePersistedCheckBoxes();" oncomplete="jQuery('#pagination-spinner').hide();jQuery('#page-controls').show();restorePersistedCheckBoxes();" />
                                            <apex:outputText value="Next Page >>" rendered="{!onLastPage}" styleClass="disabled-text" />
                                        </div>
                                        <img alt="" src="/s.gif" class="spinner-16" id="pagination-spinner" style="margin:0 auto;display:none;" />
                                    </apex:outputPanel>
                                </apex:facet>
                            </apex:pageBlock>
                        </apex:outputPanel>
                    </div>
                </apex:outputPanel>
            </apex:pageBlock>

            <apex:pageBlock rendered="{!showTable && Not(isExcelRender)}">
              <div class="hiddenButtons">
                  <!--  Hide CWV<input type="checkbox" name="hideCWV" value="hideCWV" id="hideCWV" />
                   Hide POR <input type="checkbox" name="hidePOR" value="hidePOR" id="hidePOR" />
                   Hide Both <input type="checkbox" name="hideBoth" value="hideBoth" id="hideBoth" /> -->
                   Hide Totals <input type="checkbox" name="hidetotals" value="hidetotals" id="hidetotals" />
                   Hide Empty Discount Rows <input type="checkbox" onclick="toggleEmptyDiscountRows(this.checked)" />
                   <apex:inputText id="inputTabSel" value="{!tabPosition}" style="display:none;"></apex:inputText>
               </div>
            </apex:pageBlock>
             </apex:form>

            <!--Note PopUp -->
            <apex:form enctype="multipart/form-data">
            <apex:outputPanel id="results"> 
                 <apex:outputPanel id="popInnerOutputPnl" styleClass="customPopup" layout="block" rendered="{!notesPopUpShow}">
                                <style type="text/css">
                                .customPopup {
                                background-color: white;
                                border-style: solid;
                                border-width: 2px;
                                left: 25%;
                                padding: 10px;
                                position: absolute;
                                z-index: 9999;
                                /* These are the 3 css properties you will need to tweak so the pop 
                                up displays in the center of the screen. First set the width. Then set 
                                margin-left to negative half of what the width is. You can also add 
                                the height property for a fixed size pop up.*/
                                width: 800px;
                                top: 5%;
                                }     
                            </style>
                 <apex:pageBlock title="Note">  

                    <apex:pageBlockButtons >
                        <apex:commandButton action="{!saveNote}" value="Save" reRender="NotesTab, results, summaryNotes,executiveNotes" rendered="{!Not(editModeNote)}"
                        onclick="setTitle('Please Wait');setMessage('Saving...');showModal();" oncomplete="hideModal();textNotes();"/>
                        <apex:commandButton action="{!closenotesPopUp}" value="{!IF(Not(editModeNote),'Cancel','Close')}" reRender="results"
                        onclick="setTitle('Please Wait');setMessage('Closing...');showModal();" oncomplete="hideModal();"/>
                    </apex:pageBlockButtons>

                 <apex:pageBlockSection showHeader="false" columns="1" id="block1">
                    <apex:pageBlockSectionItem >
                      <apex:outputLabel value="Is Private" for="Private"/>
                      <apex:inputCheckbox value="{!note.isPrivate}" id="Private" disabled="{!IF(Not(editModeNote),false,true)}"/>
                    </apex:pageBlockSectionItem>

                    <apex:pageBlockSectionItem >
                      <apex:outputLabel value="Title" for="title"/>
                      <apex:inputText value="{!note.Title}" id="title" disabled="{!IF(Not(editModeNote),false,true)}"/>
                    </apex:pageBlockSectionItem>

                    <apex:pageBlockSectionItem >
                      <apex:outputLabel value="Body" for="body"/>
                      <apex:inputTextarea value="{!note.body}" id="body" cols="80" rows="18" readonly="{!IF(Not(editModeNote),false,true)}"/>
                    </apex:pageBlockSectionItem>

                    </apex:pageBlockSection>
                 </apex:pageBlock>
                </apex:outputPanel> 
            </apex:outputPanel>
            </apex:form>
      <!--End Of Notes PopUp -->

      <!-- Attachments PopUp -->
          <apex:form enctype="multipart/form-data">
            <apex:actionFunction name="attachmentsPopUp" action="{!attachmentsPopUp}" rerender="Attachmentsresults"/>
          <apex:outputPanel id="Attachmentsresults" > 
                 <apex:outputPanel id="popInnerOutputPnlattachments" styleClass="customPopup" layout="block" rendered="{!attachmentsPopUpShow}">
                                <style type="text/css">
                                .customPopup {
                                background-color: white;
                                border-style: solid;
                                border-width: 2px;
                                left: 25%;
                                padding: 10px;
                                position: absolute;
                                z-index: 9999;
                                /* These are the 3 css properties you will need to tweak so the pop 
                                up displays in the center of the screen. First set the width. Then set 
                                margin-left to negative half of what the width is. You can also add 
                                the height property for a fixed size pop up.*/
                                width: 400px;
                                top: 5%;
                                }     
                            </style>
                 <apex:pageBlock title="Upload an Attachment">

                  <apex:pageBlockButtons >
                    <apex:commandButton action="{!upload}" value="Save"/>
                    <apex:commandButton action="{!closeAttachmentsPopUp}" value="Cancel"/>
                  </apex:pageBlockButtons>

                  <apex:pageBlockSection showHeader="false" columns="1" id="block1">

                    <apex:pageBlockSectionItem >
                      <apex:outputLabel value="File" for="file"/>
                         <apex:inputFile value="{!a.body}" filename="{!a.name}" id="file"/>
                    </apex:pageBlockSectionItem>

                    <apex:pageBlockSectionItem >
                      <apex:outputLabel value="Description" for="description"/>
                      <apex:inputTextarea value="{!a.description}" id="description" cols="40" rows="10"/>
                    </apex:pageBlockSectionItem>

                  </apex:pageBlockSection>
                </apex:pageBlock>
                </apex:outputPanel> 

            </apex:outputPanel>
           </apex:form>
      <!--End Of Attachments PopUp -->

            <apex:outputPanel rendered="{!showTable}">
            <!--Tab Panel -->  
            <c:Tabpanel >
                <!--First Tab-->  
            <apex:form enctype="multipart/form-data">
            <c:Tab title="{!IF(Not(isExcelRender),'Deal View',' ')}">  
            <apex:outputPanel rendered="{!IF(Not(isExcelRender), true, IF(tabPosition == 'Deal View',true, false))}">
                <table cellpadding="0" cellspacing="0" border="0" class="dataTable">
                    <!--  BEGIN PER UNIT TABLE -->
                    <tr>
                        <td class="section-header" colspan="{!1+(3*lineItemCount)+(3*totalItemCount)}">Per Unit</td>
                    </tr>
                    
                    <tr class="pad-top">
                        <td></td>
                        <td></td>
                        <apex:repeat value="{!lineItemColumns}" var="l">
                            <td class="prod-header" colspan="2">
                                <span> {!l.year}</span><br/>
                                <span> {!l.quarter}</span><br/>
                                <span> {!l.name}</span><br/>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                        <apex:repeat value="{!totalColumns}" var="l">
                            <td class="prod-header total" colspan="2">
                                <br/>
                                <span>{!l.quarter}<br/></span>
                                <span>Totals</span>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                    </tr>
                    <tr>
                        <td></td>
                        <td></td>
                        <apex:repeat value="{!lineItemColumns}" var="l">
                            <td class="prod-sub-header showHidePOR" style="font-weight:bold;text-align:center; border-bottom:1px solid #000;">POR</td>
                            <td class="prod-sub-header showHideCWV" style="font-weight:bold;text-align:center; border-bottom:1px solid #000;" >CWV</td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                        <apex:repeat value="{!totalColumns}" var="l">
                            <td class="prod-sub-header showHidePOR" style="font-weight:bold;text-align:center; border-bottom:1px solid #000;">POR</td>
                            <td class="prod-sub-header showHideCWV" style="font-weight:bold;text-align:center; border-bottom:1px solid #000;">CWV</td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                    </tr>
                    
                    <tr class="unitRowOp">
                        <td class="data-row-label"><apex:image id="collapsedIconUOp" value="https://encrypted-tbn3.gstatic.com/images?q=tbn:ANd9GcTqSa2sEJ7qTG2EFEGAFKaDVUH8p5TASg7RDFS7bbBIhStp5a1TdfdsPg" width="17px" height="17px" alt="-" rendered="{!Not(isExcelRender)}"/>Units</td><td></td>
                        <apex:repeat value="{!lineItemColumns}" var="l">
                            <td class="currency-cell showHidePOR">
                                <apex:outputField rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}" value="{!l.porLineItem.Units__c}">
                                    <apex:inlineEditSupport event="ondblclick" showOnEdit="btnSaveChanges,btnCancel"/>
                                </apex:outputField>
                                <apex:outputText rendered="{!isExcelRender || inApprovalProccess}" value="{0,number,###,##0}">
                                    <apex:param value="{!l.porLineItem.Units__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideCWV" >
                                <apex:outputField rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}" value="{!l.cwvLineItem.Units__c}"> 
                                    <apex:inlineEditSupport event="ondblclick" showOnEdit="btnSaveChanges,btnCancel"/>
                                </apex:outputField>
                                <apex:outputText rendered="{!isExcelRender || inApprovalProccess}" value="{0,number,###,##0}">
                                    <apex:param value="{!l.cwvLineItem.Units__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                        <apex:repeat value="{!totalColumns}" var="l">
                            <td class="currency-cell showHidePOR">
                                <apex:outputText value="{0,number,###,##0}">
                                    <apex:param value="{!l.TotalPorLineItem.units}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideCWV" >
                                <apex:outputText value="{0,number,###,##0}">
                                    <apex:param value="{!l.TotalCwvLineItem.units}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                    </tr>
                    <tr class="collapsableUOp">
                        <td class="data-row-sub-label">- Minimum Commit </td><td>
                        <apex:inputText value="{!lineItemColumns[0].minimumCommitOpCommentField}" style="width: 45px; height:15px;" rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}"/>
                        <apex:outputText value="{!lineItemColumns[0].minimumCommitOpCommentField}" style="width: 45px; height:15px;" rendered="{!isExcelRender || inApprovalProccess}"/>
                        </td>
                        <apex:repeat value="{!lineItemColumns}" var="l">
                            <td class="currency-cell showHidePOR">
                                <apex:outputField rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}" value="{!l.porLineItem.MinimumCommitQuantity__c}">
                                    <apex:inlineEditSupport event="ondblclick" showOnEdit="btnSaveChanges,btnCancel"/>
                                </apex:outputField>
                                <apex:outputText rendered="{!isExcelRender || inApprovalProccess}" value="{0,number,###,##0}">
                                    <apex:param value="{!l.porLineItem.MinimumCommitQuantity__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideCWV" >
                                <apex:outputField rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}" value="{!l.cwvLineItem.MinimumCommitQuantity__c}">
                                    <apex:inlineEditSupport event="ondblclick" showOnEdit="btnSaveChanges,btnCancel"/>
                                </apex:outputField>
                                <apex:outputText rendered="{!isExcelRender || inApprovalProccess}" value="{0,number,###,##0}">
                                    <apex:param value="{!l.cwvLineItem.MinimumCommitQuantity__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                        <apex:repeat value="{!totalColumns}" var="l">
                            <td class="currency-cell showHidePOR">
                                <apex:outputText value="{0,number,###,##0}">
                                    <apex:param value="{!l.TotalPorLineItem.minCommit}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideCWV" >
                                <apex:outputText value="{0,number,###,##0}">
                                    <apex:param value="{!l.TotalCwvLineItem.minCommit}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                    </tr>
                    <tr>
                        <td class="data-row-label">Invoice Price (NSBD)
                        </td>
                        <td>
                        <apex:inputText value="{!lineItemColumns[0].invoiceCommentField}" style="width: 45px; height:15px;" rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}"/>
                        <apex:outputText value="{!lineItemColumns[0].invoiceCommentField}" style="width: 45px; height:15px;" rendered="{!isExcelRender || inApprovalProccess}"/>
                        </td>
                        <apex:repeat value="{!lineItemColumns}" var="l">
                            <td class="currency-cell showHidePOR">
                                <apex:outputField rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}" value="{!l.porLineItem.InvoicePrice__c}">
                                <apex:inlineEditSupport event="ondblclick" showOnEdit="btnSaveChanges,btnCancel"/>
                                </apex:outputField>
                                <apex:outputText rendered="{!isExcelRender || inApprovalProccess}" value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.porLineItem.InvoicePrice__c}"/>
                                </apex:outputText>
                            </td>
                             <td class="currency-cell showHideCWV" >
                                <apex:outputField rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}" value="{!l.cwvLineItem.InvoicePrice__c}">
                                <apex:inlineEditSupport event="ondblclick" showOnEdit="btnSaveChanges,btnCancel"/>
                                </apex:outputField>
                                <apex:outputText rendered="{!isExcelRender || inApprovalProccess}" value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.cwvLineItem.InvoicePrice__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                        <apex:repeat value="{!totalColumns}" var="l">
                            <td class="currency-cell showHidePOR">  
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.porLineItem.invoice}"/>
                                </apex:outputText>
                            </td>
                             <td class="currency-cell showHideCWV" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.cwvLineItem.invoice}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                    </tr>
                   <!--  <tr>
                        <td class="data-row-label">NSBD 
                        </td>
                        <td>
                        <apex:inputText value="{!lineItemColumns[0].commentField}" style="width: 45px; height:15px;" rendered="{!Not(isExcelRender)}"/>
                        <apex:outputText value="{!lineItemColumns[0].commentField}" style="width: 45px; height:15px;" rendered="{!isExcelRender}"/>  
                        </td>
                        <apex:repeat value="{!lineItemColumns}" var="l">
                            <td class="currency-cell showHidePOR">
                                <apex:outputField rendered="{!NOT(isExcelRender)}" value="{!l.porLineItem.NSBD__c}">
                                </apex:outputField>
                                <apex:outputText rendered="{!isExcelRender}" value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.porLineItem.NSBD__c}"/>
                                </apex:outputText>
                            </td>
                             <td class="currency-cell showHideCWV" >
                                <apex:outputField rendered="{!NOT(isExcelRender)}" value="{!l.cwvLineItem.NSBD__c}">
                                </apex:outputField>
                                <apex:outputText rendered="{!isExcelRender}" value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.cwvLineItem.NSBD__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                        <apex:repeat value="{!totalColumns}" var="l">
                            <td class="currency-cell showHidePOR">
                                <apex:outputText value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.porLineItem.NSBD}"/>
                                </apex:outputText>
                            </td>
                             <td class="currency-cell showHideCWV" >
                                <apex:outputText value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.cwvLineItem.NSBD}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                    </tr> -->
                    <tr class="discountRow">
                        <td class="data-row-label"><apex:image id="collapsedIconD" value="https://encrypted-tbn3.gstatic.com/images?q=tbn:ANd9GcTqSa2sEJ7qTG2EFEGAFKaDVUH8p5TASg7RDFS7bbBIhStp5a1TdfdsPg" width="17px" height="17px" alt="-" rendered="{!Not(isExcelRender)}"/>Discount 
                       </td>     
                         <td>
                         <apex:inputText value="{!lineItemColumns[0].discountCommentField}" style="width: 45px; height:15px;" rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}"/>
                         <apex:outputText value="{!lineItemColumns[0].discountCommentField}" style="width: 45px; height:15px;" rendered="{!isExcelRender || inApprovalProccess}"/>
                         </td>
                        <apex:repeat value="{!lineItemColumns}" var="l">
                            <td class="currency-cell showHidePOR">
                                <apex:outputField rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}" value="{!l.porLineItem.Discount_Total__c}">
                                    <apex:inlineEditSupport event="ondblclick" showOnEdit="btnSaveChanges,btnCancel"/>
                                </apex:outputField>
                                <apex:outputText rendered="{!isExcelRender || inApprovalProccess}" value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.porLineItem.Discount_Total__c}"/>
                                </apex:outputText>
                            </td>
                             <td class="currency-cell showHideCWV" >
                                <apex:outputField rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}" value="{!l.cwvLineItem.Discount_Total__c}">
                                    <apex:inlineEditSupport event="ondblclick" showOnEdit="btnSaveChanges,btnCancel"/>
                                </apex:outputField>
                                <apex:outputText rendered="{!isExcelRender || inApprovalProccess}" value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.cwvLineItem.Discount_Total__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                        <apex:repeat value="{!totalColumns}" var="l">
                            <td class="currency-cell showHidePOR">
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.porLineItem.discount}"/>
                                </apex:outputText>
                            </td>
                             <td class="currency-cell showHideCWV" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.cwvLineItem.discount}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                    </tr>

                    <tr class='collapsableD'>
                        <td class="data-row-sub-label">
                        <apex:inputCheckbox rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}" value="{!visibleOrNotSDF}">
                          <apex:actionSupport event="onchange" action="{!setCheckBoxVisibleOrNotSDF}" rerender="SDF"/>
                          </apex:inputCheckbox>
                          <apex:outputLabel value="{!SDFLabel}" id="SDF"/></td>
                        <td>
                        <apex:inputText value="{!lineItemColumns[0].SDFCommentField}" style="width: 45px; height:15px;" rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}"/>
                        <apex:outputText value="{!lineItemColumns[0].SDFCommentField}" style="width: 45px; height:15px;" rendered="{!isExcelRender || inApprovalProccess}"/>  
                        </td>
                        
                        <apex:repeat value="{!lineItemColumns}" var="l">
                            <td class="currency-cell showHidePOR">
                                <apex:outputField rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}" value="{!l.porLineItem.SDF__c}">
                                    <apex:inlineEditSupport event="ondblclick" showOnEdit="btnSaveChanges,btnCancel"/>
                                </apex:outputField>
                                <apex:outputText rendered="{!isExcelRender || inApprovalProccess}" value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.porLineItem.SDF__c}"/>
                                </apex:outputText>
                            </td>
                             <td class="currency-cell showHideCWV" >
                                <apex:outputField rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}" value="{!l.cwvLineItem.SDF__c}">
                                    <apex:inlineEditSupport event="ondblclick" showOnEdit="btnSaveChanges,btnCancel"/>
                                </apex:outputField>
                                <apex:outputText rendered="{!isExcelRender || inApprovalProccess}" value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.cwvLineItem.SDF__c}"/>
                                </apex:outputText>
                            </td>                            
                            <td class="col-sep"></td>
                        </apex:repeat>
                        <apex:repeat value="{!totalColumns}" var="l">
                            <td class="currency-cell showHidePOR">
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.porLineItem.sdf}"/>
                                </apex:outputText>
                            </td>
                             <td class="currency-cell showHideCWV" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.cwvLineItem.sdf}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                    </tr>
                    
                    <tr class='collapsableD'>
                        <td class="data-row-sub-label">
                        <apex:inputCheckbox rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}" value="{!visibleOrNot1}">
                          <apex:actionSupport event="onchange" action="{!setCheckBoxVisibleOrNot}" rerender="COOP"/>
                          </apex:inputCheckbox>
                          <apex:outputLabel value="{!COOPLabel}" id="COOP"/></td>
                        <td>
                        <apex:inputText value="{!lineItemColumns[0].coopCommentField}" style="width: 45px; height:15px;" rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}"/>
                        <apex:outputText value="{!lineItemColumns[0].coopCommentField}" style="width: 45px; height:15px;" rendered="{!isExcelRender || inApprovalProccess}"/>  
                        </td>
                        
                        <apex:repeat value="{!lineItemColumns}" var="l">
                            <td class="currency-cell showHidePOR">
                                <apex:outputField rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}" value="{!l.porLineItem.COOP__c}">
                                    <apex:inlineEditSupport event="ondblclick" showOnEdit="btnSaveChanges,btnCancel"/>
                                </apex:outputField>
                                <apex:outputText rendered="{!isExcelRender || inApprovalProccess}" value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.porLineItem.COOP__c}"/>
                                </apex:outputText>
                            </td>
                             <td class="currency-cell showHideCWV" >
                                <apex:outputField rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}" value="{!l.cwvLineItem.COOP__c}">
                                    <apex:inlineEditSupport event="ondblclick" showOnEdit="btnSaveChanges,btnCancel"/>
                                </apex:outputField>
                                <apex:outputText rendered="{!isExcelRender || inApprovalProccess}" value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.cwvLineItem.COOP__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                        <apex:repeat value="{!totalColumns}" var="l">
                            <td class="currency-cell showHidePOR">
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.porLineItem.coop}"/>
                                </apex:outputText>
                            </td>
                             <td class="currency-cell showHideCWV" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.cwvLineItem.coop}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                    </tr>
                    <tr class='collapsableD'>

                        <td class="data-row-sub-label"> 
                        <apex:inputCheckbox rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}" value="{!visibleOrNot2}">
                          <apex:actionSupport event="onchange" action="{!setCheckBoxVisibleOrNot2}" rerender="MDF"/>
                          </apex:inputCheckbox>
                          <apex:outputLabel value="{!MDFLabel}" id="MDF"/></td>
                        <td>
                        <apex:inputText value="{!lineItemColumns[0].mdfCommentField}" style="width: 45px; height:15px;" rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}"/>
                        <apex:outputText value="{!lineItemColumns[0].mdfCommentField}" style="width: 45px; height:15px;" rendered="{!isExcelRender || inApprovalProccess}"/>
                        </td>
                        
                        <apex:repeat value="{!lineItemColumns}" var="l">
                            <td class="currency-cell showHidePOR">
                                <apex:outputField rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}" value="{!l.porLineItem.MDF__c}">
                                    <apex:inlineEditSupport event="ondblclick" showOnEdit="btnSaveChanges,btnCancel"/>
                                </apex:outputField>
                                <apex:outputText rendered="{!isExcelRender || inApprovalProccess}" value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.porLineItem.MDF__c}"/>
                                </apex:outputText>
                            </td>
                             <td class="currency-cell showHideCWV" >
                                <apex:outputField rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}" value="{!l.cwvLineItem.MDF__c}">
                                    <apex:inlineEditSupport event="ondblclick" showOnEdit="btnSaveChanges,btnCancel"/>
                                </apex:outputField>
                                <apex:outputText rendered="{!isExcelRender || inApprovalProccess}" value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.cwvLineItem.MDF__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                        <apex:repeat value="{!totalColumns}" var="l">
                            <td class="currency-cell showHidePOR">
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.porLineItem.mdf}"/>
                                </apex:outputText>
                            </td>
                             <td class="currency-cell showHideCWV" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.cwvLineItem.mdf}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                    </tr>
                    <tr class='collapsableD'>
                        <td class="data-row-sub-label">
                          <apex:inputCheckbox rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}" value="{!visibleOrNot3}">
                          <apex:actionSupport event="onchange" action="{!setCheckBoxVisibleOrNot3}" rerender="iMDF"/>
                          </apex:inputCheckbox>
                          <apex:outputLabel value="{!iMDFLabel}" id="iMDF"/></td><td>
                        <apex:inputText value="{!lineItemColumns[0].imdfCommentField}" style="width: 45px; height:15px;" rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}"/>
                        <apex:outputText value="{!lineItemColumns[0].imdfCommentField}" style="width: 45px; height:15px;" rendered="{!isExcelRender || inApprovalProccess}"/>
                        </td>
                        
                        <apex:repeat value="{!lineItemColumns}" var="l">
                            <td class="currency-cell showHidePOR">
                                <apex:outputField rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}" value="{!l.porLineItem.iMDF__c}">
                                    <apex:inlineEditSupport event="ondblclick" showOnEdit="btnSaveChanges,btnCancel"/>
                                </apex:outputField>
                                <apex:outputText rendered="{!isExcelRender || inApprovalProccess}" value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.porLineItem.iMDF__c}"/>
                                </apex:outputText>
                            </td>
                             <td class="currency-cell showHideCWV" >
                                <apex:outputField rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}" value="{!l.cwvLineItem.iMDF__c}">
                                    <apex:inlineEditSupport event="ondblclick" showOnEdit="btnSaveChanges,btnCancel"/>
                                </apex:outputField>
                                <apex:outputText rendered="{!isExcelRender || inApprovalProccess}" value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.cwvLineItem.iMDF__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                        <apex:repeat value="{!totalColumns}" var="l">
                            <td class="currency-cell showHidePOR">
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.porLineItem.imdf}"/>
                                </apex:outputText>
                            </td>
                             <td class="currency-cell showHideCWV" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.cwvLineItem.imdf}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                    </tr>
                    <tr class='collapsableD'>
                        <td class="data-row-sub-label">
                         <apex:inputCheckbox rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}" value="{!visibleOrNot4}">
                          <apex:actionSupport event="onchange" action="{!setCheckBoxVisibleOrNot4}" rerender="SVM"/>
                          </apex:inputCheckbox>
                          <apex:outputLabel value="{!SVMLabel}" id="SVM"/></td><td>
                        <apex:inputText value="{!lineItemColumns[0].svmCommentField}" style="width: 45px; height:15px;" rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}"/>
                        <apex:outputText value="{!lineItemColumns[0].svmCommentField}" style="width: 45px; height:15px;" rendered="{!isExcelRender || inApprovalProccess}"/>
                        </td>
                        
                        <apex:repeat value="{!lineItemColumns}" var="l">
                            <td class="currency-cell showHidePOR">
                                <apex:outputField rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}" value="{!l.porLineItem.SVM__c}">
                                    <apex:inlineEditSupport event="ondblclick" showOnEdit="btnSaveChanges,btnCancel"/>
                                </apex:outputField>
                                <apex:outputText rendered="{!isExcelRender || inApprovalProccess}" value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.porLineItem.SVM__c}"/>
                                </apex:outputText>
                            </td>
                             <td class="currency-cell showHideCWV" >
                                <apex:outputField rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}" value="{!l.cwvLineItem.SVM__c}">
                                    <apex:inlineEditSupport event="ondblclick" showOnEdit="btnSaveChanges,btnCancel"/>
                                </apex:outputField>
                                <apex:outputText rendered="{!isExcelRender || inApprovalProccess}" value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.cwvLineItem.SVM__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                        <apex:repeat value="{!totalColumns}" var="l">
                            <td class="currency-cell showHidePOR">
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.porLineItem.svm}"/>
                                </apex:outputText>
                            </td>
                             <td class="currency-cell showHideCWV" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.cwvLineItem.svm}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                    </tr>
                    <tr class='collapsableD'>
                        <td class="data-row-sub-label">
                          <apex:inputCheckbox rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}" value="{!visibleOrNot5}">
                          <apex:actionSupport event="onchange" action="{!setCheckBoxVisibleOrNot5}" rerender="IPP"/>
                          </apex:inputCheckbox>
                          <apex:outputLabel value="{!IPPLabel}" id="IPP"/></td><td>
                        <apex:inputText value="{!lineItemColumns[0].ippCommentField}" style="width: 45px; height:15px;" rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}"/>
                        <apex:outputText value="{!lineItemColumns[0].ippCommentField}" style="width: 45px; height:15px;" rendered="{!isExcelRender || inApprovalProccess}"/>
                        </td>
                        
                        <apex:repeat value="{!lineItemColumns}" var="l">
                            <td class="currency-cell showHidePOR">
                                <apex:outputField rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}" value="{!l.porLineItem.IPP__c}">
                                    <apex:inlineEditSupport event="ondblclick" showOnEdit="btnSaveChanges,btnCancel"/>
                                </apex:outputField>
                                <apex:outputText rendered="{!isExcelRender || inApprovalProccess}" value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.porLineItem.IPP__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideCWV" >
                                <apex:outputField rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}" value="{!l.cwvLineItem.IPP__c}">
                                    <apex:inlineEditSupport event="ondblclick" showOnEdit="btnSaveChanges,btnCancel"/>
                                </apex:outputField>
                                <apex:outputText rendered="{!isExcelRender || inApprovalProccess}" value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.cwvLineItem.IPP__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                        <apex:repeat value="{!totalColumns}" var="l">
                            <td class="currency-cell showHidePOR">
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.porLineItem.ipp}"/>
                                </apex:outputText>
                            </td>
                             <td class="currency-cell showHideCWV" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.cwvLineItem.ipp}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                    </tr>
                    <tr class='collapsableD'>
                        <td class="data-row-sub-label">
                          <apex:inputCheckbox rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}" value="{!visibleOrNot6}">
                          <apex:actionSupport event="onchange" action="{!setCheckBoxVisibleOrNot6}" rerender="National"/>
                          </apex:inputCheckbox>
                          <apex:outputLabel value="{!NationalLabel}" id="National"/></td><td>
                        <apex:inputText value="{!lineItemColumns[0].nationalRetailCommentField}" style="width: 45px; height:15px;" rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}"/>
                        <apex:outputText value="{!lineItemColumns[0].nationalRetailCommentField}" style="width: 45px; height:15px;" rendered="{!isExcelRender || inApprovalProccess}"/>
                        </td>
                        
                        <apex:repeat value="{!lineItemColumns}" var="l">
                            <td class="currency-cell showHidePOR">
                                <apex:outputField rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}" value="{!l.porLineItem.National_Retail__c}">
                                    <apex:inlineEditSupport event="ondblclick" showOnEdit="btnSaveChanges,btnCancel"/>
                                </apex:outputField>
                                <apex:outputText rendered="{!isExcelRender || inApprovalProccess}" value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.porLineItem.National_Retail__c}"/>
                                </apex:outputText>
                            </td>
                             <td class="currency-cell showHideCWV" >
                                <apex:outputField rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}" value="{!l.cwvLineItem.National_Retail__c}">
                                    <apex:inlineEditSupport event="ondblclick" showOnEdit="btnSaveChanges,btnCancel"/>
                                </apex:outputField>
                                <apex:outputText rendered="{!isExcelRender || inApprovalProccess}" value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.cwvLineItem.National_Retail__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                        <apex:repeat value="{!totalColumns}" var="l">
                            <td class="currency-cell showHidePOR">
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.porLineItem.nationalRetail}"/>
                                </apex:outputText>
                            </td>
                             <td class="currency-cell showHideCWV" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.cwvLineItem.nationalRetail}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                    </tr>
                    <tr class='collapsableD'>
                        <td class="data-row-sub-label">
                          <apex:inputCheckbox rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}" value="{!visibleOrNot7}">
                          <apex:actionSupport event="onchange" action="{!setCheckBoxVisibleOrNot7}" rerender="CSAT"/>
                          </apex:inputCheckbox>
                          <apex:outputLabel value="{!CSATLabel}" id="CSAT"/></td><td>    
                        <apex:inputText value="{!lineItemColumns[0].csatCommentField}" style="width: 45px; height:15px;" rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}"/>
                        <apex:outputText value="{!lineItemColumns[0].csatCommentField}" style="width: 45px; height:15px;" rendered="{!isExcelRender || inApprovalProccess}"/>
                        </td>
                        
                        <apex:repeat value="{!lineItemColumns}" var="l">
                            <td class="currency-cell showHidePOR">
                                <apex:outputField rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}" value="{!l.porLineItem.CSAT__c}">
                                    <apex:inlineEditSupport event="ondblclick" showOnEdit="btnSaveChanges,btnCancel"/>
                                </apex:outputField>
                                <apex:outputText rendered="{!isExcelRender || inApprovalProccess}" value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.porLineItem.CSAT__c}"/>
                                </apex:outputText>
                            </td>
                             <td class="currency-cell showHideCWV" >
                                <apex:outputField rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}" value="{!l.cwvLineItem.CSAT__c}">
                                    <apex:inlineEditSupport event="ondblclick" showOnEdit="btnSaveChanges,btnCancel"/>
                                </apex:outputField>
                                <apex:outputText rendered="{!isExcelRender || inApprovalProccess}" value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.cwvLineItem.CSAT__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                        <apex:repeat value="{!totalColumns}" var="l">
                            <td class="currency-cell showHidePOR">
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.porLineItem.csat}"/>
                                </apex:outputText>
                            </td>
                             <td class="currency-cell showHideCWV" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.cwvLineItem.csat}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                    </tr>
                    <tr class='collapsableD'>
                        <td class="data-row-sub-label">
                         <apex:inputCheckbox rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}" value="{!visibleOrNot8}">
                          <apex:actionSupport event="onchange" action="{!setCheckBoxVisibleOrNot8}" rerender="QP"/>
                          </apex:inputCheckbox>
                          <apex:outputLabel value="{!QPLabel}" id="QP"/></td><td>
                        <apex:inputText value="{!lineItemColumns[0].qpCommentField}" style="width: 45px; height:15px;" rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}"/>
                        <apex:outputText value="{!lineItemColumns[0].qpCommentField}" style="width: 45px; height:15px;" rendered="{!isExcelRender || inApprovalProccess}"/>
                        </td>
                        
                        <apex:repeat value="{!lineItemColumns}" var="l">
                            <td class="currency-cell showHidePOR">
                                <apex:outputField rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}" value="{!l.porLineItem.QP__c}">
                                    <apex:inlineEditSupport event="ondblclick" showOnEdit="btnSaveChanges,btnCancel"/>
                                </apex:outputField>
                                <apex:outputText rendered="{!isExcelRender || inApprovalProccess}" value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.porLineItem.QP__c}"/>
                                </apex:outputText>
                            </td>
                             <td class="currency-cell showHideCWV" >
                                <apex:outputField rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}" value="{!l.cwvLineItem.QP__c}">
                                    <apex:inlineEditSupport event="ondblclick" showOnEdit="btnSaveChanges,btnCancel"/>
                                </apex:outputField>
                                <apex:outputText rendered="{!isExcelRender || inApprovalProccess}" value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.cwvLineItem.QP__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                        <apex:repeat value="{!totalColumns}" var="l">
                            <td class="currency-cell showHidePOR">
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.porLineItem.qp}"/>
                                </apex:outputText>
                            </td>
                             <td class="currency-cell showHideCWV" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.cwvLineItem.qp}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                    </tr>
                    <tr class='collapsableD'>
                        <td class="data-row-sub-label">
                          <apex:inputCheckbox rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}" value="{!visibleOrNot9}">
                          <apex:actionSupport event="onchange" action="{!setCheckBoxVisibleOrNot9}" rerender="TC"/>
                          </apex:inputCheckbox>
                          <apex:outputLabel value="{!TCLabel}" id="TC"/></td><td>
                        <apex:inputText value="{!lineItemColumns[0].tcCommentField}" style="width: 45px; height:15px;" rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}"/>
                        <apex:outputText value="{!lineItemColumns[0].tcCommentField}" style="width: 45px; height:15px;" rendered="{!isExcelRender || inApprovalProccess}"/>
                        </td>
                       
                        <apex:repeat value="{!lineItemColumns}" var="l">
                            <td class="currency-cell showHidePOR">
                                <apex:outputField rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}" value="{!l.porLineItem.TC__c}">
                                    <apex:inlineEditSupport event="ondblclick" showOnEdit="btnSaveChanges,btnCancel"/>
                                </apex:outputField>
                                <apex:outputText rendered="{!isExcelRender || inApprovalProccess}" value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.porLineItem.TC__c}"/>
                                </apex:outputText>
                            </td>
                             <td class="currency-cell showHideCWV" >
                                <apex:outputField rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}" value="{!l.cwvLineItem.TC__c}">
                                    <apex:inlineEditSupport event="ondblclick" showOnEdit="btnSaveChanges,btnCancel"/>
                                </apex:outputField>
                                <apex:outputText rendered="{!isExcelRender || inApprovalProccess}" value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.cwvLineItem.TC__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                        <apex:repeat value="{!totalColumns}" var="l">
                            <td class="currency-cell showHidePOR">
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.porLineItem.tc}"/>
                                </apex:outputText>
                            </td>
                             <td class="currency-cell showHideCWV" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.cwvLineItem.tc}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                    </tr>
                    <tr class='collapsableD'>
                        <td class="data-row-sub-label">
                          <apex:inputCheckbox rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}" value="{!visibleOrNot10}">
                          <apex:actionSupport event="onchange" action="{!setCheckBoxVisibleOrNot10}" rerender="ILW"/>
                          </apex:inputCheckbox>
                          <apex:outputLabel value="{!ILWLabel}" id="ILW"/></td><td>
                        <apex:inputText value="{!lineItemColumns[0].ilwCommentField}" style="width: 45px; height:15px;" rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}"/>
                        <apex:outputText value="{!lineItemColumns[0].ilwCommentField}" style="width: 45px; height:15px;" rendered="{!isExcelRender || inApprovalProccess}"/>
                        </td>
                        
                        <apex:repeat value="{!lineItemColumns}" var="l">
                            <td class="currency-cell showHidePOR">
                                <apex:outputField rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}" value="{!l.porLineItem.ILW__c}">
                                    <apex:inlineEditSupport event="ondblclick" showOnEdit="btnSaveChanges,btnCancel"/>
                                </apex:outputField>
                                <apex:outputText rendered="{!isExcelRender || inApprovalProccess}" value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.porLineItem.ILW__c}"/>
                                </apex:outputText>
                            </td>
                             <td class="currency-cell showHideCWV" >
                                <apex:outputField rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}" value="{!l.cwvLineItem.ILW__c}">
                                    <apex:inlineEditSupport event="ondblclick" showOnEdit="btnSaveChanges,btnCancel"/>
                                </apex:outputField>
                                <apex:outputText rendered="{!isExcelRender || inApprovalProccess}" value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.cwvLineItem.ILW__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                        <apex:repeat value="{!totalColumns}" var="l">
                            <td class="currency-cell showHidePOR">
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.porLineItem.ilw}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideCWV" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.cwvLineItem.ilw}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                    </tr>
                    <tr class='collapsableD'>
                        <td class="data-row-sub-label">
                          <apex:inputCheckbox rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}" value="{!visibleOrNot11}">
                          <apex:actionSupport event="onchange" action="{!setCheckBoxVisibleOrNot11}" rerender="TDF"/>
                          </apex:inputCheckbox>
                          <apex:outputLabel value="{!TDFLabel}" id="TDF"/></td><td>
                        <apex:inputText value="{!lineItemColumns[0].tdfCommentField}" style="width: 45px; height:15px;" rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}"/>
                        <apex:outputText value="{!lineItemColumns[0].tdfCommentField}" style="width: 45px; height:15px;" rendered="{!isExcelRender || inApprovalProccess}"/>
                        </td>
                        
                        <apex:repeat value="{!lineItemColumns}" var="l">
                            <td class="currency-cell showHidePOR">
                                <apex:outputField rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}" value="{!l.porLineItem.TDF__c}">
                                    <apex:inlineEditSupport event="ondblclick" showOnEdit="btnSaveChanges,btnCancel"/>
                                </apex:outputField>
                                <apex:outputText rendered="{!isExcelRender || inApprovalProccess}" value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.porLineItem.TDF__c}"/>
                                </apex:outputText>
                            </td>
                             <td class="currency-cell showHideCWV" >
                                <apex:outputField rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}" value="{!l.cwvLineItem.TDF__c}">
                                    <apex:inlineEditSupport event="ondblclick" showOnEdit="btnSaveChanges,btnCancel"/>
                                </apex:outputField>
                                <apex:outputText rendered="{!isExcelRender || inApprovalProccess}" value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.cwvLineItem.TDF__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                        <apex:repeat value="{!totalColumns}" var="l">
                            <td class="currency-cell showHidePOR">
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.porLineItem.tdf}"/>
                                </apex:outputText>
                            </td>
                             <td class="currency-cell showHideCWV" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.cwvLineItem.tdf}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                    </tr>
                    <tr class='collapsableD'>
                        <td class="data-row-sub-label">
                          <apex:inputCheckbox rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}" value="{!visibleOrNot12}">
                          <apex:actionSupport event="onchange" action="{!setCheckBoxVisibleOrNot12}" rerender="Fees"/>
                          </apex:inputCheckbox>
                          <apex:outputLabel value="{!FeesLabel}" id="Fees"/></td><td>
                        <apex:inputText value="{!lineItemColumns[0].feesCommentField}" style="width: 45px; height:15px;" rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}"/>
                        <apex:outputText value="{!lineItemColumns[0].feesCommentField}" style="width: 45px; height:15px;" rendered="{!isExcelRender || inApprovalProccess}"/>
                        </td>
                        
                        <apex:repeat value="{!lineItemColumns}" var="l">
                            <td class="currency-cell showHidePOR"> 
                                <apex:outputField rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}" value="{!l.porLineItem.Fees__c}">
                                    <apex:inlineEditSupport event="ondblclick" showOnEdit="btnSaveChanges,btnCancel"/>
                                </apex:outputField>
                                <apex:outputText rendered="{!isExcelRender || inApprovalProccess}" value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.porLineItem.Fees__c}"/>
                                </apex:outputText>
                            </td>
                             <td class="currency-cell showHideCWV" >
                                <apex:outputField rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}" value="{!l.cwvLineItem.Fees__c}">
                                    <apex:inlineEditSupport event="ondblclick" showOnEdit="btnSaveChanges,btnCancel"/>
                                </apex:outputField>
                                <apex:outputText rendered="{!isExcelRender || inApprovalProccess}" value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.cwvLineItem.Fees__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                        <apex:repeat value="{!totalColumns}" var="l">
                            <td class="currency-cell showHidePOR">
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.porLineItem.fees}"/>
                                </apex:outputText>
                            </td>
                             <td class="currency-cell showHideCWV" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.cwvLineItem.fees}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                    </tr>
                    <tr class='collapsableD'>
                        <td class="data-row-sub-label">
                          <apex:inputCheckbox rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}" value="{!visibleOrNot13}">
                          <apex:actionSupport event="onchange" action="{!setCheckBoxVisibleOrNot13}" rerender="Negotiation"/>
                          </apex:inputCheckbox>
                          <apex:outputLabel value="{!NegotiationLabel}" id="Negotiation"/></td><td>
                        <apex:inputText value="{!lineItemColumns[0].negotiationBufferCommentField}" style="width: 45px; height:15px;" rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}"/>
                        <apex:outputText value="{!lineItemColumns[0].negotiationBufferCommentField}" style="width: 45px; height:15px;" rendered="{!isExcelRender || inApprovalProccess}"/>
                        </td>
                        
                        <apex:repeat value="{!lineItemColumns}" var="l">
                            <td class="currency-cell showHidePOR">
                                <apex:outputField rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}" value="{!l.porLineItem.Negotiation_Buffer__c}">
                                    <apex:inlineEditSupport event="ondblclick" showOnEdit="btnSaveChanges,btnCancel"/>
                                </apex:outputField>
                                <apex:outputText rendered="{!isExcelRender || inApprovalProccess}" value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.porLineItem.Negotiation_Buffer__c}"/>
                                </apex:outputText>
                            </td>
                             <td class="currency-cell showHideCWV" >
                                <apex:outputField rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}" value="{!l.cwvLineItem.Negotiation_Buffer__c}">
                                    <apex:inlineEditSupport event="ondblclick" showOnEdit="btnSaveChanges,btnCancel"/>
                                </apex:outputField>
                                <apex:outputText rendered="{!isExcelRender || inApprovalProccess}" value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.cwvLineItem.Negotiation_Buffer__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                        <apex:repeat value="{!totalColumns}" var="l">
                            <td class="currency-cell showHidePOR">
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.porLineItem.negotiationBuffer}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideCWV" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.cwvLineItem.negotiationBuffer}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                    </tr>
                    <tr style="display:none;">
                        <td class="data-row-label">NSAD
                        </td><td>
                        <apex:inputText value="{!lineItemColumns[0].nsadCommentField}" style="width: 45px; height:15px;" rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}"/>
                        <apex:outputText value="{!lineItemColumns[0].nsadCommentField}" style="width: 45px; height:15px;" rendered="{!isExcelRender || inApprovalProccess}"/>
                        </td>
                        
                        <apex:repeat value="{!lineItemColumns}" var="l">
                            <td class="currency-cell showHidePOR">
                                <apex:outputField rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}" value="{!l.porLineItem.NSAD__c}">
                                    <apex:inlineEditSupport event="ondblclick" showOnEdit="btnSaveChanges,btnCancel"/>
                                </apex:outputField>
                                <apex:outputText rendered="{!isExcelRender || inApprovalProccess}" value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.porLineItem.NSAD__c}"/>
                                </apex:outputText>
                            </td>
                             <td class="currency-cell showHideCWV" >
                                <apex:outputField rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}" value="{!l.cwvLineItem.NSAD__c}">
                                    <apex:inlineEditSupport event="ondblclick" showOnEdit="btnSaveChanges,btnCancel"/>
                                </apex:outputField>
                                <apex:outputText rendered="{!isExcelRender || inApprovalProccess}" value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.cwvLineItem.NSAD__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                        <apex:repeat value="{!totalColumns}" var="l">
                            <td class="currency-cell showHidePOR">
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.porLineItem.nsad}"/>
                                </apex:outputText>
                            </td>
                             <td class="currency-cell showHideCWV" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.cwvLineItem.nsad}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                    </tr>
                     <tr>
                        <td class="data-row-label">ASP (NSAD)
                        </td><td>
                        <apex:inputText value="{!lineItemColumns[0].nsadCommentField}" style="width: 45px; height:15px;" rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}"/>
                        <apex:outputText value="{!lineItemColumns[0].nsadCommentField}" style="width: 45px; height:15px;" rendered="{!isExcelRender || inApprovalProccess}"/>
                        </td>
                        
                        <apex:repeat value="{!lineItemColumns}" var="l">
                            <td class="currency-cell showHidePOR">
                                <apex:outputField rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}" value="{!l.porLineItem.Actual_Selling_Price_ASP__c}">
                                    <apex:inlineEditSupport event="ondblclick" showOnEdit="btnSaveChanges,btnCancel"/>
                                </apex:outputField>
                                <apex:outputText rendered="{!isExcelRender || inApprovalProccess}" value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.porLineItem.NSAD__c}"/>
                                </apex:outputText>
                            </td>
                             <td class="currency-cell showHideCWV" >
                                <apex:outputField rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}" value="{!l.cwvLineItem.Actual_Selling_Price_ASP__c}">
                                    <apex:inlineEditSupport event="ondblclick" showOnEdit="btnSaveChanges,btnCancel"/>
                                </apex:outputField>
                                <apex:outputText rendered="{!isExcelRender || inApprovalProccess}" value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.cwvLineItem.NSAD__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                        <apex:repeat value="{!totalColumns}" var="l">
                            <td class="currency-cell showHidePOR">
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.porLineItem.aspnsad}"/>
                                </apex:outputText>
                            </td>
                             <td class="currency-cell showHideCWV" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.cwvLineItem.aspnsad}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                    </tr>
                    <tr class="single-underscore" style="border-bottom:1px solid #000;">
                        <td class="data-row-label">MCPU 
                        </td><td>
                        <apex:inputText value="{!lineItemColumns[0].mcpuCommentField}" style="width: 45px; height:15px;" rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}"/>
                        <apex:outputText value="{!lineItemColumns[0].mcpuCommentField}" style="width: 45px; height:15px;" rendered="{!isExcelRender || inApprovalProccess}"/>
                        </td>
                        
                        <apex:repeat value="{!lineItemColumns}" var="l">
                            <td class="currency-cell showHidePOR">
                                <apex:outputField rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}" value="{!l.porLineItem.MCPU__c}">
                                    <apex:inlineEditSupport event="ondblclick" showOnEdit="btnSaveChanges,btnCancel"/>
                                </apex:outputField>
                                <apex:outputText rendered="{!isExcelRender || inApprovalProccess}" value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.porLineItem.MCPU__c}"/>
                                </apex:outputText>
                            </td>
                             <td class="currency-cell showHideCWV" >
                                <apex:outputField rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}" value="{!l.cwvLineItem.MCPU__c}">
                                    <apex:inlineEditSupport event="ondblclick" showOnEdit="btnSaveChanges,btnCancel"/>
                                </apex:outputField>
                                <apex:outputText rendered="{!isExcelRender || inApprovalProccess}" value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.cwvLineItem.MCPU__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                        <apex:repeat value="{!totalColumns}" var="l">
                            <td class="currency-cell showHidePOR">
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.porLineItem.mcpu}"/>
                                </apex:outputText>
                            </td>
                             <td class="currency-cell showHideCWV" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.cwvLineItem.mcpu}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                    </tr>
                    <tr class="double-underscore" style="border-bottom:3px double #000;">
                        <td class="data-row-label">Gross Margin</td><td></td>
                        <apex:repeat value="{!lineItemColumns}" var="l">
                            <td class="currency-cell showHidePOR">
                                <apex:outputField rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}" value="{!l.porLineItem.Gross_Margin__c}">
                                    <apex:inlineEditSupport event="ondblclick" showOnEdit="btnSaveChanges,btnCancel"/>
                                </apex:outputField>
                                <apex:outputText rendered="{!isExcelRender || inApprovalProccess}" value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.porLineItem.Gross_Margin__c}"/>
                                </apex:outputText>
                            </td>
                             <td class="currency-cell showHideCWV" >
                                <apex:outputField rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}" value="{!l.cwvLineItem.Gross_Margin__c}">
                                    <apex:inlineEditSupport event="ondblclick" showOnEdit="btnSaveChanges,btnCancel"/>
                                </apex:outputField>
                                <apex:outputText rendered="{!isExcelRender || inApprovalProccess}" value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.cwvLineItem.Gross_Margin__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                        <apex:repeat value="{!totalColumns}" var="l">
                            <td class="currency-cell showHidePOR">
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.porLineItem.grossMargin}"/>
                                </apex:outputText>
                            </td>
                             <td class="currency-cell showHideCWV" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.cwvLineItem.grossMargin}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                    </tr>
                    <tr>
                        <td class="data-row-label">GM%</td><td></td>
                        <apex:repeat value="{!lineItemColumns}" var="l">
                            <td class="currency-cell showHidePOR">
                                <apex:outputField rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}" value="{!l.porLineItem.GM__c}">
                                    <apex:inlineEditSupport event="ondblclick" showOnEdit="btnSaveChanges,btnCancel"/>
                                </apex:outputField>
                                <apex:outputText rendered="{!isExcelRender || inApprovalProccess}" value="{0,number,###,##0.00%}">
                                    <apex:param value="{!l.porLineItem.GM__c}"/>
                                </apex:outputText>
                            </td>
                             <td class="currency-cell showHideCWV" >
                                <apex:outputField rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}" value="{!l.cwvLineItem.GM__c}">
                                    <apex:inlineEditSupport event="ondblclick" showOnEdit="btnSaveChanges,btnCancel"/>
                                </apex:outputField>
                                <apex:outputText rendered="{!isExcelRender || inApprovalProccess}" value="{0,number,###,##0.00%}">
                                    <apex:param value="{!l.cwvLineItem.GM__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                        <apex:repeat value="{!totalColumns}" var="l">
                            <td class="currency-cell showHidePOR">
                                <apex:outputText value="{0,number,###,##0.00%}">
                                    <apex:param value="{!l.porLineItem.gm}"/>
                                </apex:outputText>
                            </td>
                             <td class="currency-cell showHideCWV" >
                                <apex:outputText value="{0,number,###,##0.00%}">
                                    <apex:param value="{!l.cwvLineItem.gm}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                    </tr>
                    <tr class="single-underscore" style="border-bottom:1px solid #000;">
                        <td class="data-row-label">A&amp;P</td><td></td>
                        <apex:repeat value="{!lineItemColumns}" var="l">
                            <td class="currency-cell showHidePOR">
                                <apex:outputField rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}" value="{!l.porLineItem.AP__c}">
                                    <apex:inlineEditSupport event="ondblclick" showOnEdit="btnSaveChanges,btnCancel"/>
                                </apex:outputField>
                                <apex:outputText rendered="{!isExcelRender || inApprovalProccess}" value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.porLineItem.AP__c}"/>
                                </apex:outputText>
                            </td>
                             <td class="currency-cell showHideCWV" >
                                <apex:outputField rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}" value="{!l.cwvLineItem.AP__c}">
                                    <apex:inlineEditSupport event="ondblclick" showOnEdit="btnSaveChanges,btnCancel"/>
                                </apex:outputField>
                                <apex:outputText rendered="{!isExcelRender || inApprovalProccess}" value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.cwvLineItem.AP__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                        <apex:repeat value="{!totalColumns}" var="l">
                            <td class="currency-cell showHidePOR">
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.porLineItem.aAndP}"/>
                                </apex:outputText>
                            </td>
                             <td class="currency-cell showHideCWV" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.cwvLineItem.aAndP}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                    </tr>
                    <tr class="single-underscore" style="border-bottom:1px solid #000;">
                        <td class="data-row-label">Motoagents</td><td></td>
                        <apex:repeat value="{!lineItemColumns}" var="l">
                            <td class="currency-cell showHidePOR">
                                <apex:outputField rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}" value="{!l.porLineItem.Motoagents__c}">
                                <apex:inlineEditSupport event="ondblclick" showOnEdit="btnSaveChanges,btnCancel"/>
                                </apex:outputField>
                                <apex:outputText rendered="{!isExcelRender || inApprovalProccess}" value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.porLineItem.Motoagents__c}"/>
                                </apex:outputText>
                            </td>
                             <td class="currency-cell showHideCWV" >
                                <apex:outputField rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}" value="{!l.cwvLineItem.Motoagents__c}">
                                <apex:inlineEditSupport event="ondblclick" showOnEdit="btnSaveChanges,btnCancel"/>
                                </apex:outputField>
                                <apex:outputText rendered="{!isExcelRender || inApprovalProccess}" value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.cwvLineItem.Motoagents__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                        <apex:repeat value="{!totalColumns}" var="l">
                            <td class="currency-cell showHidePOR">
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.porLineItem.motoagents}"/>
                                </apex:outputText>
                            </td>
                             <td class="currency-cell showHideCWV" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.cwvLineItem.motoagents}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                    </tr>
                    <tr class="double-underscore" style="border-bottom:3px double #000;">
                        <td class="data-row-label">Contribution Margin</td><td></td>
                        <apex:repeat value="{!lineItemColumns}" var="l">
                            <td class="currency-cell showHidePOR">
                                <apex:outputField rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}" value="{!l.porLineItem.Contribution_Margin__c}">
                                    <apex:inlineEditSupport event="ondblclick" showOnEdit="btnSaveChanges,btnCancel"/>
                                </apex:outputField>
                                <apex:outputText rendered="{!isExcelRender || inApprovalProccess}" value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.porLineItem.Contribution_Margin__c}"/>
                                </apex:outputText>
                            </td>
                             <td class="currency-cell showHideCWV" >
                                <apex:outputField rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}" value="{!l.cwvLineItem.Contribution_Margin__c}">
                                    <apex:inlineEditSupport event="ondblclick" showOnEdit="btnSaveChanges,btnCancel"/>
                                </apex:outputField>
                                <apex:outputText rendered="{!isExcelRender || inApprovalProccess}" value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.cwvLineItem.Contribution_Margin__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                        <apex:repeat value="{!totalColumns}" var="l">
                            <td class="currency-cell showHidePOR">
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.porLineItem.contributionMargin}"/>
                                </apex:outputText>
                            </td>
                             <td class="currency-cell showHideCWV" >
                                <apex:outputText value="$ {0,number,###,##0.00}">
                                    <apex:param value="{!l.cwvLineItem.contributionMargin}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                    </tr>
                    <tr>
                        <td class="data-row-label">CM%</td><td></td>
                        <apex:repeat value="{!lineItemColumns}" var="l">
                            <td class="currency-cell showHidePOR">
                                <apex:outputField rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}" value="{!l.porLineItem.CM__c}">
                                    <apex:inlineEditSupport event="ondblclick" showOnEdit="btnSaveChanges,btnCancel"/>
                                </apex:outputField>
                                <apex:outputText rendered="{!isExcelRender || inApprovalProccess}" value="{0,number,###,##0.00%}">
                                    <apex:param value="{!l.porLineItem.CM__c}"/>
                                </apex:outputText>
                            </td>
                             <td class="currency-cell showHideCWV" >
                                <apex:outputField rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}" value="{!l.cwvLineItem.CM__c}">
                                    <apex:inlineEditSupport event="ondblclick" showOnEdit="btnSaveChanges,btnCancel"/>
                                </apex:outputField>
                                <apex:outputText rendered="{!isExcelRender || inApprovalProccess}" value="{0,number,###,##0.00%}">
                                    <apex:param value="{!l.cwvLineItem.CM__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                        <apex:repeat value="{!totalColumns}" var="l">
                            <td class="currency-cell showHidePOR">
                                <apex:outputText value="{0,number,###,##0.00%}">
                                    <apex:param value="{!l.porLineItem.cm}"/>
                                </apex:outputText>
                            </td>
                             <td class="currency-cell showHideCWV" >
                                <apex:outputText value="{0,number,###,##0.00%}">
                                    <apex:param value="{!l.cwvLineItem.cm}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                    </tr>
                    
                    <!--  END PER UNIT -->
                    
                    <!--  BEGIN TOTAL TABLE -->
                    <!--start of lower table-->
                    <tr>
                        <td class="section-header operator" colspan="{!1+(3*lineItemCount)+(3*totalItemCount)}" style="font-weight:bold;font-size:1.2em;text-transform:uppercase;border-bottom:1px solid #000;padding-top: 20px;">TOTAL</td>
                        <td></td>
                    </tr>             
                   <!--   <tr class="unitRow">
                        <td class="data-row-label"><apex:image id="collapsedIconU" value="https://encrypted-tbn3.gstatic.com/images?q=tbn:ANd9GcTqSa2sEJ7qTG2EFEGAFKaDVUH8p5TASg7RDFS7bbBIhStp5a1TdfdsPg" width="17px" height="17px" alt="-" rendered="{!Not(isExcelRender)}"/>Units</td><td></td>
                        <apex:repeat value="{!lineItemColumns}" var="l">
                            <td class="currency-cell showHidePOR">
                                <apex:outputField rendered="{!NOT(isExcelRender)}" value="{!l.porLineItem.Units__c}">
                                    <apex:inlineEditSupport event="ondblclick" showOnEdit="btnSaveChanges,btnCancel"/>
                                </apex:outputField>
                                <apex:outputText rendered="{!isExcelRender}" value="{0,number,###,##0}">
                                    <apex:param value="{!l.porLineItem.Units__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideCWV" >
                                <apex:outputField rendered="{!NOT(isExcelRender)}" value="{!l.cwvLineItem.Units__c}">
                                    <apex:inlineEditSupport event="ondblclick" showOnEdit="btnSaveChanges,btnCancel"/>
                                </apex:outputField>
                                <apex:outputText rendered="{!isExcelRender}" value="{0,number,###,##0}">
                                    <apex:param value="{!l.cwvLineItem.Units__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                        <apex:repeat value="{!totalColumns}" var="l">
                            <td class="currency-cell showHidePOR">
                                <apex:outputText value="{0,number,###,##0}">
                                    <apex:param value="{!l.TotalPorLineItem.units}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideCWV" >
                                <apex:outputText value="{0,number,###,##0}">
                                    <apex:param value="{!l.TotalCwvLineItem.units}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                    </tr>
                    <tr class="collapsableU">
                        <td class="data-row-sub-label">- Minimum Commit </td><td><apex:inputText value="{!lineItemColumns[0].minimumCommitOpCommentField}" style="width: 45px; height:15px;" rendered="{!Not(isExcelRender)}"/></td>
                        <apex:repeat value="{!lineItemColumns}" var="l">
                            <td class="currency-cell showHidePOR">
                                <apex:outputField rendered="{!NOT(isExcelRender)}" value="{!l.porLineItem.MinimumCommitQuantity__c}">
                                    <apex:inlineEditSupport event="ondblclick" showOnEdit="btnSaveChanges,btnCancel"/>
                                </apex:outputField>
                                <apex:outputText rendered="{!isExcelRender}" value="{0,number,###,##0}">
                                    <apex:param value="{!l.porLineItem.MinimumCommitQuantity__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideCWV" >
                                <apex:outputField rendered="{!NOT(isExcelRender)}" value="{!l.cwvLineItem.MinimumCommitQuantity__c}">
                                    <apex:inlineEditSupport event="ondblclick" showOnEdit="btnSaveChanges,btnCancel"/>
                                </apex:outputField>
                                <apex:outputText rendered="{!isExcelRender}" value="{0,number,###,##0}">
                                    <apex:param value="{!l.cwvLineItem.MinimumCommitQuantity__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                        <apex:repeat value="{!totalColumns}" var="l">
                            <td class="currency-cell showHidePOR">
                                <apex:outputText value="{0,number,###,##0}">
                                    <apex:param value="{!l.TotalPorLineItem.minCommit}"/>
                                </apex:outputText>
                            </td>                           
                            <td class="currency-cell showHideCWV" >
                                <apex:outputText value="{0,number,###,##0}">
                                    <apex:param value="{!l.TotalCwvLineItem.minCommit}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                    </tr>-->
                    <tr class="NSRow">
                        <td class="data-row-label"><apex:image id="collapsedIconNS" value="https://encrypted-tbn3.gstatic.com/images?q=tbn:ANd9GcTqSa2sEJ7qTG2EFEGAFKaDVUH8p5TASg7RDFS7bbBIhStp5a1TdfdsPg" width="17px" height="17px" alt="-" rendered="{!Not(isExcelRender)}"/>NSBD</td><td></td>
                        <apex:repeat value="{!lineItemColumns}" var="l">
                            <td class="currency-cell showHidePOR" >
                                <apex:outputText rendered="{!NOT(isExcelRender)}" value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.porLineItem.Total_NSBD__c}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!isExcelRender}" value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.porLineItem.Total_NSBD__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideCWV">
                                <apex:outputText rendered="{!NOT(isExcelRender)}" value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.cwvLineItem.Total_NSBD__c}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!isExcelRender}" value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.cwvLineItem.Total_NSBD__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                        <apex:repeat value="{!totalColumns}" var="l">
                             <td class="currency-cell showHidePOR" >
                                <apex:outputText value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.TotalporLineItem.NSBD}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideCWV">
                                <apex:outputText value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.TotalCwvLineItem.NSBD}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                    </tr>
                    <tr class="collapsableNS">
                        <td class="data-row-sub-label">- SDF </td><td>
                        <apex:inputText value="{!lineItemColumns[0].sdfOpCommentField}" style="width: 45px; height:15px;" rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}"/>
                        <apex:outputText value="{!lineItemColumns[0].sdfOpCommentField}" style="width: 45px; height:15px;" rendered="{!isExcelRender || inApprovalProccess}"/>
                        </td>
                        <apex:repeat value="{!lineItemColumns}" var="l">
                             <td class="currency-cell showHidePOR" >
                                <apex:outputText rendered="{!NOT(isExcelRender)}" value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.porLineItem.Total_SDF__c}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!isExcelRender}" value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.porLineItem.Total_SDF__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideCWV">
                                <apex:outputText rendered="{!NOT(isExcelRender)}" value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.cwvLineItem.Total_SDF__c}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!isExcelRender}" value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.cwvLineItem.Total_SDF__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                        <apex:repeat value="{!totalColumns}" var="l">
                             <td class="currency-cell showHidePOR" >
                                <apex:outputText value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.TotalporLineItem.sdf}"/>
                                </apex:outputText>
                            </td>
                             <td class="currency-cell showHideCWV" >
                                <apex:outputText value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.TotalCwvLineItem.sdf}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                    </tr>
                    <tr class="collapsableNS">
                        <td class="data-row-sub-label">- COOP </td><td>
                        <apex:inputText value="{!lineItemColumns[0].coopOpCommentField}" style="width: 45px; height:15px;" rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}"/>
                        <apex:outputText value="{!lineItemColumns[0].coopOpCommentField}" style="width: 45px; height:15px;" rendered="{!isExcelRender || inApprovalProccess}"/>
                        </td>
                        <apex:repeat value="{!lineItemColumns}" var="l">
                            <td class="currency-cell showHidePOR" >
                                <apex:outputText rendered="{!NOT(isExcelRender)}" value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.porLineItem.Total_COOP__c}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!isExcelRender}" value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.porLineItem.Total_COOP__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideCWV">
                                <apex:outputText rendered="{!NOT(isExcelRender)}" value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.cwvLineItem.Total_COOP__c}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!isExcelRender}" value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.cwvLineItem.Total_COOP__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                        <apex:repeat value="{!totalColumns}" var="l">
                             <td class="currency-cell showHidePOR" >
                                <apex:outputText value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.TotalPorLineItem.coop}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideCWV">
                                <apex:outputText value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.TotalCwvLineItem.coop}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                    </tr>
                    <tr class="collapsableNS">
                        <td class="data-row-sub-label">- MDF </td><td>
                        <apex:inputText value="{!lineItemColumns[0].mdfOpCommentField}" style="width: 45px; height:15px;" rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}"/>
                        <apex:outputText value="{!lineItemColumns[0].mdfOpCommentField}" style="width: 45px; height:15px;" rendered="{!isExcelRender || inApprovalProccess}"/>
                        </td>
                        <apex:repeat value="{!lineItemColumns}" var="l">
                             <td class="currency-cell showHidePOR" >
                                <apex:outputText rendered="{!NOT(isExcelRender)}" value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.porLineItem.Total_MDF__c}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!isExcelRender}" value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.porLineItem.Total_MDF__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideCWV">
                                <apex:outputText rendered="{!NOT(isExcelRender)}" value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.cwvLineItem.Total_MDF__c}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!isExcelRender}" value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.cwvLineItem.Total_MDF__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                        <apex:repeat value="{!totalColumns}" var="l">
                             <td class="currency-cell showHidePOR" >
                                <apex:outputText value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.TotalPorLineItem.mdf}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideCWV">
                                <apex:outputText value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.TotalCwvLineItem.mdf}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                    </tr>
                    <tr class="collapsableNS">
                        <td class="data-row-sub-label">- iMDF </td><td>
                        <apex:inputText value="{!lineItemColumns[0].imdfOpCommentField}" style="width: 45px; height:15px;" rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}"/>
                        <apex:outputText value="{!lineItemColumns[0].imdfOpCommentField}" style="width: 45px; height:15px;" rendered="{!isExcelRender || inApprovalProccess}"/>
                        </td>
                        <apex:repeat value="{!lineItemColumns}" var="l">
                            <td class="currency-cell showHidePOR" >
                                <apex:outputText rendered="{!NOT(isExcelRender)}" value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.porLineItem.iMDF__c}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!isExcelRender}" value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.porLineItem.iMDF__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideCWV">
                                <apex:outputText rendered="{!NOT(isExcelRender)}" value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.cwvLineItem.iMDF__c}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!isExcelRender}" value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.cwvLineItem.iMDF__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                        <apex:repeat value="{!totalColumns}" var="l">
                             <td class="currency-cell showHidePOR" >
                                <apex:outputText value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.TotalPorLineItem.imdf}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideCWV">
                                <apex:outputText value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.TotalCwvLineItem.imdf}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                    </tr>
                    <tr class="collapsableNS">
                        <td class="data-row-sub-label">- SVM </td><td>
                        <apex:inputText value="{!lineItemColumns[0].svmOpCommentField}" style="width: 45px; height:15px;" rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}"/>
                        <apex:outputText value="{!lineItemColumns[0].svmOpCommentField}" style="width: 45px; height:15px;" rendered="{!isExcelRender || inApprovalProccess}"/>
                        </td>
                        <apex:repeat value="{!lineItemColumns}" var="l">
                             <td class="currency-cell showHidePOR" >
                                <apex:outputText rendered="{!NOT(isExcelRender)}" value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.porLineItem.Total_SVM__c}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!isExcelRender}" value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.cwvLineItem.Total_SVM__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideCWV">
                                <apex:outputText rendered="{!NOT(isExcelRender)}" value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.cwvLineItem.Total_SVM__c}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!isExcelRender}" value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.cwvLineItem.Total_SVM__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                        <apex:repeat value="{!totalColumns}" var="l">
                             <td class="currency-cell showHidePOR" >
                                <apex:outputText value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.TotalPorLineItem.svm}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideCWV">
                                <apex:outputText value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.TotalCwvLineItem.svm}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                    </tr>
                    <tr class="collapsableNS">
                        <td class="data-row-sub-label">- IPP </td><td>
                        <apex:inputText value="{!lineItemColumns[0].ippOpCommentField}" style="width: 45px; height:15px;" rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}"/>
                        <apex:outputText value="{!lineItemColumns[0].ippOpCommentField}" style="width: 45px; height:15px;" rendered="{!isExcelRender || inApprovalProccess}"/>
                        </td>
                        <apex:repeat value="{!lineItemColumns}" var="l">
                             <td class="currency-cell showHidePOR" >
                                <apex:outputText rendered="{!NOT(isExcelRender)}" value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.porLineItem.Total_IPP__c}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!isExcelRender}" value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.porLineItem.Total_IPP__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideCWV">
                                <apex:outputText rendered="{!NOT(isExcelRender)}" value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.cwvLineItem.Total_IPP__c}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!isExcelRender}" value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.cwvLineItem.Total_IPP__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                        <apex:repeat value="{!totalColumns}" var="l">
                             <td class="currency-cell showHidePOR" >
                                <apex:outputText value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.TotalPorLineItem.ipp}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideCWV">
                                <apex:outputText value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.TotalCwvLineItem.ipp}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                    </tr>
                    <tr class="collapsableNS">
                        <td class="data-row-sub-label">- National Retail </td><td>
                        <apex:inputText value="{!lineItemColumns[0].nationalRetailOpCommentField}" style="width: 45px; height:15px;" rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}"/>
                        <apex:outputText value="{!lineItemColumns[0].nationalRetailOpCommentField}" style="width: 45px; height:15px;" rendered="{!isExcelRender || inApprovalProccess}"/>
                        </td>
                        <apex:repeat value="{!lineItemColumns}" var="l">
                            <td class="currency-cell showHidePOR" >
                                <apex:outputText rendered="{!NOT(isExcelRender)}" value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.porLineItem.Total_National_Retail__c}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!isExcelRender}" value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.porLineItem.Total_National_Retail__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideCWV">
                                <apex:outputText rendered="{!NOT(isExcelRender)}" value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.cwvLineItem.Total_National_Retail__c}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!isExcelRender}" value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.cwvLineItem.Total_National_Retail__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                        <apex:repeat value="{!totalColumns}" var="l">
                             <td class="currency-cell showHidePOR" >
                                <apex:outputText value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.TotalPorLineItem.nationalRetail}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideCWV">
                                <apex:outputText value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.TotalCwvLineItem.nationalRetail}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                    </tr>
                    <tr class="collapsableNS"> 
                        <td class="data-row-sub-label">- CSAT </td><td>
                        <apex:inputText value="{!lineItemColumns[0].csatOpCommentField}" style="width: 45px; height:15px;" rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}"/>
                        <apex:outputText value="{!lineItemColumns[0].csatOpCommentField}" style="width: 45px; height:15px;" rendered="{!isExcelRender || inApprovalProccess}"/>
                        </td>
                        <apex:repeat value="{!lineItemColumns}" var="l">
                             <td class="currency-cell showHidePOR" >
                                <apex:outputText rendered="{!NOT(isExcelRender)}" value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.porLineItem.Total_CSAT__c}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!isExcelRender}" value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.porLineItem.Total_CSAT__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideCWV">
                                <apex:outputText rendered="{!NOT(isExcelRender)}" value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.cwvLineItem.Total_CSAT__c}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!isExcelRender}" value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.cwvLineItem.Total_CSAT__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                        <apex:repeat value="{!totalColumns}" var="l">
                             <td class="currency-cell showHidePOR" >
                                <apex:outputText value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.TotalPorLineItem.csat}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideCWV">
                                <apex:outputText value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.TotalCwvLineItem.csat}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                    </tr>
                    <tr class="collapsableNS">
                        <td class="data-row-sub-label">- QP </td><td>
                        <apex:inputText value="{!lineItemColumns[0].qpOpCommentField}" style="width: 45px; height:15px;" rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}"/>
                        <apex:outputText value="{!lineItemColumns[0].qpOpCommentField}" style="width: 45px; height:15px;" rendered="{!isExcelRender || inApprovalProccess}"/>
                        </td>
                        <apex:repeat value="{!lineItemColumns}" var="l">
                             <td class="currency-cell showHidePOR" >
                                <apex:outputText rendered="{!NOT(isExcelRender)}" value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.porLineItem.Total_QP__c}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!isExcelRender}" value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.porLineItem.Total_QP__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideCWV">
                                <apex:outputText rendered="{!NOT(isExcelRender)}" value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.cwvLineItem.Total_QP__c}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!isExcelRender}" value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.cwvLineItem.Total_QP__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                        <apex:repeat value="{!totalColumns}" var="l">
                             <td class="currency-cell showHidePOR" >
                                <apex:outputText value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.TotalPorLineItem.qp}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideCWV">
                                <apex:outputText value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.TotalCwvLineItem.qp}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                    </tr>
                    <tr class="collapsableNS">
                        <td class="data-row-sub-label">- TC </td><td>
                        <apex:inputText value="{!lineItemColumns[0].tcOpCommentField}" style="width: 45px; height:15px;" rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}"/>
                        <apex:outputText value="{!lineItemColumns[0].tcOpCommentField}" style="width: 45px; height:15px;" rendered="{!isExcelRender || inApprovalProccess}"/>
                        </td>
                        <apex:repeat value="{!lineItemColumns}" var="l">
                             <td class="currency-cell showHidePOR" >
                                <apex:outputText rendered="{!NOT(isExcelRender)}" value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.porLineItem.Total_TC__c}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!isExcelRender}" value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.porLineItem.Total_TC__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideCWV">
                                <apex:outputText rendered="{!NOT(isExcelRender)}" value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.cwvLineItem.Total_TC__c}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!isExcelRender}" value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.cwvLineItem.Total_TC__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                        <apex:repeat value="{!totalColumns}" var="l">
                             <td class="currency-cell showHidePOR" >
                                <apex:outputText value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.TotalPorLineItem.tc}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideCWV">
                                <apex:outputText value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.TotalCWvLineItem.tc}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                    </tr>
                    <tr class="collapsableNS"> 
                        <td class="data-row-sub-label">- ILW </td><td>
                        <apex:inputText value="{!lineItemColumns[0].ilwOpCommentField}" style="width: 45px; height:15px;" rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}"/>
                        <apex:outputText value="{!lineItemColumns[0].ilwOpCommentField}" style="width: 45px; height:15px;" rendered="{!isExcelRender || inApprovalProccess}"/>
                        </td>
                        <apex:repeat value="{!lineItemColumns}" var="l">
                             <td class="currency-cell showHidePOR" >
                                <apex:outputText rendered="{!NOT(isExcelRender)}" value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.porLineItem.Total_ILW__c}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!isExcelRender}" value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.porLineItem.Total_ILW__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideCWV">
                                <apex:outputText rendered="{!NOT(isExcelRender)}" value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.cwvLineItem.Total_ILW__c}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!isExcelRender}" value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.cwvLineItem.Total_ILW__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                        <apex:repeat value="{!totalColumns}" var="l">
                             <td class="currency-cell showHidePOR" >
                                <apex:outputText value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.TotalPorLineItem.ilw}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideCWV">
                                <apex:outputText value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.TotalCwvLineItem.ilw}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                    </tr>
                    <tr class="collapsableNS">
                        <td class="data-row-sub-label">- TDF </td><td>
                        <apex:inputText value="{!lineItemColumns[0].tdfOpCommentField}" style="width: 45px; height:15px;" rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}"/>
                        <apex:outputText value="{!lineItemColumns[0].tdfOpCommentField}" style="width: 45px; height:15px;" rendered="{!isExcelRender || inApprovalProccess}"/>
                        </td>
                        <apex:repeat value="{!lineItemColumns}" var="l">
                             <td class="currency-cell showHidePOR" >
                                <apex:outputText rendered="{!NOT(isExcelRender)}" value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.porLineItem.Total_TDF__c}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!isExcelRender}" value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.porLineItem.Total_TDF__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideCWV">
                                <apex:outputText rendered="{!NOT(isExcelRender)}" value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.cwvLineItem.Total_TDF__c}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!isExcelRender}" value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.cwvLineItem.Total_TDF__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                        <apex:repeat value="{!totalColumns}" var="l">
                             <td class="currency-cell showHidePOR" >
                                <apex:outputText value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.TotalPorLineItem.tdf}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideCWV">
                                <apex:outputText value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.TotalCwvLineItem.tdf}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                    </tr>
                    <tr class="collapsableNS">
                        <td class="data-row-sub-label">- Fees </td><td>
                        <apex:inputText value="{!lineItemColumns[0].feesOpCommentField}" style="width: 45px; height:15px;" rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}"/>
                        <apex:outputText value="{!lineItemColumns[0].feesOpCommentField}" style="width: 45px; height:15px;" rendered="{!isExcelRender || inApprovalProccess}"/>
                        </td>
                        <apex:repeat value="{!lineItemColumns}" var="l">
                             <td class="currency-cell showHidePOR" >
                                <apex:outputText rendered="{!NOT(isExcelRender)}" value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.porLineItem.Total_Fees__c}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!isExcelRender}" value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.porLineItem.Total_Fees__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideCWV">
                                <apex:outputText rendered="{!NOT(isExcelRender)}" value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.cwvLineItem.Total_Fees__c}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!isExcelRender}" value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.cwvLineItem.Total_Fees__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                        <apex:repeat value="{!totalColumns}" var="l">
                             <td class="currency-cell showHidePOR" >
                                <apex:outputText value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.TotalPorLineItem.fees}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideCWV">
                                <apex:outputText value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.TotalCwvLineItem.fees}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                    </tr>
                    <tr class="collapsableNS">
                        <td class="data-row-sub-label">- Negotiation Buffer </td><td>
                        <apex:inputText value="{!lineItemColumns[0].negotiationBufferOpCommentField}" style="width: 45px; height:15px;" rendered="{!NOT(isExcelRender) && Not(inApprovalProccess)}"/>
                        <apex:outputText value="{!lineItemColumns[0].negotiationBufferOpCommentField}" style="width: 45px; height:15px;" rendered="{!isExcelRender || inApprovalProccess}"/>
                        </td>
                        <apex:repeat value="{!lineItemColumns}" var="l">
                             <td class="currency-cell showHidePOR" >
                                <apex:outputText rendered="{!NOT(isExcelRender)}" value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.porLineItem.Total_Negotiation_Buffer__c}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!isExcelRender}" value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.porLineItem.Total_Negotiation_Buffer__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideCWV">
                                <apex:outputText rendered="{!NOT(isExcelRender)}" value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.cwvLineItem.Total_Negotiation_Buffer__c}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!isExcelRender}" value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.cwvLineItem.Total_Negotiation_Buffer__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                        <apex:repeat value="{!totalColumns}" var="l">
                             <td class="currency-cell showHidePOR" >
                                <apex:outputText value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.TotalPorLineItem.negotiationBuffer}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideCWV">
                                <apex:outputText value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.TotalCwvLineItem.negotiationBuffer}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                    </tr>
                    <tr class="single-underscore" style="border-bottom:1px solid #000;">
                        <td class="data-row-label">Total Discount</td><td></td>
                        <apex:repeat value="{!lineItemColumns}" var="l">
                             <td class="currency-cell showHidePOR" >
                                <apex:outputText rendered="{!NOT(isExcelRender)}" value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.porLineItem.Total_Aggregate_Discounts__c}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!isExcelRender}" value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.porLineItem.Total_Aggregate_Discounts__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideCWV">
                                <apex:outputText rendered="{!NOT(isExcelRender)}" value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.cwvLineItem.Total_Aggregate_Discounts__c}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!isExcelRender}" value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.cwvLineItem.Total_Aggregate_Discounts__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                        <apex:repeat value="{!totalColumns}" var="l">
                             <td class="currency-cell showHidePOR" >
                                <apex:outputText value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.TotalPorLineItem.discount}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideCWV">
                                <apex:outputText value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.TotalCwvLineItem.discount}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                    </tr>
                    <tr class="single-underscore" style="border-bottom:1px solid #000;">
                        <td class="data-row-label">NSAD</td><td></td>
                        <apex:repeat value="{!lineItemColumns}" var="l">
                             <td class="currency-cell showHidePOR" >
                                <apex:outputText rendered="{!NOT(isExcelRender)}" value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.porLineItem.Total_NSAD__c}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!isExcelRender}" value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.porLineItem.Total_NSAD__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideCWV">
                                <apex:outputText rendered="{!NOT(isExcelRender)}" value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.cwvLineItem.Total_NSAD__c}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!isExcelRender}" value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.cwvLineItem.Total_NSAD__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                        <apex:repeat value="{!totalColumns}" var="l">
                             <td class="currency-cell showHidePOR" >
                                <apex:outputText value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.TotalPorLineItem.nsad}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideCWV">
                                <apex:outputText value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.TotalCwvLineItem.nsad}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                    </tr>
                    <tr class="double-underscore" style="border-bottom:3px double #000;">
                        <td class="data-row-label">Gross Margin</td><td></td>
                        <apex:repeat value="{!lineItemColumns}" var="l">
                             <td class="currency-cell showHidePOR" >
                                <apex:outputText rendered="{!NOT(isExcelRender)}" value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.porLineItem.Total_Gross_Margin__c}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!isExcelRender}" value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.porLineItem.Total_Gross_Margin__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideCWV">
                                <apex:outputText rendered="{!NOT(isExcelRender)}" value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.cwvLineItem.Total_Gross_Margin__c}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!isExcelRender}" value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.cwvLineItem.Total_Gross_Margin__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                        <apex:repeat value="{!totalColumns}" var="l">
                             <td class="currency-cell showHidePOR" >
                                <apex:outputText value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.TotalPorLineItem.grossMargin}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideCWV">
                                <apex:outputText value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.TotalCwvLineItem.grossMargin}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                    </tr>
                    <tr class="single-underscore" style="border-bottom:1px solid #000;">
                        <td class="data-row-label">Total A&amp;P</td><td></td>
                        <apex:repeat value="{!lineItemColumns}" var="l">
                             <td class="currency-cell showHidePOR" >
                                <apex:outputText rendered="{!NOT(isExcelRender)}" value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.porLineItem.Total_A_P__c}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!isExcelRender}" value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.porLineItem.Total_A_P__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideCWV">
                                <apex:outputText rendered="{!NOT(isExcelRender)}" value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.cwvLineItem.Total_A_P__c}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!isExcelRender}" value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.cwvLineItem.Total_A_P__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                        <apex:repeat value="{!totalColumns}" var="l">
                             <td class="currency-cell showHidePOR" >
                                <apex:outputText value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.TotalPorLineItem.aAndP}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideCWV">
                                <apex:outputText value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.TotalCwvLineItem.aAndP}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                    </tr>
                    <tr class="single-underscore" style="border-bottom:1px solid #000;">
                        <td class="data-row-label">Motoagents</td><td></td>
                        <apex:repeat value="{!lineItemColumns}" var="l">
                             <td class="currency-cell showHidePOR" >
                                <apex:outputText rendered="{!NOT(isExcelRender)}" value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.porLineItem.Total_Motoagents__c}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!isExcelRender}" value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.porLineItem.Total_Motoagents__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideCWV">
                                <apex:outputText rendered="{!NOT(isExcelRender)}" value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.cwvLineItem.Total_Motoagents__c}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!isExcelRender}" value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.cwvLineItem.Total_Motoagents__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                        <apex:repeat value="{!totalColumns}" var="l">
                             <td class="currency-cell showHidePOR" >
                                <apex:outputText value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.TotalPorLineItem.motoagents}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideCWV">
                                <apex:outputText value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.TotalCwvLineItem.motoagents}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                    </tr>
                    <tr class="double-underscore" style="border-bottom:3px double #000;">
                        <td class="data-row-label">Contribution Margin</td><td></td>
                        <apex:repeat value="{!lineItemColumns}" var="l">
                             <td class="currency-cell showHidePOR" >
                                <apex:outputText rendered="{!NOT(isExcelRender)}" value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.porLineItem.Total_Contribution_Margin__c}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!isExcelRender}" value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.porLineItem.Total_Contribution_Margin__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideCWV">
                                <apex:outputText rendered="{!NOT(isExcelRender)}" value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.cwvlineItem.Total_Contribution_Margin__c}"/>
                                </apex:outputText>
                                <apex:outputText rendered="{!isExcelRender}" value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.cwvLineItem.Total_Contribution_Margin__c}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                        <apex:repeat value="{!totalColumns}" var="l">
                             <td class="currency-cell showHidePOR" >
                                <apex:outputText value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.TotalPorLineItem.contributionMargin}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell showHideCWV">
                                <apex:outputText value="$ {0,number,###,##0}">
                                    <apex:param value="{!l.TotalCwvLineItem.contributionMargin}"/>
                                </apex:outputText>
                            </td>
                            <td class="col-sep"></td>
                        </apex:repeat>
                    </tr>
                    <tr>
                        <td class="blank-row" colspan="{!1+(3*lineItemCount)+(3*totalItemCount)}"></td>
                    </tr>
                    <!--END OPERATOR/RETAIL TABLE-->
                </table>
                </apex:outputPanel>
                </c:Tab> <!--End Tab -->
                <c:Tab title="{!IF(Not(isExcelRender),'Summary',' ')}">

                <apex:outputPanel rendered="{!IF(Not(isExcelRender), true, IF(tabPosition == 'Summary',true, false))}">
                    <table cellpadding="0" cellspacing="0" border="0" class="dataTable" id="notesTabPanel">
                        <tr>
                            <td></td>
                            <td class="prod-sub-header">POR</td>
                            <td class="prod-sub-header" >CWV</td>
                        </tr>
                        <tr>
                            <td class="data-row-label">Units</td>
                            <td class="currency-cell">{!summaryColumns.porLineItem.units}</td>
                            <td class="currency-cell">{!summaryColumns.cwvLineItem.units}</td>
                        </tr>
                        <tr>
                            <td class="data-row-label">- Minimum Commit</td>
                            <td class="currency-cell">{!summaryColumns.porLineItem.minCommit}</td>
                            <td class="currency-cell">{!summaryColumns.cwvLineItem.minCommit}</td>
                        </tr>
                        <tr>
                            <td class="data-row-label">NSBD</td>
                            <td class="currency-cell">
                                <apex:outputText value="$ {0,number,###,##0}">
                                    <apex:param value="{!summaryColumns.porLineItem.nsbd}"/>
                                </apex:outputText>
                            </td>                            
                            <td class="currency-cell">
                                <apex:outputText value="$ {0,number,###,##0}">
                                    <apex:param value="{!summaryColumns.cwvLineItem.nsbd}"/>
                                </apex:outputText>
                            </td>
                        </tr>
                        <tr>
                            <td class="data-row-label">Total Discount</td>
                            <td class="currency-cell">
                                <apex:outputText value="$ {0,number,###,##0}">
                                    <apex:param value="{!summaryColumns.porLineItem.discount}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell">
                                <apex:outputText value="$ {0,number,###,##0}">
                                    <apex:param value="{!summaryColumns.cwvLineItem.discount}"/>
                                </apex:outputText>
                            </td>
                        </tr>
                        <tr>
                            <td class="data-row-label">NSAD</td>
                            <td class="currency-cell">
                                <apex:outputText value="$ {0,number,###,##0}">
                                    <apex:param value="{!summaryColumns.porLineItem.nsad}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell">
                                <apex:outputText value="$ {0,number,###,##0}">
                                    <apex:param value="{!summaryColumns.cwvLineItem.nsad}"/>
                                </apex:outputText>
                            </td>
                        </tr>
                        <tr>
                            <td class="data-row-label">Gross Margin</td>
                            <td class="currency-cell">
                                <apex:outputText value="$ {0,number,###,##0}">
                                    <apex:param value="{!summaryColumns.porLineItem.grossMargin}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell">
                                <apex:outputText value="$ {0,number,###,##0}">
                                    <apex:param value="{!summaryColumns.cwvLineItem.grossMargin}"/>
                                </apex:outputText>
                            </td>
                        </tr>
                        <tr>
                            <td class="data-row-label">A&amp;P</td>
                            <td class="currency-cell">
                                <apex:outputText value="$ {0,number,###,##0}">
                                    <apex:param value="{!summaryColumns.porLineItem.aAndP}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell">
                                <apex:outputText value="$ {0,number,###,##0}">
                                    <apex:param value="{!summaryColumns.cwvLineItem.aAndP}"/>
                                </apex:outputText>
                            </td>
                        </tr>
                        <tr>
                            <td class="data-row-label">Motoagents</td>
                            <td class="currency-cell">
                                <apex:outputText value="$ {0,number,###,##0}">
                                    <apex:param value="{!summaryColumns.porLineItem.motoagents}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell">
                                <apex:outputText value="$ {0,number,###,##0}">
                                    <apex:param value="{!summaryColumns.cwvLineItem.motoagents}"/>
                                </apex:outputText>
                            </td>
                        </tr>
                        <tr>
                            <td class="data-row-label">Contribution Margin</td>
                            <td class="currency-cell">
                                <apex:outputText value="$ {0,number,###,##0}">
                                    <apex:param value="{!summaryColumns.porLineItem.contributionMargin}"/>
                                </apex:outputText>
                            </td>
                            <td class="currency-cell">
                                <apex:outputText value="$ {0,number,###,##0}">
                                    <apex:param value="{!summaryColumns.cwvLineItem.contributionMargin}"/>
                                </apex:outputText>
                            </td>
                        </tr>
                    </table>
                    <apex:pageBlock title="Executive Notes" rendered="{!Not(isExcelRender)}" id="executiveNotes">
                    <apex:outputPanel id="SummaryExecNotess">
                            <table> 

                                <tr>
                                    <td>
                                        <apex:outputText value="Created By: {!execWrapper.u.FirstName + ' ' + execWrapper.u.LastName}"/>
                                    </td>
                                    <td>
                                        <apex:outputText value="Title: Executive Summary"/>                                 
                                    </td>
                                    <td>
                                        <apex:outputPanel id="notesPanel2">
                                            <apex:outputText value="Date Created:"></apex:outputText> 
                                            <apex:outputText value="{0, date, MMMM d','  yyyy}">
                                                <apex:param value="{!execWrapper.q.CreatedDate}" />
                                            </apex:outputText>
                                        </apex:outputPanel>
                                    </td>
                                </tr>
                                <tr>
                                    <td colspan='3' class='notesPadding'>
                                        <div class='notesStyle'>
                                            <textarea wrap="hard" class="newDesc" id="newDesc2" cols="80" readonly='true'>{!execWrapper.q.ExecutiveSummary__c}</textarea>
                                        </div>
                                    </td>
                                </tr>
                            </table>
                    </apex:outputPanel>
                    </apex:pageBlock>
                    <apex:pageBlock title="Summary Notes" rendered="{!Not(isExcelRender)}" id="summaryNotes">
                        <apex:repeat value="{!summaryNotes}" var="summaryNote">
                            <table>

                                <tr>
                                    <td>
                                        <apex:outputText value="Created By: {!summaryNote.Owner.FirstName + ' ' + summaryNote.Owner.LastName}">
                                        </apex:outputText>
                                    </td>
                                    <td>
                                        <apex:outputText value="Title: {!summaryNote.Title}"/>
                                    </td>
                                    <td>
                                        <apex:outputPanel id="notesPanel">
                                            <apex:outputText value="Date Created:"></apex:outputText> 
                                            <apex:outputText value="{0, date, MMMM d','  yyyy}">
                                                <apex:param value="{!summaryNote.CreatedDate}" />
                                            </apex:outputText>
                                        </apex:outputPanel>
                                    </td>
                                </tr>
                                <tr>
                                    <td colspan='3' class='notesPadding'>
                                        <div class='notesStyle'>
                                            <textarea wrap="hard" class="newDesc" id="newDesc" cols="80" rows="10" readonly='true'>{!summaryNote.Body}</textarea>
                                        </div>
                                    </td>
                                </tr>
                            </table>
                        </apex:repeat>
                    </apex:pageBlock>
                </apex:outputPanel>
                </c:Tab>
                </apex:form>
                  
                <c:Tab title="{!IF(Not(isExcelRender),'Attachments',' ')}" backgroundColor="{!IF(hasNewAttachments,'#00CC00','')}" display="{!IF(hasAttachments,'inline','none')}">
                <apex:form enctype="multipart/form-data">
                <apex:outputPanel rendered="{!NOT(isExcelRender)}">
                <apex:pageblock >
                    <apex:pageblockTable value="{!availableAttachments}" var="attachment" border="1" width="705px">
                          <apex:column style="text-align:center" width="150pt">
                              <apex:facet name="header">
                                  <center> Name</center>
                              </apex:facet>
                              <apex:outputfield value="{!attachment.Name}" style="text-align:center"/>
                          </apex:column>
                          <apex:column style="text-align:center" width="150pt">
                              <apex:facet name="header">
                                  <center> File</center>
                              </apex:facet>
                              <a href="/servlet/servlet.FileDownload?file={!attachment.id}" download="{!attachment.name}">{!attachment.name}</a>
                          </apex:column>
                          <apex:column style="text-align:center" width="150pt">
                              <apex:facet name="header">
                                  <center> Created Date</center>
                              </apex:facet>
                              <apex:outputfield value="{!attachment.CreatedDate}" style="text-align:center"/>
                          </apex:column>       
                      </apex:pageblockTable>
                      </apex:pageblock>
                </apex:outputPanel>
                </apex:form>
                </c:Tab>

                <c:Tab title="{!IF(Not(isExcelRender),'Deal Notes',' ')}">
                <apex:form enctype="multipart/form-data">
                <apex:outputPanel rendered="{!NOT(isExcelRender)}">
                    <apex:pageblock >
                    <apex:pageblockTable value="{!availableNotes}" var="note" border="1" width="705px" id="NotesTab">
                    <apex:column style="text-align:center" width="30pt">
                              <apex:facet name="header">
                                  <center></center>
                              </apex:facet>
                              <apex:commandLink action="{!notesPopUp}" value="Edit" id="EditLink" rerender="results"
                              onclick="setTitle('Please Wait');setMessage('Opening Edit View...');showModal();" oncomplete="hideModal();">
                                <apex:param value="{!note.id}" name="noteId"/>
                              </apex:commandLink>
                          </apex:column>
                          <apex:column style="text-align:center" width="150pt">
                              <apex:facet name="header">
                                  <center> Title</center>
                              </apex:facet>
                              <apex:commandLink action="{!notesPopUp}" value="{!note.Title}" id="noteTitle" rerender="results"
                              onclick="setTitle('Please Wait');setMessage('Opening Note...');showModal();" oncomplete="hideModal();">
                                <apex:param value="{!note.id}" name="noteId"></apex:param>
                                <apex:param name="Editable" value="True" ></apex:param>
                                </apex:commandLink>
                              <!-- <apex:outputfield value="{!note.Title}" style="text-align:center"/> -->
                          </apex:column>
                          <apex:column style="text-align:center" width="150pt">
                              <apex:facet name="header">
                                  <center> Created By</center>
                              </apex:facet>
                              <apex:outputfield value="{!note.CreatedById}" style="text-align:center"/>
                          </apex:column> 
                          <apex:column style="text-align:center" width="150pt">
                              <apex:facet name="header">
                                  <center> Created Date</center>
                              </apex:facet>
                              <apex:outputfield value="{!note.CreatedDate}" style="text-align:center"/>
                          </apex:column>       
                      </apex:pageblockTable>
                      </apex:pageblock>
                </apex:outputPanel>
                </apex:form>
                </c:Tab>
                
                <c:Tab title="{!IF(Not(isExcelRender),'Stop Light',' ')}">
                    <apex:outputPanel >
                       <!-- <apex:image value="http://www.track.unodc.org/Style%20Library/Track/Website_Under_Construction.gif" alt="Under Construction" rendered="{!Not(isExcelRender)}"/> -->
                      <!--  <apex:include pageName="DealStopLight"/> -->
                        <apex:iframe src="/apex/DealStopLight?quoteid={!thisQuote.Id}" scrolling="true"/>
                    </apex:outputPanel>
                </c:Tab>

                <script>
                jQuery.noConflict();
                jQuery( document ).ready(function( $ ) {
                    jQuery('.currency-cell span').html(function(i,val){
                        return val.replace('USD','$');
                      });
                });

                </script> 
               </c:Tabpanel><!--End Tabs Panel -->
            </apex:outputPanel>

         <script>
         
                function checkList()
                {
                    if('{!listEmpty}' == 'true')
                    {
                        alert('Please select a product.'); 
                        //window.location.href=window.location.href; 
                    }
                }
                
                function checkFormulaError()
                {
                    if('{!formulaError}' == 'true')
                    {
                        alert('An error has ocurred. Please contact your administrator.'); 
                    }
                }
         
                // BEGIN cmunoz@levementum.com 9/2/2014. Description: Add collpase buttons for Parent rows
                // @imageAlt: the alternative tag defined for the image. "-" is the default
                // @imgId: the image id defined as "#<someId>" where someId is the id of the image selected
                function getAttribute(imageAlt, imgId)
                {
                    try
                    {
                        if(imageAlt == '-')
                        {
                            jQuery(imgId).attr('alt', '+');  
                            jQuery(imgId).attr('src', 'https://cdn0.iconfinder.com/data/icons/super-mono-reflection/blue/toggle-expand_blue.png');   
                        }
                        else
                        {
                            jQuery(imgId).attr('alt', '-');  
                            jQuery(imgId).attr('src', 'https://encrypted-tbn3.gstatic.com/images?q=tbn:ANd9GcTqSa2sEJ7qTG2EFEGAFKaDVUH8p5TASg7RDFS7bbBIhStp5a1TdfdsPg');
                        }
                    }
                    catch(err)
                    {
                        alert(err); 
                    }
                }           
                // END cmunoz@levementum.com
                
                // BEGIN jescamilla@levementum.com  8/27/14 Description:  Enable the Edit All button.
                jQuery.noConflict();
                jQuery( document ).ready(function( $ ) {
                 restorePersistedCheckBoxes();
                    jQuery('.inlineEditWrite').dblclick();   
                    jQuery('.dataTable').click();
                     jQuery('#btnEditAll').click(function(){                        
                        jQuery('.inlineEditWrite span').hide();
                        jQuery('.inlineEditDiv').show();                   
                        jQuery('.inlineEditUndo').hide();                   
                     });
                     

                    jQuery('.inlineEditDiv input').change(function(data){

                            var eleId = jQuery(this).attr('id');
                            var eleVal = jQuery(this).val();
                            if(jQuery('#'+eleId+'_value').length){
                                jQuery('#'+eleId+'_value').val(eleVal);
                            }else{
                                jQuery(this).append('<input id="' + eleId + '_value" type="hidden" style="display: none;" name="'+eleId+'" value="'+ eleVal +'"/>'); 
                            }
                    });

                    jQuery('.visibleOrNot').change(function(){
                        console.log(jQuery(this).prop('checked'));
                        console.log(jQuery(this).next("span").prop('title'));
                        if(jQuery(this).prop('checked')){
                           jQuery(this).next("span").html('Visible' + ' ' + jQuery(this).next("span").prop('title'));
                        }else{
                           jQuery(this).next("span").html('Non Visible' + ' ' + jQuery(this).next("span").prop('title'));
                        }
                        

                    });
                
                
                // BEGIN cmunoz@levementum.com 9/2/2014. Description: Add collpase buttons for Parent rows
                jQuery('[id*="collapsedIconD"]').click(function(){
                    jQuery('.collapsableD').toggle(350);
                    getAttribute(jQuery('[id*="collapsedIconD"]').attr('alt'), '[id*="collapsedIconD"]')
                });
                
                jQuery('[id*="collapsedIconUOp"]').click(function(){
                    jQuery('.collapsableUOp').toggle(350);
                    getAttribute(jQuery('[id*="collapsedIconUOp"]').attr('alt'), '[id*="collapsedIconUOp"]')
                });
                
                jQuery('[id*="collapsedIconNS"]').click(function(){
                    jQuery('.collapsableNS').toggle(350);
                    getAttribute(jQuery('[id*="collapsedIconNS"]').attr('alt'), '[id*="collapsedIconNS"]')
                });
                    
                
                // BEGIN cmunoz@levementum.com 9/4/2014. Removed background color for collapsable option on left hand side of page
                jQuery('#handle').mouseover(function(){
                        jQuery("#handle").css('background-color', 'transparent');
                });
                // END cmunoz@levementum.com

                 //jgarcia@levementum.com 8/27/14 Description: Hide CWV when checkbox checked
                     jQuery('#hideCWV').change(function(){
                        if (jQuery(this).is(':checked')){
                            jQuery('#hidePOR').prop('checked', false);
                            jQuery('#hideBoth').prop('checked', false);
                            jQuery('.showHideCWV').hide();
                            jQuery('.prod-header').attr('colspan',1);
                            jQuery('.showHidePOR').show();
                            
                        }
                    });
                    
                    jQuery('#hideCWV').change(function(){
                        if (!jQuery(this).is(':checked')){
                            jQuery('.showHideCWV').show();
                            jQuery('.prod-header').attr('colspan',2);
                        }    
                    });


                //jgarcia@levementum.com 8/27/14 Description: Hide POR when checkbox checked
                    jQuery('#hidePOR').change(function(){
                        if (jQuery(this).is(':checked')){
                            jQuery('#hideCWV').prop('checked', false);
                            jQuery('#hideBoth').prop('checked', false);
                            jQuery('.showHidePOR').hide();
                            jQuery('.prod-header').attr('colspan',1);
                            jQuery('.showHideCWV').show();
                            
                        }
                    });
                    
                    jQuery('#hidePOR').change(function(){
                        if (!jQuery(this).is(':checked')){
                            jQuery('.showHidePOR').show();
                            jQuery('.prod-header').attr('colspan',2);
                        }    
                    });
                    
                    //jgarcia@levementum.com 8/27/14 Description: Hide Both when checkbox checked
                    jQuery('#hideBoth').change(function(){
                        if (jQuery(this).is(':checked')){  
                            jQuery('.showHidePOR').hide();
                            jQuery('.showHideCWV').hide();
                            jQuery('#hideCWV').prop('checked', false);
                            jQuery('#hidePOR').prop('checked', false);
                        }
                    });
                    
                    jQuery('#hideBoth').change(function(){
                        if (!jQuery(this).is(':checked')){
                            jQuery('.showHideCWV').show();
                            jQuery('.showHidePOR').show();
                            jQuery('.prod-header').attr('colspan',2);
                        }    
                    });

                    jQuery('#hidetotals').change(function(){
                        if (jQuery(this).is(':checked')){
                            jQuery('.total').hide();
                            jQuery('.prod-header').attr('colspan',2);
                        }    
                    });

                    jQuery('#hidetotals').change(function(){
                        if (!jQuery(this).is(':checked')){
                            jQuery('.total').show();
                            jQuery('.prod-header').attr('colspan',2);
                        }    
                    });
                    
                    //cmunoz@levementum.com: 09/18/14. Description: Add styling float:right to date crate label under notes
                    jQuery('span[id*="notesPanel"]').css('float', 'right');
                    
                    //cmunoz@levementum.com: 09/19/14. Description: Add styling to deal status label
                    jQuery('label[id*="quoteStatusId"]').css({"float": "right","color": "#000","font-size": "1.1em","font-weight": "bold"});
                    
                    //cmunoz@levementum.com: 09/19/14. Description: Add styling to deal status label
                    jQuery('label[id*="quoteStatusId"]').css({"float": "right","color": "#000","font-size": "1.1em","font-weight": "bold"});
                    
                    //cmunoz@levementum.com: 09/19/14. Description: Autoadjust text area row size for notes under Summary tab
                    jQuery(function () {
                        jQuery('textarea').each(function(){
                            var obj = jQuery(this).val();
                            if(typeof obj !== "undefined")
                            {
                                if(jQuery(this).attr('class') == "newDesc")
                                {
                                    var stringLength = jQuery(this).val().length;
                                    var count = Math.ceil( stringLength / this.cols ); 
                                    jQuery(this).attr('rows', count + 1);
                                }
                            }
                        });
                    });
        
            });
                 
          </script>
        </apex:outputPanel>
        
        <script>
        
            function alignDealStatus()
            {
                try
                {
                    //cmunoz@levementum.com: 09/19/14. Description: Add styling to deal status label
                    jQuery('label[id*="quoteStatusId"]').css({"float": "right","color": "#000","font-size": "1.1em","font-weight": "bold"});
                }
                catch(err)
                {
                }
            }
        
            function textNotes()
            {
                try
                {
                    jQuery('textarea').each(function(){
                            var obj = jQuery(this).val();
                            if(typeof obj !== "undefined")
                            {
                                if(jQuery(this).attr('class') == "newDesc")
                                {
                                    var stringLength = jQuery(this).val().length;
                                    var count = Math.ceil( stringLength / this.cols ); 
                                    jQuery(this).attr('rows', count + 1);
                                }
                            }
                        });
                        jQuery('span[id*="notesPanel"]').css('float', 'right');
                }
                catch(err)
                {
                }
            }
        
            function getCheckedBoxes() {
                var checkboxes = document.getElementsByName('pidcheckboxes');
                var checkboxesChecked = [];
                for (var i=0; i<checkboxes.length; i++) {
                    if (checkboxes[i].checked) {
                        checkboxesChecked.push(checkboxes[i].id.replace('ccbb-',''));
                    }
                }
                var output = '';
                if(checkboxesChecked.length > 0){
                    output = checkboxesChecked.join(',');
                }
                else
                {
                    alert('Please Select a Product');
                    window.location.href=window.location.href;
                }
               jQuery('input[id*="hfSelectedId"]').val(output);
            }
            
         // This function reads the cookie and checks/unchecks all elements
        // that have been stored inside. It will NOT mess with checkboxes 
        // whose state has not yet been recorded at all.
        function restorePersistedCheckBoxes() {
            var aStatus = getPersistedCheckStatus();
            for(var i = 0; i < aStatus.length; i++) {
                var aPair = aStatus[i].split(':');
                var el = document.getElementById(aPair[0]);
                if(el) {
                    el.checked = aPair[1] == '1';
                }
            }
        }
        
        // This function takes as input an input type="checkbox" element and
        // stores its check state in the persistence cookie. It is smart
        // enough to add or replace the state as appropriate, and not affect
        // the stored state of other checkboxes.    
        function persistCheckBox(el) {
            var found = false;
            var currentStateFragment = el.id + ':' + (el.checked ? '1' : '0');
            var aStatus = getPersistedCheckStatus();
            for(var i = 0; i < aStatus.length; i++) {
                var aPair = aStatus[i].split(':');
                if(aPair[0] == el.id) {
                    // State for this checkbox was already present; replace it
                    aStatus[i] = currentStateFragment;
                    found = true;
                    break;
                }
            }
            if(!found) {
                // State for this checkbox wasn't present; add it
                aStatus.push(currentStateFragment);
            }
            // Now that the array has our info stored, persist it
            setPersistedCheckStatus(aStatus);
        }
        
        // This function simply returns the checkbox persistence status as
        // an array of strings. "Hides" the fact that the data is stored
        // in a cookie.
        function getPersistedCheckStatus() {
            var stored = getPersistenceCookie();
            return stored.split(',');
        }
        
        // This function stores an array of strings that represents the 
        // checkbox persistence status. "Hides" the fact that the data is stored
        // in a cookie.
        function setPersistedCheckStatus(aStatus) {
            setPersistenceCookie(aStatus.join(','));
        }
        
        // Retrieve the value of the persistence cookie.
        function getPersistenceCookie()
        {
          // cookies are separated by semicolons
          var aCookie = document.cookie.split('; ');
          for (var i=0; i < aCookie.length; i++)
          {
            // a name/value pair (a crumb) is separated by an equal sign
            var aCrumb = aCookie[i].split('=');
            if ('JS_PERSISTENCE_COOKIE' == aCrumb[0]) 
              return unescape(aCrumb[1]);
          }
          return ''; // cookie does not exist
        }
        
        // Sets the value of the persistence cookie.
        // Does not affect other cookies that may be present.
        function setPersistenceCookie(sValue) {
            document.cookie = 'JS_PERSISTENCE_COOKIE=' + escape(sValue);
        }
        
        // Removes the persistence cookie.
        function clearPersistenceCookie() { 
            document.cookie = 'JS_PERSISTENCE_COOKIE=' + 
                              ';expires=Fri, 31 Dec 1999 23:59:59 GMT;';
        }
        
        //Added by csechelski@levementum.com on 9/25/2014
        //Hides empty discount rows
        function toggleEmptyDiscountRows(hide){
            jQuery('.dataTable tr').each(function (i,row){
                var l = jQuery(row).find('.data-row-sub-label');
                
                if(l.text() != undefined && l.text() != null && l.text().length > 0 && l.text().trim() != '- Minimum Commit'){
                    //determine if the comment input is blank
                    var hasComment = false;
                    var commentCell = jQuery(row).children('td').eq(1);
                    if(jQuery(commentCell).find('input[type="text"]').length){
                        hasComment = jQuery(commentCell).find('input[type="text"]').first().val().length > 0;
                    }
                    
                    //get the total of all of the currency in the row
                    var total = 0;
                    var cells = jQuery(row).find('.currency-cell');
                    
                    jQuery(cells).each(function(i,cell){
                        //Determine if the cell has inline edit
                        if(jQuery(cell).find('div.inlineEditDiv').length){
                            //for now lets only look at commited changes so we will grab the value of the span tag and ignore the input
                            var spanContent = jQuery(cell).find('span span span').first().text().replace('$','').trim();
                        }
                        else{
                            var spanContent = jQuery(cell).text().replace('$','').trim();
                        }
                            
                        total += parseFloat(spanContent);
                        
                    });
                    if(total == 0 && !hasComment){
                        if(hide){
                            jQuery(row).hide();    
                        }
                        else{
                            jQuery(row).show();    
                        }
                    }
                }
            });
        }
                    
        </script>
       
    <!-- </apex:form> -->
</apex:page>